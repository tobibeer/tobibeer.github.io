<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<script id="versionArea" type="text/javascript">
//<![CDATA[
var version = {title: "TiddlyWiki", major: 2, minor: 6, revision: 1, date: new Date("Aug 18, 2010"), extensions: {}};
//]]>
</script>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="copyright" content="
TiddlyWiki created by Jeremy Ruston, (jeremy [at] osmosoft [dot] com)

Copyright (c) UnaMesa Association 2004-2009

Redistribution and use in source and binary forms, with or without modification,
are permitted provided that the following conditions are met:

Redistributions of source code must retain the above copyright notice, this
list of conditions and the following disclaimer.

Redistributions in binary form must reproduce the above copyright notice, this
list of conditions and the following disclaimer in the documentation and/or other
materials provided with the distribution.

Neither the name of the UnaMesa Association nor the names of its contributors may be
used to endorse or promote products derived from this software without specific
prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS' AND ANY
EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT
SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH
DAMAGE.
" />
<!--PRE-HEAD-START-->
<!--{{{--><link rel='alternate' type='application/rss+xml' title='RSS' href='index.xml' /><!--;}}}-->
<!--PRE-HEAD-END-->
<title> My TiddlyWiki - a reusable non-linear personal web notebook </title>
<style id="styleArea" type="text/css">
#saveTest{display:none;}#messageArea{display:none;}#copyright{display:none;}#storeArea{display:none;}#storeArea div{padding:.5em;margin:1em 0 0 0;border-color:#fff #666 #444 #ddd;border-style:solid;border-width:2px;overflow:auto;}#shadowArea{display:none;}#javascriptWarning{width:100%;text-align:center;font-weight:bold;background-color:#d10;color:#fff;padding:1em 0;}</style>
<!--POST-HEAD-START-->

<!--POST-HEAD-END-->
</head>
<body onload="main();" onunload="if(window.unload) unload();">
<!--PRE-BODY-START-->

<!--PRE-BODY-END-->
<div id="copyright">
Welcome to TiddlyWiki created by Jeremy Ruston, Copyright &copy; 2007 UnaMesa Association
</div>
<noscript>
<div id="javascriptWarning">
This page requires JavaScript to function properly.<br /><br />If you are using Microsoft Internet Explorer you may need to click on the yellow bar above and select 'Allow Blocked Content'. You must then click 'Yes' on the following security warning.
</div>
</noscript>
<div id="saveTest"></div>
<div id="backstageCloak"></div>
<div id="backstageButton"></div>
<div id="backstageArea"><div id="backstageToolbar"></div></div>
<div id="backstage">
	<div id="backstagePanel"></div>
</div>
<div id="contentWrapper"></div>
<div id="contentStash"></div>
<div id="shadowArea">
<div title="MarkupPreHead">
<pre>&lt;!--{{{--&gt;&lt;link rel='alternate' type='application/rss+xml' title='RSS' href='index.xml' /&gt;&lt;!--;}}}--&gt;</pre>
</div>
<div title="ColorPalette">
<pre>Background: #fff
Foreground: #000
PrimaryPale: #8cf
PrimaryLight: #18f
PrimaryMid: #04b
PrimaryDark: #014
SecondaryPale: #ffc
SecondaryLight: #fe8
SecondaryMid: #db4
SecondaryDark: #841
TertiaryPale: #eee
TertiaryLight: #ccc
TertiaryMid: #999
TertiaryDark: #666
Error: #f88
</pre>
</div>
<div title="StyleSheetColors">
<pre>body{background:[[ColorPalette::Background]];color:[[ColorPalette::Foreground]];}a{color:[[ColorPalette::PrimaryMid]];}a:hover{background-color:[[ColorPalette::PrimaryMid]];color:[[ColorPalette::Background]];}a img{border:0;}h1,h2,h3,h4,h5,h6{color:[[ColorPalette::SecondaryDark]];background:transparent;}h1{border-bottom:2px solid [[ColorPalette::TertiaryLight]];}h2,h3{border-bottom:1px solid [[ColorPalette::TertiaryLight]];}.button{color:[[ColorPalette::PrimaryDark]];border:1px solid [[ColorPalette::Background]];}.button:hover{color:[[ColorPalette::PrimaryDark]];background:[[ColorPalette::SecondaryLight]];border-color:[[ColorPalette::SecondaryMid]];}.button:active{color:[[ColorPalette::Background]];background:[[ColorPalette::SecondaryMid]];border:1px solid [[ColorPalette::SecondaryDark]];}.header{background:[[ColorPalette::PrimaryMid]];}.headerShadow{color:[[ColorPalette::Foreground]];}.headerShadow a{font-weight:normal;color:[[ColorPalette::Foreground]];}.headerForeground{color:[[ColorPalette::Background]];}.headerForeground a{font-weight:normal;color:[[ColorPalette::PrimaryPale]];}.tabSelected{color:[[ColorPalette::PrimaryDark]];background:[[ColorPalette::TertiaryPale]];border-left:1px solid [[ColorPalette::TertiaryLight]];border-top:1px solid [[ColorPalette::TertiaryLight]];border-right:1px solid [[ColorPalette::TertiaryLight]];}.tabUnselected{color:[[ColorPalette::Background]];background:[[ColorPalette::TertiaryMid]];}.tabContents{color:[[ColorPalette::PrimaryDark]];background:[[ColorPalette::TertiaryPale]];border:1px solid [[ColorPalette::TertiaryLight]];}.tabContents .button{border:0;}#sidebarOptions input{border:1px solid [[ColorPalette::PrimaryMid]];}#sidebarOptions .sliderPanel{background:[[ColorPalette::PrimaryPale]];}#sidebarOptions .sliderPanel a{border:none;color:[[ColorPalette::PrimaryMid]];}#sidebarOptions .sliderPanel a:hover{color:[[ColorPalette::Background]];background:[[ColorPalette::PrimaryMid]];}#sidebarOptions .sliderPanel a:active{color:[[ColorPalette::PrimaryMid]];background:[[ColorPalette::Background]];}.wizard{background:[[ColorPalette::PrimaryPale]];border:1px solid [[ColorPalette::PrimaryMid]];}.wizard h1{color:[[ColorPalette::PrimaryDark]];border:none;}.wizard h2{color:[[ColorPalette::Foreground]];border:none;}.wizardStep{background:[[ColorPalette::Background]];color:[[ColorPalette::Foreground]];border:1px solid [[ColorPalette::PrimaryMid]];}.wizardStep.wizardStepDone{background:[[ColorPalette::TertiaryLight]];}.wizardFooter{background:[[ColorPalette::PrimaryPale]];}.wizardFooter .status{background:[[ColorPalette::PrimaryDark]];color:[[ColorPalette::Background]];}.wizard .button{color:[[ColorPalette::Foreground]];background:[[ColorPalette::SecondaryLight]];border:1px solid;border-color:[[ColorPalette::SecondaryPale]] [[ColorPalette::SecondaryDark]] [[ColorPalette::SecondaryDark]] [[ColorPalette::SecondaryPale]];}.wizard .button:hover{color:[[ColorPalette::Foreground]];background:[[ColorPalette::Background]];}.wizard .button:active{color:[[ColorPalette::Background]];background:[[ColorPalette::Foreground]];border:1px solid;border-color:[[ColorPalette::PrimaryDark]] [[ColorPalette::PrimaryPale]] [[ColorPalette::PrimaryPale]] [[ColorPalette::PrimaryDark]];}.wizard .notChanged{background:transparent;}.wizard .changedLocally{background:#80ff80;}.wizard .changedServer{background:#8080ff;}.wizard .changedBoth{background:#ff8080;}.wizard .notFound{background:#ffff80;}.wizard .putToServer{background:#ff80ff;}.wizard .gotFromServer{background:#80ffff;}#messageArea{border:1px solid [[ColorPalette::SecondaryMid]];background:[[ColorPalette::SecondaryLight]];color:[[ColorPalette::Foreground]];}#messageArea .button{color:[[ColorPalette::PrimaryMid]];background:[[ColorPalette::SecondaryPale]];border:none;}.popupTiddler{background:[[ColorPalette::TertiaryPale]];border:2px solid [[ColorPalette::TertiaryMid]];}.popup{background:[[ColorPalette::TertiaryPale]];color:[[ColorPalette::TertiaryDark]];border-left:1px solid [[ColorPalette::TertiaryMid]];border-top:1px solid [[ColorPalette::TertiaryMid]];border-right:2px solid [[ColorPalette::TertiaryDark]];border-bottom:2px solid [[ColorPalette::TertiaryDark]];}.popup hr{color:[[ColorPalette::PrimaryDark]];background:[[ColorPalette::PrimaryDark]];border-bottom:1px;}.popup li.disabled{color:[[ColorPalette::TertiaryMid]];}.popup li a,.popup li a:visited{color:[[ColorPalette::Foreground]];border:none;}.popup li a:hover{background:[[ColorPalette::SecondaryLight]];color:[[ColorPalette::Foreground]];border:none;}.popup li a:active{background:[[ColorPalette::SecondaryPale]];color:[[ColorPalette::Foreground]];border:none;}.popupHighlight{background:[[ColorPalette::Background]];color:[[ColorPalette::Foreground]];}.listBreak div{border-bottom:1px solid [[ColorPalette::TertiaryDark]];}.tiddler .defaultCommand{font-weight:bold;}.shadow .title{color:[[ColorPalette::TertiaryDark]];}.title{color:[[ColorPalette::SecondaryDark]];}.subtitle{color:[[ColorPalette::TertiaryDark]];}.toolbar{color:[[ColorPalette::PrimaryMid]];}.toolbar a{color:[[ColorPalette::TertiaryLight]];}.selected .toolbar a{color:[[ColorPalette::TertiaryMid]];}.selected .toolbar a:hover{color:[[ColorPalette::Foreground]];}.tagging,.tagged{border:1px solid [[ColorPalette::TertiaryPale]];background-color:[[ColorPalette::TertiaryPale]];}.selected .tagging,.selected .tagged{background-color:[[ColorPalette::TertiaryLight]];border:1px solid [[ColorPalette::TertiaryMid]];}.tagging .listTitle,.tagged .listTitle{color:[[ColorPalette::PrimaryDark]];}.tagging .button,.tagged .button{border:none;}.footer{color:[[ColorPalette::TertiaryLight]];}.selected .footer{color:[[ColorPalette::TertiaryMid]];}.sparkline{background:[[ColorPalette::PrimaryPale]];border:0;}.sparktick{background:[[ColorPalette::PrimaryDark]];}.error,.errorButton{color:[[ColorPalette::Foreground]];background:[[ColorPalette::Error]];}.warning{color:[[ColorPalette::Foreground]];background:[[ColorPalette::SecondaryPale]];}.lowlight{background:[[ColorPalette::TertiaryLight]];}.zoomer{background:none;color:[[ColorPalette::TertiaryMid]];border:3px solid [[ColorPalette::TertiaryMid]];}.imageLink,#displayArea .imageLink{background:transparent;}.annotation{background:[[ColorPalette::SecondaryLight]];color:[[ColorPalette::Foreground]];border:2px solid [[ColorPalette::SecondaryMid]];}.viewer .listTitle{list-style-type:none;margin-left:-2em;}.viewer .button{border:1px solid [[ColorPalette::SecondaryMid]];}.viewer blockquote{border-left:3px solid [[ColorPalette::TertiaryDark]];}.viewer table,table.twtable{border:2px solid [[ColorPalette::TertiaryDark]];}.viewer th,.viewer thead td,.twtable th,.twtable thead td{background:[[ColorPalette::SecondaryMid]];border:1px solid [[ColorPalette::TertiaryDark]];color:[[ColorPalette::Background]];}.viewer td,.viewer tr,.twtable td,.twtable tr{border:1px solid [[ColorPalette::TertiaryDark]];}.viewer pre{border:1px solid [[ColorPalette::SecondaryLight]];background:[[ColorPalette::SecondaryPale]];}.viewer code{color:[[ColorPalette::SecondaryDark]];}.viewer hr{border:0;border-top:dashed 1px [[ColorPalette::TertiaryDark]];color:[[ColorPalette::TertiaryDark]];}.highlight,.marked{background:[[ColorPalette::SecondaryLight]];}.editor input{border:1px solid [[ColorPalette::PrimaryMid]];}.editor textarea{border:1px solid [[ColorPalette::PrimaryMid]];width:100%;}.editorFooter{color:[[ColorPalette::TertiaryMid]];}.readOnly{background:[[ColorPalette::TertiaryPale]];}#backstageArea{background:[[ColorPalette::Foreground]];color:[[ColorPalette::TertiaryMid]];}#backstageArea a{background:[[ColorPalette::Foreground]];color:[[ColorPalette::Background]];border:none;}#backstageArea a:hover{background:[[ColorPalette::SecondaryLight]];color:[[ColorPalette::Foreground]];}#backstageArea a.backstageSelTab{background:[[ColorPalette::Background]];color:[[ColorPalette::Foreground]];}#backstageButton a{background:none;color:[[ColorPalette::Background]];border:none;}#backstageButton a:hover{background:[[ColorPalette::Foreground]];color:[[ColorPalette::Background]];border:none;}#backstagePanel{background:[[ColorPalette::Background]];border-color:[[ColorPalette::Background]] [[ColorPalette::TertiaryDark]] [[ColorPalette::TertiaryDark]] [[ColorPalette::TertiaryDark]];}.backstagePanelFooter .button{border:none;color:[[ColorPalette::Background]];}.backstagePanelFooter .button:hover{color:[[ColorPalette::Foreground]];}#backstageCloak{background:[[ColorPalette::Foreground]];opacity:.6;filter:'alpha(opacity=60)';}</pre>
</div>
<div title="StyleSheetLayout">
<pre>* html .tiddler{height:1%;}body{font-size:.75em;font-family:arial,helvetica;margin:0;padding:0;}h1,h2,h3,h4,h5,h6{font-weight:bold;text-decoration:none;}h1,h2,h3{padding-bottom:1px;margin-top:1.2em;margin-bottom:.3em;}h4,h5,h6{margin-top:1em;}h1{font-size:1.35em;}h2{font-size:1.25em;}h3{font-size:1.1em;}h4{font-size:1em;}h5{font-size:.9em;}hr{height:1px;}a{text-decoration:none;}dt{font-weight:bold;}ol{list-style-type:decimal;}ol ol{list-style-type:lower-alpha;}ol ol ol{list-style-type:lower-roman;}ol ol ol ol{list-style-type:decimal;}ol ol ol ol ol{list-style-type:lower-alpha;}ol ol ol ol ol ol{list-style-type:lower-roman;}ol ol ol ol ol ol ol{list-style-type:decimal;}.txtOptionInput{width:11em;}#contentWrapper .chkOptionInput{border:0;}.externalLink{text-decoration:underline;}.indent{margin-left:3em;}.outdent{margin-left:3em;text-indent:-3em;}code.escaped{white-space:nowrap;}.tiddlyLinkExisting{font-weight:bold;}.tiddlyLinkNonExisting{font-style:italic;}a.tiddlyLinkNonExisting.shadow{font-weight:bold;}#mainMenu .tiddlyLinkExisting,#mainMenu .tiddlyLinkNonExisting,#sidebarTabs .tiddlyLinkNonExisting{font-weight:normal;font-style:normal;}#sidebarTabs .tiddlyLinkExisting{font-weight:bold;font-style:normal;}.header{position:relative;}.header a:hover{background:transparent;}.headerShadow{position:relative;padding:4.5em 0 1em 1em;left:-1px;top:-1px;}.headerForeground{position:absolute;padding:4.5em 0 1em 1em;left:0;top:0;}.siteTitle{font-size:3em;}.siteSubtitle{font-size:1.2em;}#mainMenu{position:absolute;left:0;width:10em;text-align:right;line-height:1.6em;padding:1.5em .5em .5em .5em;font-size:1.1em;}#sidebar{position:absolute;right:3px;width:16em;font-size:.9em;}#sidebarOptions{padding-top:.3em;}#sidebarOptions a{margin:0 .2em;padding:.2em .3em;display:block;}#sidebarOptions input{margin:.4em .5em;}#sidebarOptions .sliderPanel{margin-left:1em;padding:.5em;font-size:.85em;}#sidebarOptions .sliderPanel a{font-weight:bold;display:inline;padding:0;}#sidebarOptions .sliderPanel input{margin:0 0 .3em 0;}#sidebarTabs .tabContents{width:15em;overflow:hidden;}.wizard{padding:.1em 1em 0 2em;}.wizard h1{font-size:2em;font-weight:bold;background:none;padding:0;margin:.4em 0 .2em;}.wizard h2{font-size:1.2em;font-weight:bold;background:none;padding:0;margin:.4em 0 .2em;}.wizardStep{padding:1em 1em 1em 1em;}.wizard .button{margin:.5em 0 0;font-size:1.2em;}.wizardFooter{padding:.8em .4em .8em 0;}.wizardFooter .status{padding:0 .4em;margin-left:1em;}.wizard .button{padding:.1em .2em;}#messageArea{position:fixed;top:2em;right:0;margin:.5em;padding:.5em;z-index:2000;_position:absolute;}.messageToolbar{display:block;text-align:right;padding:.2em;}#messageArea a{text-decoration:underline;}.tiddlerPopupButton{padding:.2em;}.popupTiddler{position:absolute;z-index:300;padding:1em;margin:0;}.popup{position:absolute;z-index:300;font-size:.9em;padding:0;list-style:none;margin:0;}.popup .popupMessage{padding:.4em;}.popup hr{display:block;height:1px;width:auto;padding:0;margin:.2em 0;}.popup li.disabled{padding:.4em;}.popup li a{display:block;padding:.4em;font-weight:normal;cursor:pointer;}.listBreak{font-size:1px;line-height:1px;}.listBreak div{margin:2px 0;}.tabset{padding:1em 0 0 .5em;}.tab{margin:0 0 0 .25em;padding:2px;}.tabContents{padding:.5em;}.tabContents ul,.tabContents ol{margin:0;padding:0;}.txtMainTab .tabContents li{list-style:none;}.tabContents li.listLink{margin-left:.75em;}#contentWrapper{display:block;}#splashScreen{display:none;}#displayArea{margin:1em 17em 0 14em;}.toolbar{text-align:right;font-size:.9em;}.tiddler{padding:1em 1em 0;}.missing .viewer,.missing .title{font-style:italic;}.title{font-size:1.6em;font-weight:bold;}.missing .subtitle{display:none;}.subtitle{font-size:1.1em;}.tiddler .button{padding:.2em .4em;}.tagging{margin:.5em .5em .5em 0;float:left;display:none;}.isTag .tagging{display:block;}.tagged{margin:.5em;float:right;}.tagging,.tagged{font-size:.9em;padding:.25em;}.tagging ul,.tagged ul{list-style:none;margin:.25em;padding:0;}.tagClear{clear:both;}.footer{font-size:.9em;}.footer li{display:inline;}.annotation{padding:.5em;margin:.5em;}* html .viewer pre{width:99%;padding:0 0 1em 0;}.viewer{line-height:1.4em;padding-top:.5em;}.viewer .button{margin:0 .25em;padding:0 .25em;}.viewer blockquote{line-height:1.5em;padding-left:.8em;margin-left:2.5em;}.viewer ul,.viewer ol{margin-left:.5em;padding-left:1.5em;}.viewer table,table.twtable{border-collapse:collapse;margin:.8em 1.0em;}.viewer th,.viewer td,.viewer tr,.viewer caption,.twtable th,.twtable td,.twtable tr,.twtable caption{padding:3px;}table.listView{font-size:.85em;margin:.8em 1.0em;}table.listView th,table.listView td,table.listView tr{padding:0 3px 0 3px;}.viewer pre{padding:.5em;margin-left:.5em;font-size:1.2em;line-height:1.4em;overflow:auto;}.viewer code{font-size:1.2em;line-height:1.4em;}.editor{font-size:1.1em;}.editor input,.editor textarea{display:block;width:100%;font:inherit;}.editorFooter{padding:.25em 0;font-size:.9em;}.editorFooter .button{padding-top:0;padding-bottom:0;}.fieldsetFix{border:0;padding:0;margin:1px 0;}.sparkline{line-height:1em;}.sparktick{outline:0;}.zoomer{font-size:1.1em;position:absolute;overflow:hidden;}.zoomer div{padding:1em;}* html #backstage{width:99%;}* html #backstageArea{width:99%;}#backstageArea{display:none;position:relative;overflow:hidden;z-index:150;padding:.3em .5em;}#backstageToolbar{position:relative;}#backstageArea a{font-weight:bold;margin-left:.5em;padding:.3em .5em;}#backstageButton{display:none;position:absolute;z-index:175;top:0;right:0;}#backstageButton a{padding:.1em .4em;margin:.1em;}#backstage{position:relative;width:100%;z-index:50;}#backstagePanel{display:none;z-index:100;position:absolute;width:90%;margin-left:3em;padding:1em;}.backstagePanelFooter{padding-top:.2em;float:right;}.backstagePanelFooter a{padding:.2em .4em;}#backstageCloak{display:none;z-index:20;position:absolute;width:100%;height:100px;}.whenBackstage{display:none;}.backstageVisible .whenBackstage{display:block;}</pre>
</div>
<div title="StyleSheetLocale">
<pre>body{font-size:.8em;}#sidebarOptions{font-size:1.05em;}#sidebarOptions a{font-style:normal;}#sidebarOptions .sliderPanel{font-size:.95em;}.subtitle{font-size:.8em;}.viewer table.listView{font-size:.95em;}</pre>
</div>
<div title="StyleSheetPrint">
<pre>@media print{#mainMenu,#sidebar,#messageArea,.toolbar,#backstageButton,#backstageArea{display:none!important;}#displayArea{margin:1em 1em 0;}noscript{display:none;}}</pre>
</div>
<div title="PageTemplate">
<pre>&lt;!--{{{--&gt;&lt;div class='header' macro='gradient vert [[ColorPalette::PrimaryLight]] [[ColorPalette::PrimaryMid]]'&gt;&lt;div class='headerShadow'&gt;&lt;span class='siteTitle' refresh='content' tiddler='SiteTitle'&gt;&lt;/span&gt;&amp;nbsp;&lt;span class='siteSubtitle' refresh='content' tiddler='SiteSubtitle'&gt;&lt;/span&gt;&lt;/div&gt;&lt;div class='headerForeground'&gt;&lt;span class='siteTitle' refresh='content' tiddler='SiteTitle'&gt;&lt;/span&gt;&amp;nbsp;&lt;span class='siteSubtitle' refresh='content' tiddler='SiteSubtitle'&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div id='mainMenu' refresh='content' tiddler='MainMenu'&gt;&lt;/div&gt;&lt;div id='sidebar'&gt;&lt;div id='sidebarOptions' refresh='content' tiddler='SideBarOptions'&gt;&lt;/div&gt;&lt;div id='sidebarTabs' refresh='content' force='true' tiddler='SideBarTabs'&gt;&lt;/div&gt;&lt;/div&gt;&lt;div id='displayArea'&gt;&lt;div id='messageArea'&gt;&lt;/div&gt;&lt;div id='tiddlerDisplay'&gt;&lt;/div&gt;&lt;/div&gt;&lt;!--;}}}--&gt;</pre>
</div>
<div title="ViewTemplate">
<pre>&lt;!--{{{--&gt;&lt;div class='toolbar' macro='toolbar [[ToolbarCommands::ViewToolbar]]'&gt;&lt;/div&gt;&lt;div class='title' macro='view title'&gt;&lt;/div&gt;&lt;div class='subtitle'&gt;&lt;span macro='view modifier link'&gt;&lt;/span&gt;,&lt;span macro='view modified date'&gt;&lt;/span&gt;(&lt;span macro='message views.wikified.createdPrompt'&gt;&lt;/span&gt;&lt;span macro='view created date'&gt;&lt;/span&gt;)&lt;/div&gt;&lt;div class='tagging' macro='tagging'&gt;&lt;/div&gt;&lt;div class='tagged' macro='tags'&gt;&lt;/div&gt;&lt;div class='viewer' macro='view text wikified'&gt;&lt;/div&gt;&lt;div class='tagClear'&gt;&lt;/div&gt;&lt;!--;}}}--&gt;</pre>
</div>
<div title="EditTemplate">
<pre>&lt;!--{{{--&gt;&lt;div class='toolbar' macro='toolbar [[ToolbarCommands::EditToolbar]]'&gt;&lt;/div&gt;&lt;div class='title' macro='view title'&gt;&lt;/div&gt;&lt;div class='editor' macro='edit title'&gt;&lt;/div&gt;&lt;div macro='annotations'&gt;&lt;/div&gt;&lt;div class='editor' macro='edit text'&gt;&lt;/div&gt;&lt;div class='editor' macro='edit tags'&gt;&lt;/div&gt;&lt;div class='editorFooter'&gt;&lt;span macro='message views.editor.tagPrompt'&gt;&lt;/span&gt;&lt;span macro='tagChooser excludeLists'&gt;&lt;/span&gt;&lt;/div&gt;&lt;!--;}}}--&gt;</pre>
</div>
<div title="GettingStarted">
<pre>To get started with this blank [[TiddlyWiki]],you'll need to modify the following tiddlers:* [[SiteTitle]] &amp; [[SiteSubtitle]]:The title and subtitle of the site,as shown above(after saving,they will also appear in the browser title bar) * [[MainMenu]]:The menu(usually on the left) * [[DefaultTiddlers]]:Contains the names of the tiddlers that you want to appear when the TiddlyWiki is opened You'll also need to enter your username for signing your edits:&lt;&lt;option txtUserName&gt;&gt;</pre>
</div>
<div title="OptionsPanel">
<pre>These [[InterfaceOptions]] for customising [[TiddlyWiki]] are saved in your browser Your username for signing your edits. Write it as a [[WikiWord]](eg [[JoeBloggs]]) &lt;&lt;option txtUserName&gt;&gt;&lt;&lt;option chkSaveBackups&gt;&gt;[[SaveBackups]] &lt;&lt;option chkAutoSave&gt;&gt;[[AutoSave]] &lt;&lt;option chkRegExpSearch&gt;&gt;[[RegExpSearch]] &lt;&lt;option chkCaseSensitiveSearch&gt;&gt;[[CaseSensitiveSearch]] &lt;&lt;option chkAnimate&gt;&gt;[[EnableAnimations]] ---- Also see [[AdvancedOptions]]</pre>
</div>
<div title="ImportTiddlers">
<pre>&lt;&lt;importTiddlers&gt;&gt;</pre>
</div>
</div>
<!--POST-SHADOWAREA-->
<div id="storeArea">
<div title="DefaultTiddlers" creator="Tobias Beer" modifier="Tobias Beer" created="201502062230" changecount="1">
<pre>MarkupPreHeadX
TspotSetupPlugin
DefaultTiddlers</pre>
</div>
<div title="LoadRemoteFileThroughProxy" creator="Tobias Beer" modifier="Tobias Beer" created="201502062232" tags="systemConfig" changecount="1">
<pre>/***
|''Name:''|LoadRemoteFileThroughProxy (previous LoadRemoteFileHijack)|
|''Description:''|When the TiddlyWiki file is located on the web (view over http) the content of [[SiteProxy]] tiddler is added in front of the file url. If [[SiteProxy]] does not exist &quot;/proxy/&quot; is added. |
|''Version:''|1.1.0|
|''Date:''|mar 17, 2007|
|''Source:''|http://tiddlywiki.bidix.info/#LoadRemoteFileHijack|
|''Author:''|BidiX (BidiX (at) bidix (dot) info)|
|''License:''|[[BSD open source license|http://tiddlywiki.bidix.info/#%5B%5BBSD%20open%20source%20license%5D%5D ]]|
|''~CoreVersion:''|2.2.0|
***/
//{{{
version.extensions.LoadRemoteFileThroughProxy = {
 major: 1, minor: 1, revision: 0, 
 date: new Date(&quot;mar 17, 2007&quot;), 
 source: &quot;http://tiddlywiki.bidix.info/#LoadRemoteFileThroughProxy&quot;};

if (!window.bidix) window.bidix = {}; // bidix namespace
if (!bidix.core) bidix.core = {};

bidix.core.loadRemoteFile = loadRemoteFile;
loadRemoteFile = function(url,callback,params)
{
 if ((document.location.toString().substr(0,4) == &quot;http&quot;) &amp;&amp; (url.substr(0,4) == &quot;http&quot;)){ 
 url = store.getTiddlerText(&quot;SiteProxy&quot;, &quot;/proxy/&quot;) + url;
 }
 return bidix.core.loadRemoteFile(url,callback,params);
}
//}}}
</pre>
</div>
<div title="MarkupPreHeadX" creator="YourName" modifier="Tobias Beer" created="201502062229" modified="201502062234" changecount="4">
<pre>&lt;!--{{{--&gt;
&lt;script&gt;
var 
  target = &quot;http://tobibeer.github.io/tb5/&quot;
  hash = (window.location.hash || &quot;&quot;).toLowerCase();
if(hash != &quot;#start:safe&quot;) {
    window.location.replace(target + hash);
}
&lt;/script&gt;
&lt;!--}}}--&gt;</pre>
</div>
<div title="PasswordOptionPlugin" creator="Tobias Beer" modifier="Tobias Beer" created="201502062231" tags="systemConfig" changecount="1">
<pre>/***
|''Name:''|PasswordOptionPlugin|
|''Description:''|Extends TiddlyWiki options with non encrypted password option.|
|''Version:''|1.0.2|
|''Date:''|Apr 19, 2007|
|''Source:''|http://tiddlywiki.bidix.info/#PasswordOptionPlugin|
|''Author:''|BidiX (BidiX (at) bidix (dot) info)|
|''License:''|[[BSD open source license|http://tiddlywiki.bidix.info/#%5B%5BBSD%20open%20source%20license%5D%5D ]]|
|''~CoreVersion:''|2.2.0 (Beta 5)|
***/
//{{{
version.extensions.PasswordOptionPlugin = {
	major: 1, minor: 0, revision: 2, 
	date: new Date(&quot;Apr 19, 2007&quot;),
	source: 'http://tiddlywiki.bidix.info/#PasswordOptionPlugin',
	author: 'BidiX (BidiX (at) bidix (dot) info',
	license: '[[BSD open source license|http://tiddlywiki.bidix.info/#%5B%5BBSD%20open%20source%20license%5D%5D]]',
	coreVersion: '2.2.0 (Beta 5)'
};

config.macros.option.passwordCheckboxLabel = &quot;Save this password on this computer&quot;;
config.macros.option.passwordInputType = &quot;password&quot;; // password | text
setStylesheet(&quot;.pasOptionInput {width: 11em;}\n&quot;,&quot;passwordInputTypeStyle&quot;);

merge(config.macros.option.types, {
	'pas': {
		elementType: &quot;input&quot;,
		valueField: &quot;value&quot;,
		eventName: &quot;onkeyup&quot;,
		className: &quot;pasOptionInput&quot;,
		typeValue: config.macros.option.passwordInputType,
		create: function(place,type,opt,className,desc) {
			// password field
			config.macros.option.genericCreate(place,'pas',opt,className,desc);
			// checkbox linked with this password &quot;save this password on this computer&quot;
			config.macros.option.genericCreate(place,'chk','chk'+opt,className,desc);			
			// text savePasswordCheckboxLabel
			place.appendChild(document.createTextNode(config.macros.option.passwordCheckboxLabel));
		},
		onChange: config.macros.option.genericOnChange
	}
});

merge(config.optionHandlers['chk'], {
	get: function(name) {
		// is there an option linked with this chk ?
		var opt = name.substr(3);
		if (config.options[opt]) 
			saveOptionCookie(opt);
		return config.options[name] ? &quot;true&quot; : &quot;false&quot;;
	}
});

merge(config.optionHandlers, {
	'pas': {
 		get: function(name) {
			if (config.options[&quot;chk&quot;+name]) {
				return encodeCookie(config.options[name].toString());
			} else {
				return &quot;&quot;;
			}
		},
		set: function(name,value) {config.options[name] = decodeCookie(value);}
	}
});

// need to reload options to load passwordOptions
loadOptionsCookie();

/*
if (!config.options['pasPassword'])
	config.options['pasPassword'] = '';

merge(config.optionsDesc,{
		pasPassword: &quot;Test password&quot;
	});
*/
//}}}</pre>
</div>
<div title="TspotSetupPlugin" creator="Tobias Beer" modifier="Tobias Beer" created="201502062230" modified="201502062240" tags="systemConfig" changecount="2">
<pre>/***
Description: Contains the stuff you need to use Tiddlyspot
Note, you also need UploadPlugin, PasswordOptionPlugin and LoadRemoteFileThroughProxy
from http://tiddlywiki.bidix.info for a complete working Tiddlyspot site.
***/
//{{{

// edit this if you are migrating sites or retrofitting an existing TW
config.tiddlyspotSiteId = 'dev5';

// make it so you can by default see edit controls via http
config.options.chkHttpReadOnly = false;
window.readOnly = false; // make sure of it (for tw 2.2)
window.showBackstage = true; // show backstage too

// disable autosave in d3
if (window.location.protocol != &quot;file:&quot;)
	config.options.chkGTDLazyAutoSave = false;

// tweak shadow tiddlers to add upload button, password entry box etc
with (config.shadowTiddlers) {
	SiteUrl = 'http://'+config.tiddlyspotSiteId+'.tiddlyspot.com';
	SideBarOptions = SideBarOptions.replace(/(&lt;&lt;saveChanges&gt;&gt;)/,&quot;$1&lt;&lt;tiddler TspotSidebar&gt;&gt;&quot;);
	OptionsPanel = OptionsPanel.replace(/^/,&quot;&lt;&lt;tiddler TspotOptions&gt;&gt;&quot;);
	DefaultTiddlers = DefaultTiddlers.replace(/^/,&quot;[[WelcomeToTiddlyspot]] &quot;);
	MainMenu = MainMenu.replace(/^/,&quot;[[WelcomeToTiddlyspot]] &quot;);
}

// create some shadow tiddler content
merge(config.shadowTiddlers,{

'TspotControls':[
 &quot;| tiddlyspot password:|&lt;&lt;option pasUploadPassword&gt;&gt;|&quot;,
 &quot;| site management:|&lt;&lt;upload http://&quot; + config.tiddlyspotSiteId + &quot;.tiddlyspot.com/store.cgi index.html . .  &quot; + config.tiddlyspotSiteId + &quot;&gt;&gt;//(requires tiddlyspot password)//&lt;br&gt;[[control panel|http://&quot; + config.tiddlyspotSiteId + &quot;.tiddlyspot.com/controlpanel]], [[download (go offline)|http://&quot; + config.tiddlyspotSiteId + &quot;.tiddlyspot.com/download]]|&quot;,
 &quot;| links:|[[tiddlyspot.com|http://tiddlyspot.com/]], [[FAQs|http://faq.tiddlyspot.com/]], [[blog|http://tiddlyspot.blogspot.com/]], email [[support|mailto:support@tiddlyspot.com]] &amp; [[feedback|mailto:feedback@tiddlyspot.com]], [[donate|http://tiddlyspot.com/?page=donate]]|&quot;
].join(&quot;\n&quot;),

'TspotOptions':[
 &quot;tiddlyspot password:&quot;,
 &quot;&lt;&lt;option pasUploadPassword&gt;&gt;&quot;,
 &quot;&quot;
].join(&quot;\n&quot;),

'TspotSidebar':[
 &quot;&lt;&lt;upload http://&quot; + config.tiddlyspotSiteId + &quot;.tiddlyspot.com/store.cgi index.html . .  &quot; + config.tiddlyspotSiteId + &quot;&gt;&gt;&lt;html&gt;&lt;a href='http://&quot; + config.tiddlyspotSiteId + &quot;.tiddlyspot.com/download' class='button'&gt;download&lt;/a&gt;&lt;/html&gt;&quot;
].join(&quot;\n&quot;),

'WelcomeToTiddlyspot':[
 &quot;This document is a ~TiddlyWiki from tiddlyspot.com.  A ~TiddlyWiki is an electronic notebook that is great for managing todo lists, personal information, and all sorts of things.&quot;,
 &quot;&quot;,
 &quot;@@font-weight:bold;font-size:1.3em;color:#444; //What now?// &amp;nbsp;&amp;nbsp;@@ Before you can save any changes, you need to enter your password in the form below.  Then configure privacy and other site settings at your [[control panel|http://&quot; + config.tiddlyspotSiteId + &quot;.tiddlyspot.com/controlpanel]] (your control panel username is //&quot; + config.tiddlyspotSiteId + &quot;//).&quot;,
 &quot;&lt;&lt;tiddler TspotControls&gt;&gt;&quot;,
 &quot;See also GettingStarted.&quot;,
 &quot;&quot;,
 &quot;@@font-weight:bold;font-size:1.3em;color:#444; //Working online// &amp;nbsp;&amp;nbsp;@@ You can edit this ~TiddlyWiki right now, and save your changes using the \&quot;save to web\&quot; button in the column on the right.&quot;,
 &quot;&quot;,
 &quot;@@font-weight:bold;font-size:1.3em;color:#444; //Working offline// &amp;nbsp;&amp;nbsp;@@ A fully functioning copy of this ~TiddlyWiki can be saved onto your hard drive or USB stick.  You can make changes and save them locally without being connected to the Internet.  When you're ready to sync up again, just click \&quot;upload\&quot; and your ~TiddlyWiki will be saved back to tiddlyspot.com.&quot;,
 &quot;&quot;,
 &quot;@@font-weight:bold;font-size:1.3em;color:#444; //Help!// &amp;nbsp;&amp;nbsp;@@ Find out more about ~TiddlyWiki at [[TiddlyWiki.com|http://tiddlywiki.com]].  Also visit [[TiddlyWiki.org|http://tiddlywiki.org]] for documentation on learning and using ~TiddlyWiki. New users are especially welcome on the [[TiddlyWiki mailing list|http://groups.google.com/group/TiddlyWiki]], which is an excellent place to ask questions and get help.  If you have a tiddlyspot related problem email [[tiddlyspot support|mailto:support@tiddlyspot.com]].&quot;,
 &quot;&quot;,
 &quot;@@font-weight:bold;font-size:1.3em;color:#444; //Enjoy :)// &amp;nbsp;&amp;nbsp;@@ We hope you like using your tiddlyspot.com site.  Please email [[feedback@tiddlyspot.com|mailto:feedback@tiddlyspot.com]] with any comments or suggestions.&quot;
].join(&quot;\n&quot;)

});
//}}}
</pre>
</div>
<div title="UploadLog" modifier="Tobias Beer" created="201502062232" modified="201502062232">
<pre>| !date | !user | !location | !storeUrl | !uploadDir | !toFilename | !backupdir | !origin |
| 06/02/2015 23:32:37 | Tobias Beer | [[tiny.html|file:///C:/GIT/tobibeer.github.io/redirect/tiny.html]] | [[store.cgi|http://tb5.tiddlyspot.com/store.cgi]] | . | [[index.html | http://tb5.tiddlyspot.com/index.html]] | . |</pre>
</div>
<div title="UploadPlugin" creator="Tobias Beer" modifier="Tobias Beer" created="201502062231" tags="systemConfig" changecount="1">
<pre>/***
|''Name:''|UploadPlugin|
|''Description:''|Save to web a TiddlyWiki|
|''Version:''|4.1.3|
|''Date:''|Feb 24, 2008|
|''Source:''|http://tiddlywiki.bidix.info/#UploadPlugin|
|''Documentation:''|http://tiddlywiki.bidix.info/#UploadPluginDoc|
|''Author:''|BidiX (BidiX (at) bidix (dot) info)|
|''License:''|[[BSD open source license|http://tiddlywiki.bidix.info/#%5B%5BBSD%20open%20source%20license%5D%5D ]]|
|''~CoreVersion:''|2.2.0|
|''Requires:''|PasswordOptionPlugin|
***/
//{{{
version.extensions.UploadPlugin = {
	major: 4, minor: 1, revision: 3,
	date: new Date(&quot;Feb 24, 2008&quot;),
	source: 'http://tiddlywiki.bidix.info/#UploadPlugin',
	author: 'BidiX (BidiX (at) bidix (dot) info',
	coreVersion: '2.2.0'
};

//
// Environment
//

if (!window.bidix) window.bidix = {}; // bidix namespace
bidix.debugMode = false;	// true to activate both in Plugin and UploadService
	
//
// Upload Macro
//

config.macros.upload = {
// default values
	defaultBackupDir: '',	//no backup
	defaultStoreScript: &quot;store.php&quot;,
	defaultToFilename: &quot;index.html&quot;,
	defaultUploadDir: &quot;.&quot;,
	authenticateUser: true	// UploadService Authenticate User
};
	
config.macros.upload.label = {
	promptOption: &quot;Save and Upload this TiddlyWiki with UploadOptions&quot;,
	promptParamMacro: &quot;Save and Upload this TiddlyWiki in %0&quot;,
	saveLabel: &quot;save to web&quot;, 
	saveToDisk: &quot;save to disk&quot;,
	uploadLabel: &quot;upload&quot;	
};

config.macros.upload.messages = {
	noStoreUrl: &quot;No store URL in parmeters or options&quot;,
	usernameOrPasswordMissing: &quot;Username or password missing&quot;
};

config.macros.upload.handler = function(place,macroName,params) {
	if (readOnly)
		return;
	var label;
	if (document.location.toString().substr(0,4) == &quot;http&quot;) 
		label = this.label.saveLabel;
	else
		label = this.label.uploadLabel;
	var prompt;
	if (params[0]) {
		prompt = this.label.promptParamMacro.toString().format([this.destFile(params[0], 
			(params[1] ? params[1]:bidix.basename(window.location.toString())), params[3])]);
	} else {
		prompt = this.label.promptOption;
	}
	createTiddlyButton(place, label, prompt, function() {config.macros.upload.action(params);}, null, null, this.accessKey);
};

config.macros.upload.action = function(params)
{
		// for missing macro parameter set value from options
		if (!params) params = {};
		var storeUrl = params[0] ? params[0] : config.options.txtUploadStoreUrl;
		var toFilename = params[1] ? params[1] : config.options.txtUploadFilename;
		var backupDir = params[2] ? params[2] : config.options.txtUploadBackupDir;
		var uploadDir = params[3] ? params[3] : config.options.txtUploadDir;
		var username = params[4] ? params[4] : config.options.txtUploadUserName;
		var password = config.options.pasUploadPassword; // for security reason no password as macro parameter	
		// for still missing parameter set default value
		if ((!storeUrl) &amp;&amp; (document.location.toString().substr(0,4) == &quot;http&quot;)) 
			storeUrl = bidix.dirname(document.location.toString())+'/'+config.macros.upload.defaultStoreScript;
		if (storeUrl.substr(0,4) != &quot;http&quot;)
			storeUrl = bidix.dirname(document.location.toString()) +'/'+ storeUrl;
		if (!toFilename)
			toFilename = bidix.basename(window.location.toString());
		if (!toFilename)
			toFilename = config.macros.upload.defaultToFilename;
		if (!uploadDir)
			uploadDir = config.macros.upload.defaultUploadDir;
		if (!backupDir)
			backupDir = config.macros.upload.defaultBackupDir;
		// report error if still missing
		if (!storeUrl) {
			alert(config.macros.upload.messages.noStoreUrl);
			clearMessage();
			return false;
		}
		if (config.macros.upload.authenticateUser &amp;&amp; (!username || !password)) {
			alert(config.macros.upload.messages.usernameOrPasswordMissing);
			clearMessage();
			return false;
		}
		bidix.upload.uploadChanges(false,null,storeUrl, toFilename, uploadDir, backupDir, username, password); 
		return false; 
};

config.macros.upload.destFile = function(storeUrl, toFilename, uploadDir) 
{
	if (!storeUrl)
		return null;
		var dest = bidix.dirname(storeUrl);
		if (uploadDir &amp;&amp; uploadDir != '.')
			dest = dest + '/' + uploadDir;
		dest = dest + '/' + toFilename;
	return dest;
};

//
// uploadOptions Macro
//

config.macros.uploadOptions = {
	handler: function(place,macroName,params) {
		var wizard = new Wizard();
		wizard.createWizard(place,this.wizardTitle);
		wizard.addStep(this.step1Title,this.step1Html);
		var markList = wizard.getElement(&quot;markList&quot;);
		var listWrapper = document.createElement(&quot;div&quot;);
		markList.parentNode.insertBefore(listWrapper,markList);
		wizard.setValue(&quot;listWrapper&quot;,listWrapper);
		this.refreshOptions(listWrapper,false);
		var uploadCaption;
		if (document.location.toString().substr(0,4) == &quot;http&quot;) 
			uploadCaption = config.macros.upload.label.saveLabel;
		else
			uploadCaption = config.macros.upload.label.uploadLabel;
		
		wizard.setButtons([
				{caption: uploadCaption, tooltip: config.macros.upload.label.promptOption, 
					onClick: config.macros.upload.action},
				{caption: this.cancelButton, tooltip: this.cancelButtonPrompt, onClick: this.onCancel}
				
			]);
	},
	options: [
		&quot;txtUploadUserName&quot;,
		&quot;pasUploadPassword&quot;,
		&quot;txtUploadStoreUrl&quot;,
		&quot;txtUploadDir&quot;,
		&quot;txtUploadFilename&quot;,
		&quot;txtUploadBackupDir&quot;,
		&quot;chkUploadLog&quot;,
		&quot;txtUploadLogMaxLine&quot;		
	],
	refreshOptions: function(listWrapper) {
		var opts = [];
		for(i=0; i&lt;this.options.length; i++) {
			var opt = {};
			opts.push();
			opt.option = &quot;&quot;;
			n = this.options[i];
			opt.name = n;
			opt.lowlight = !config.optionsDesc[n];
			opt.description = opt.lowlight ? this.unknownDescription : config.optionsDesc[n];
			opts.push(opt);
		}
		var listview = ListView.create(listWrapper,opts,this.listViewTemplate);
		for(n=0; n&lt;opts.length; n++) {
			var type = opts[n].name.substr(0,3);
			var h = config.macros.option.types[type];
			if (h &amp;&amp; h.create) {
				h.create(opts[n].colElements['option'],type,opts[n].name,opts[n].name,&quot;no&quot;);
			}
		}
		
	},
	onCancel: function(e)
	{
		backstage.switchTab(null);
		return false;
	},
	
	wizardTitle: &quot;Upload with options&quot;,
	step1Title: &quot;These options are saved in cookies in your browser&quot;,
	step1Html: &quot;&lt;input type='hidden' name='markList'&gt;&lt;/input&gt;&lt;br&gt;&quot;,
	cancelButton: &quot;Cancel&quot;,
	cancelButtonPrompt: &quot;Cancel prompt&quot;,
	listViewTemplate: {
		columns: [
			{name: 'Description', field: 'description', title: &quot;Description&quot;, type: 'WikiText'},
			{name: 'Option', field: 'option', title: &quot;Option&quot;, type: 'String'},
			{name: 'Name', field: 'name', title: &quot;Name&quot;, type: 'String'}
			],
		rowClasses: [
			{className: 'lowlight', field: 'lowlight'} 
			]}
};

//
// upload functions
//

if (!bidix.upload) bidix.upload = {};

if (!bidix.upload.messages) bidix.upload.messages = {
	//from saving
	invalidFileError: &quot;The original file '%0' does not appear to be a valid TiddlyWiki&quot;,
	backupSaved: &quot;Backup saved&quot;,
	backupFailed: &quot;Failed to upload backup file&quot;,
	rssSaved: &quot;RSS feed uploaded&quot;,
	rssFailed: &quot;Failed to upload RSS feed file&quot;,
	emptySaved: &quot;Empty template uploaded&quot;,
	emptyFailed: &quot;Failed to upload empty template file&quot;,
	mainSaved: &quot;Main TiddlyWiki file uploaded&quot;,
	mainFailed: &quot;Failed to upload main TiddlyWiki file. Your changes have not been saved&quot;,
	//specific upload
	loadOriginalHttpPostError: &quot;Can't get original file&quot;,
	aboutToSaveOnHttpPost: 'About to upload on %0 ...',
	storePhpNotFound: &quot;The store script '%0' was not found.&quot;
};

bidix.upload.uploadChanges = function(onlyIfDirty,tiddlers,storeUrl,toFilename,uploadDir,backupDir,username,password)
{
	var callback = function(status,uploadParams,original,url,xhr) {
		if (!status) {
			displayMessage(bidix.upload.messages.loadOriginalHttpPostError);
			return;
		}
		if (bidix.debugMode) 
			alert(original.substr(0,500)+&quot;\n...&quot;);
		// Locate the storeArea div's 
		var posDiv = locateStoreArea(original);
		if((posDiv[0] == -1) || (posDiv[1] == -1)) {
			alert(config.messages.invalidFileError.format([localPath]));
			return;
		}
		bidix.upload.uploadRss(uploadParams,original,posDiv);
	};
	
	if(onlyIfDirty &amp;&amp; !store.isDirty())
		return;
	clearMessage();
	// save on localdisk ?
	if (document.location.toString().substr(0,4) == &quot;file&quot;) {
		var path = document.location.toString();
		var localPath = getLocalPath(path);
		saveChanges();
	}
	// get original
	var uploadParams = new Array(storeUrl,toFilename,uploadDir,backupDir,username,password);
	var originalPath = document.location.toString();
	// If url is a directory : add index.html
	if (originalPath.charAt(originalPath.length-1) == &quot;/&quot;)
		originalPath = originalPath + &quot;index.html&quot;;
	var dest = config.macros.upload.destFile(storeUrl,toFilename,uploadDir);
	var log = new bidix.UploadLog();
	log.startUpload(storeUrl, dest, uploadDir,  backupDir);
	displayMessage(bidix.upload.messages.aboutToSaveOnHttpPost.format([dest]));
	if (bidix.debugMode) 
		alert(&quot;about to execute Http - GET on &quot;+originalPath);
	var r = doHttp(&quot;GET&quot;,originalPath,null,null,username,password,callback,uploadParams,null);
	if (typeof r == &quot;string&quot;)
		displayMessage(r);
	return r;
};

bidix.upload.uploadRss = function(uploadParams,original,posDiv) 
{
	var callback = function(status,params,responseText,url,xhr) {
		if(status) {
			var destfile = responseText.substring(responseText.indexOf(&quot;destfile:&quot;)+9,responseText.indexOf(&quot;\n&quot;, responseText.indexOf(&quot;destfile:&quot;)));
			displayMessage(bidix.upload.messages.rssSaved,bidix.dirname(url)+'/'+destfile);
			bidix.upload.uploadMain(params[0],params[1],params[2]);
		} else {
			displayMessage(bidix.upload.messages.rssFailed);			
		}
	};
	// do uploadRss
	if(config.options.chkGenerateAnRssFeed) {
		var rssPath = uploadParams[1].substr(0,uploadParams[1].lastIndexOf(&quot;.&quot;)) + &quot;.xml&quot;;
		var rssUploadParams = new Array(uploadParams[0],rssPath,uploadParams[2],'',uploadParams[4],uploadParams[5]);
		var rssString = generateRss();
		// no UnicodeToUTF8 conversion needed when location is &quot;file&quot; !!!
		if (document.location.toString().substr(0,4) != &quot;file&quot;)
			rssString = convertUnicodeToUTF8(rssString);	
		bidix.upload.httpUpload(rssUploadParams,rssString,callback,Array(uploadParams,original,posDiv));
	} else {
		bidix.upload.uploadMain(uploadParams,original,posDiv);
	}
};

bidix.upload.uploadMain = function(uploadParams,original,posDiv) 
{
	var callback = function(status,params,responseText,url,xhr) {
		var log = new bidix.UploadLog();
		if(status) {
			// if backupDir specified
			if ((params[3]) &amp;&amp; (responseText.indexOf(&quot;backupfile:&quot;) &gt; -1))  {
				var backupfile = responseText.substring(responseText.indexOf(&quot;backupfile:&quot;)+11,responseText.indexOf(&quot;\n&quot;, responseText.indexOf(&quot;backupfile:&quot;)));
				displayMessage(bidix.upload.messages.backupSaved,bidix.dirname(url)+'/'+backupfile);
			}
			var destfile = responseText.substring(responseText.indexOf(&quot;destfile:&quot;)+9,responseText.indexOf(&quot;\n&quot;, responseText.indexOf(&quot;destfile:&quot;)));
			displayMessage(bidix.upload.messages.mainSaved,bidix.dirname(url)+'/'+destfile);
			store.setDirty(false);
			log.endUpload(&quot;ok&quot;);
		} else {
			alert(bidix.upload.messages.mainFailed);
			displayMessage(bidix.upload.messages.mainFailed);
			log.endUpload(&quot;failed&quot;);			
		}
	};
	// do uploadMain
	var revised = bidix.upload.updateOriginal(original,posDiv);
	bidix.upload.httpUpload(uploadParams,revised,callback,uploadParams);
};

bidix.upload.httpUpload = function(uploadParams,data,callback,params)
{
	var localCallback = function(status,params,responseText,url,xhr) {
		url = (url.indexOf(&quot;nocache=&quot;) &lt; 0 ? url : url.substring(0,url.indexOf(&quot;nocache=&quot;)-1));
		if (xhr.status == 404)
			alert(bidix.upload.messages.storePhpNotFound.format([url]));
		if ((bidix.debugMode) || (responseText.indexOf(&quot;Debug mode&quot;) &gt;= 0 )) {
			alert(responseText);
			if (responseText.indexOf(&quot;Debug mode&quot;) &gt;= 0 )
				responseText = responseText.substring(responseText.indexOf(&quot;\n\n&quot;)+2);
		} else if (responseText.charAt(0) != '0') 
			alert(responseText);
		if (responseText.charAt(0) != '0')
			status = null;
		callback(status,params,responseText,url,xhr);
	};
	// do httpUpload
	var boundary = &quot;---------------------------&quot;+&quot;AaB03x&quot;;	
	var uploadFormName = &quot;UploadPlugin&quot;;
	// compose headers data
	var sheader = &quot;&quot;;
	sheader += &quot;--&quot; + boundary + &quot;\r\nContent-disposition: form-data; name=\&quot;&quot;;
	sheader += uploadFormName +&quot;\&quot;\r\n\r\n&quot;;
	sheader += &quot;backupDir=&quot;+uploadParams[3] +
				&quot;;user=&quot; + uploadParams[4] +
				&quot;;password=&quot; + uploadParams[5] +
				&quot;;uploaddir=&quot; + uploadParams[2];
	if (bidix.debugMode)
		sheader += &quot;;debug=1&quot;;
	sheader += &quot;;;\r\n&quot;; 
	sheader += &quot;\r\n&quot; + &quot;--&quot; + boundary + &quot;\r\n&quot;;
	sheader += &quot;Content-disposition: form-data; name=\&quot;userfile\&quot;; filename=\&quot;&quot;+uploadParams[1]+&quot;\&quot;\r\n&quot;;
	sheader += &quot;Content-Type: text/html;charset=UTF-8&quot; + &quot;\r\n&quot;;
	sheader += &quot;Content-Length: &quot; + data.length + &quot;\r\n\r\n&quot;;
	// compose trailer data
	var strailer = new String();
	strailer = &quot;\r\n--&quot; + boundary + &quot;--\r\n&quot;;
	data = sheader + data + strailer;
	if (bidix.debugMode) alert(&quot;about to execute Http - POST on &quot;+uploadParams[0]+&quot;\n with \n&quot;+data.substr(0,500)+ &quot; ... &quot;);
	var r = doHttp(&quot;POST&quot;,uploadParams[0],data,&quot;multipart/form-data; ;charset=UTF-8; boundary=&quot;+boundary,uploadParams[4],uploadParams[5],localCallback,params,null);
	if (typeof r == &quot;string&quot;)
		displayMessage(r);
	return r;
};

// same as Saving's updateOriginal but without convertUnicodeToUTF8 calls
bidix.upload.updateOriginal = function(original, posDiv)
{
	if (!posDiv)
		posDiv = locateStoreArea(original);
	if((posDiv[0] == -1) || (posDiv[1] == -1)) {
		alert(config.messages.invalidFileError.format([localPath]));
		return;
	}
	var revised = original.substr(0,posDiv[0] + startSaveArea.length) + &quot;\n&quot; +
				store.allTiddlersAsHtml() + &quot;\n&quot; +
				original.substr(posDiv[1]);
	var newSiteTitle = getPageTitle().htmlEncode();
	revised = revised.replaceChunk(&quot;&lt;title&quot;+&quot;&gt;&quot;,&quot;&lt;/title&quot;+&quot;&gt;&quot;,&quot; &quot; + newSiteTitle + &quot; &quot;);
	revised = updateMarkupBlock(revised,&quot;PRE-HEAD&quot;,&quot;MarkupPreHead&quot;);
	revised = updateMarkupBlock(revised,&quot;POST-HEAD&quot;,&quot;MarkupPostHead&quot;);
	revised = updateMarkupBlock(revised,&quot;PRE-BODY&quot;,&quot;MarkupPreBody&quot;);
	revised = updateMarkupBlock(revised,&quot;POST-SCRIPT&quot;,&quot;MarkupPostBody&quot;);
	return revised;
};

//
// UploadLog
// 
// config.options.chkUploadLog :
//		false : no logging
//		true : logging
// config.options.txtUploadLogMaxLine :
//		-1 : no limit
//      0 :  no Log lines but UploadLog is still in place
//		n :  the last n lines are only kept
//		NaN : no limit (-1)

bidix.UploadLog = function() {
	if (!config.options.chkUploadLog) 
		return; // this.tiddler = null
	this.tiddler = store.getTiddler(&quot;UploadLog&quot;);
	if (!this.tiddler) {
		this.tiddler = new Tiddler();
		this.tiddler.title = &quot;UploadLog&quot;;
		this.tiddler.text = &quot;| !date | !user | !location | !storeUrl | !uploadDir | !toFilename | !backupdir | !origin |&quot;;
		this.tiddler.created = new Date();
		this.tiddler.modifier = config.options.txtUserName;
		this.tiddler.modified = new Date();
		store.addTiddler(this.tiddler);
	}
	return this;
};

bidix.UploadLog.prototype.addText = function(text) {
	if (!this.tiddler)
		return;
	// retrieve maxLine when we need it
	var maxLine = parseInt(config.options.txtUploadLogMaxLine,10);
	if (isNaN(maxLine))
		maxLine = -1;
	// add text
	if (maxLine != 0) 
		this.tiddler.text = this.tiddler.text + text;
	// Trunck to maxLine
	if (maxLine &gt;= 0) {
		var textArray = this.tiddler.text.split('\n');
		if (textArray.length &gt; maxLine + 1)
			textArray.splice(1,textArray.length-1-maxLine);
			this.tiddler.text = textArray.join('\n');		
	}
	// update tiddler fields
	this.tiddler.modifier = config.options.txtUserName;
	this.tiddler.modified = new Date();
	store.addTiddler(this.tiddler);
	// refresh and notifiy for immediate update
	story.refreshTiddler(this.tiddler.title);
	store.notify(this.tiddler.title, true);
};

bidix.UploadLog.prototype.startUpload = function(storeUrl, toFilename, uploadDir,  backupDir) {
	if (!this.tiddler)
		return;
	var now = new Date();
	var text = &quot;\n| &quot;;
	var filename = bidix.basename(document.location.toString());
	if (!filename) filename = '/';
	text += now.formatString(&quot;0DD/0MM/YYYY 0hh:0mm:0ss&quot;) +&quot; | &quot;;
	text += config.options.txtUserName + &quot; | &quot;;
	text += &quot;[[&quot;+filename+&quot;|&quot;+location + &quot;]] |&quot;;
	text += &quot; [[&quot; + bidix.basename(storeUrl) + &quot;|&quot; + storeUrl + &quot;]] | &quot;;
	text += uploadDir + &quot; | &quot;;
	text += &quot;[[&quot; + bidix.basename(toFilename) + &quot; | &quot; +toFilename + &quot;]] | &quot;;
	text += backupDir + &quot; |&quot;;
	this.addText(text);
};

bidix.UploadLog.prototype.endUpload = function(status) {
	if (!this.tiddler)
		return;
	this.addText(&quot; &quot;+status+&quot; |&quot;);
};

//
// Utilities
// 

bidix.checkPlugin = function(plugin, major, minor, revision) {
	var ext = version.extensions[plugin];
	if (!
		(ext  &amp;&amp; 
			((ext.major &gt; major) || 
			((ext.major == major) &amp;&amp; (ext.minor &gt; minor))  ||
			((ext.major == major) &amp;&amp; (ext.minor == minor) &amp;&amp; (ext.revision &gt;= revision))))) {
			// write error in PluginManager
			if (pluginInfo)
				pluginInfo.log.push(&quot;Requires &quot; + plugin + &quot; &quot; + major + &quot;.&quot; + minor + &quot;.&quot; + revision);
			eval(plugin); // generate an error : &quot;Error: ReferenceError: xxxx is not defined&quot;
	}
};

bidix.dirname = function(filePath) {
	if (!filePath) 
		return;
	var lastpos;
	if ((lastpos = filePath.lastIndexOf(&quot;/&quot;)) != -1) {
		return filePath.substring(0, lastpos);
	} else {
		return filePath.substring(0, filePath.lastIndexOf(&quot;\\&quot;));
	}
};

bidix.basename = function(filePath) {
	if (!filePath) 
		return;
	var lastpos;
	if ((lastpos = filePath.lastIndexOf(&quot;#&quot;)) != -1) 
		filePath = filePath.substring(0, lastpos);
	if ((lastpos = filePath.lastIndexOf(&quot;/&quot;)) != -1) {
		return filePath.substring(lastpos + 1);
	} else
		return filePath.substring(filePath.lastIndexOf(&quot;\\&quot;)+1);
};

bidix.initOption = function(name,value) {
	if (!config.options[name])
		config.options[name] = value;
};

//
// Initializations
//

// require PasswordOptionPlugin 1.0.1 or better
bidix.checkPlugin(&quot;PasswordOptionPlugin&quot;, 1, 0, 1);

// styleSheet
setStylesheet('.txtUploadStoreUrl, .txtUploadBackupDir, .txtUploadDir {width: 22em;}',&quot;uploadPluginStyles&quot;);

//optionsDesc
merge(config.optionsDesc,{
	txtUploadStoreUrl: &quot;Url of the UploadService script (default: store.php)&quot;,
	txtUploadFilename: &quot;Filename of the uploaded file (default: in index.html)&quot;,
	txtUploadDir: &quot;Relative Directory where to store the file (default: . (downloadService directory))&quot;,
	txtUploadBackupDir: &quot;Relative Directory where to backup the file. If empty no backup. (default: ''(empty))&quot;,
	txtUploadUserName: &quot;Upload Username&quot;,
	pasUploadPassword: &quot;Upload Password&quot;,
	chkUploadLog: &quot;do Logging in UploadLog (default: true)&quot;,
	txtUploadLogMaxLine: &quot;Maximum of lines in UploadLog (default: 10)&quot;
});

// Options Initializations
bidix.initOption('txtUploadStoreUrl','');
bidix.initOption('txtUploadFilename','');
bidix.initOption('txtUploadDir','');
bidix.initOption('txtUploadBackupDir','');
bidix.initOption('txtUploadUserName','');
bidix.initOption('pasUploadPassword','');
bidix.initOption('chkUploadLog',true);
bidix.initOption('txtUploadLogMaxLine','10');


// Backstage
merge(config.tasks,{
	uploadOptions: {text: &quot;upload&quot;, tooltip: &quot;Change UploadOptions and Upload&quot;, content: '&lt;&lt;uploadOptions&gt;&gt;'}
});
config.backstageTasks.push(&quot;uploadOptions&quot;);


//}}}

</pre>
</div>
<div title="zzConfig" creator="Tobias Beer" modifier="Tobias Beer" created="201502062237" modified="201502062241" tags="systemConfig" changecount="2">
<pre>//{{{
config.options.chkUploadLog = false;
config.options.txtUserName = &quot;Tobias Beer&quot;;
//}}}</pre>
</div>
</div>
<!--POST-STOREAREA-->
<!--POST-BODY-START-->
<!--POST-BODY-END-->
<script id="jsArea" type="text/javascript">
//<![CDATA[
var config={numRssItems:20,animDuration:400,cascadeFast:20,cascadeSlow:60,cascadeDepth:5,locale:"en"};config.parsers={};config.adaptors={};config.defaultAdaptor=null;config.tasks={};config.annotations={};config.defaultCustomFields={};config.messages={messageClose:{},dates:{},tiddlerPopup:{}};config.options={chkRegExpSearch:false,chkCaseSensitiveSearch:false,chkIncrementalSearch:true,chkAnimate:true,chkSaveBackups:true,chkAutoSave:false,chkGenerateAnRssFeed:false,chkSaveEmptyTemplate:false,chkOpenInNewWindow:true,chkToggleLinks:false,chkHttpReadOnly:true,chkForceMinorUpdate:false,chkConfirmDelete:true,chkInsertTabs:false,chkUsePreForStorage:true,chkDisplayInstrumentation:false,txtBackupFolder:"",txtEditorFocus:"text",txtMainTab:"tabTimeline",txtMoreTab:"moreTabAll",txtMaxEditRows:"30",txtFileSystemCharSet:"UTF-8",txtTheme:""};config.optionsDesc={};var DEFAULT_VIEW_TEMPLATE=1;var DEFAULT_EDIT_TEMPLATE=2;config.tiddlerTemplates={1:"ViewTemplate",2:"EditTemplate"};config.views={wikified:{tag:{}},editor:{tagChooser:{}}};config.backstageTasks=["save","sync","importTask","tweak","upgrade","plugins"];config.extensions={};config.macros={today:{},version:{},search:{sizeTextbox:15},tiddler:{},tag:{},tags:{},tagging:{},timeline:{},allTags:{},list:{all:{},missing:{},orphans:{},shadowed:{},touched:{},filter:{}},closeAll:{},permaview:{},saveChanges:{},slider:{},option:{},options:{},newTiddler:{},newJournal:{},tabs:{},gradient:{},message:{},view:{defaultView:"text"},edit:{},tagChooser:{},toolbar:{},plugins:{},refreshDisplay:{},importTiddlers:{},upgrade:{source:"http://www.tiddlywiki.com/upgrade/",backupExtension:"pre.core.upgrade"},sync:{},annotations:{}};config.commands={closeTiddler:{},closeOthers:{},editTiddler:{},saveTiddler:{hideReadOnly:true},cancelTiddler:{},deleteTiddler:{hideReadOnly:true},permalink:{},references:{type:"popup"},jump:{type:"popup"},syncing:{type:"popup"},fields:{type:"popup"}};config.userAgent=navigator.userAgent.toLowerCase();config.browser={isIE:config.userAgent.indexOf("msie")!=-1&&config.userAgent.indexOf("opera")==-1,isGecko:navigator.product=="Gecko"&&config.userAgent.indexOf("WebKit")==-1,ieVersion:/MSIE (\d.\d)/i.exec(config.userAgent),isSafari:config.userAgent.indexOf("applewebkit")!=-1,isBadSafari:!((new RegExp("[\u0150\u0170]","g")).test("\u0150")),firefoxDate:/gecko\/(\d{8})/i.exec(config.userAgent),isOpera:config.userAgent.indexOf("opera")!=-1,isLinux:config.userAgent.indexOf("linux")!=-1,isUnix:config.userAgent.indexOf("x11")!=-1,isMac:config.userAgent.indexOf("mac")!=-1,isWindows:config.userAgent.indexOf("win")!=-1};config.textPrimitives={upperLetter:"[A-Z\u00c0-\u00de\u0150\u0170]",lowerLetter:"[a-z0-9_\\-\u00df-\u00ff\u0151\u0171]",anyLetter:"[A-Za-z0-9_\\-\u00c0-\u00de\u00df-\u00ff\u0150\u0170\u0151\u0171]",anyLetterStrict:"[A-Za-z0-9\u00c0-\u00de\u00df-\u00ff\u0150\u0170\u0151\u0171]"};if(config.browser.isBadSafari){config.textPrimitives={upperLetter:"[A-Z\u00c0-\u00de]",lowerLetter:"[a-z0-9_\\-\u00df-\u00ff]",anyLetter:"[A-Za-z0-9_\\-\u00c0-\u00de\u00df-\u00ff]",anyLetterStrict:"[A-Za-z0-9\u00c0-\u00de\u00df-\u00ff]"}}config.textPrimitives.sliceSeparator="::";config.textPrimitives.sectionSeparator="##";config.textPrimitives.urlPattern="(?:file|http|https|mailto|ftp|irc|news|data):[^\\s'\"]+(?:/|\\b)";config.textPrimitives.unWikiLink="~";config.textPrimitives.wikiLink="(?:(?:"+config.textPrimitives.upperLetter+"+"+config.textPrimitives.lowerLetter+"+"+config.textPrimitives.upperLetter+config.textPrimitives.anyLetter+"*)|(?:"+config.textPrimitives.upperLetter+"{2,}"+config.textPrimitives.lowerLetter+"+))";config.textPrimitives.cssLookahead="(?:("+config.textPrimitives.anyLetter+"+)\\(([^\\)\\|\\n]+)(?:\\):))|(?:("+config.textPrimitives.anyLetter+"+):([^;\\|\\n]+);)";config.textPrimitives.cssLookaheadRegExp=new RegExp(config.textPrimitives.cssLookahead,"mg");config.textPrimitives.brackettedLink="\\[\\[([^\\]]+)\\]\\]";config.textPrimitives.titledBrackettedLink="\\[\\[([^\\[\\]\\|]+)\\|([^\\[\\]\\|]+)\\]\\]";config.textPrimitives.tiddlerForcedLinkRegExp=new RegExp("(?:"+config.textPrimitives.titledBrackettedLink+")|(?:"+config.textPrimitives.brackettedLink+")|(?:"+config.textPrimitives.urlPattern+")","mg");config.textPrimitives.tiddlerAnyLinkRegExp=new RegExp("("+config.textPrimitives.wikiLink+")|(?:"+config.textPrimitives.titledBrackettedLink+")|(?:"+config.textPrimitives.brackettedLink+")|(?:"+config.textPrimitives.urlPattern+")","mg");config.glyphs={browsers:[function(){return config.browser.isIE},function(){return true}],currBrowser:null,codes:{downTriangle:["\u25BC","\u25BE"],downArrow:["\u2193","\u2193"],bentArrowLeft:["\u2190","\u21A9"],bentArrowRight:["\u2192","\u21AA"]}};config.shadowTiddlers={StyleSheet:"",MarkupPreHead:"",MarkupPostHead:"",MarkupPreBody:"",MarkupPostBody:"",TabTimeline:"<<timeline>>",TabAll:"<<list all>>",TabTags:"<<allTags excludeLists>>",TabMoreMissing:"<<list missing>>",TabMoreOrphans:"<<list orphans>>",TabMoreShadowed:"<<list shadowed>>",AdvancedOptions:"<<options>>",PluginManager:"<<plugins>>",ToolbarCommands:"|~ViewToolbar|closeTiddler closeOthers +editTiddler > fields syncing permalink references jump|\n|~EditToolbar|+saveTiddler -cancelTiddler deleteTiddler|",WindowTitle:"<<tiddler SiteTitle>> - <<tiddler SiteSubtitle>>"};merge(config.options,{txtUserName:"YourName"});merge(config.tasks,{save:{text:"save",tooltip:"Save your changes to this TiddlyWiki",action:saveChanges},sync:{text:"sync",tooltip:"Synchronise changes with other TiddlyWiki files and servers",content:"<<sync>>"},importTask:{text:"import",tooltip:"Import tiddlers and plugins from other TiddlyWiki files and servers",content:"<<importTiddlers>>"},tweak:{text:"tweak",tooltip:"Tweak the appearance and behaviour of TiddlyWiki",content:"<<options>>"},upgrade:{text:"upgrade",tooltip:"Upgrade TiddlyWiki core code",content:"<<upgrade>>"},plugins:{text:"plugins",tooltip:"Manage installed plugins",content:"<<plugins>>"}});merge(config.optionsDesc,{txtUserName:"Username for signing your edits",chkRegExpSearch:"Enable regular expressions for searches",chkCaseSensitiveSearch:"Case-sensitive searching",chkIncrementalSearch:"Incremental key-by-key searching",chkAnimate:"Enable animations",chkSaveBackups:"Keep backup file when saving changes",chkAutoSave:"Automatically save changes",chkGenerateAnRssFeed:"Generate an RSS feed when saving changes",chkSaveEmptyTemplate:"Generate an empty template when saving changes",chkOpenInNewWindow:"Open external links in a new window",chkToggleLinks:"Clicking on links to open tiddlers causes them to close",chkHttpReadOnly:"Hide editing features when viewed over HTTP",chkForceMinorUpdate:"Don't update modifier username and date when editing tiddlers",chkConfirmDelete:"Require confirmation before deleting tiddlers",chkInsertTabs:"Use the tab key to insert tab characters instead of moving between fields",txtBackupFolder:"Name of folder to use for backups",txtMaxEditRows:"Maximum number of rows in edit boxes",txtTheme:"Name of the theme to use",txtFileSystemCharSet:"Default character set for saving changes (Firefox/Mozilla only)"});merge(config.messages,{customConfigError:"Problems were encountered loading plugins. See PluginManager for details",pluginError:"Error: %0",pluginDisabled:"Not executed because disabled via 'systemConfigDisable' tag",pluginForced:"Executed because forced via 'systemConfigForce' tag",pluginVersionError:"Not executed because this plugin needs a newer version of TiddlyWiki",nothingSelected:"Nothing is selected. You must select one or more items first",savedSnapshotError:"It appears that this TiddlyWiki has been incorrectly saved. Please see http://www.tiddlywiki.com/#Download for details",subtitleUnknown:"(unknown)",undefinedTiddlerToolTip:"The tiddler '%0' doesn't yet exist",shadowedTiddlerToolTip:"The tiddler '%0' doesn't yet exist, but has a pre-defined shadow value",tiddlerLinkTooltip:"%0 - %1, %2",externalLinkTooltip:"External link to %0",noTags:"There are no tagged tiddlers",notFileUrlError:"You need to save this TiddlyWiki to a file before you can save changes",cantSaveError:"It's not possible to save changes. Possible reasons include:\n- your browser doesn't support saving (Firefox, Internet Explorer, Safari and Opera all work if properly configured)\n- the pathname to your TiddlyWiki file contains illegal characters\n- the TiddlyWiki HTML file has been moved or renamed",invalidFileError:"The original file '%0' does not appear to be a valid TiddlyWiki",backupSaved:"Backup saved",backupFailed:"Failed to save backup file",rssSaved:"RSS feed saved",rssFailed:"Failed to save RSS feed file",emptySaved:"Empty template saved",emptyFailed:"Failed to save empty template file",mainSaved:"Main TiddlyWiki file saved",mainFailed:"Failed to save main TiddlyWiki file. Your changes have not been saved",macroError:"Error in macro <<%0>>",macroErrorDetails:"Error while executing macro <<%0>>:\n%1",missingMacro:"No such macro",overwriteWarning:"A tiddler named '%0' already exists. Choose OK to overwrite it",unsavedChangesWarning:"WARNING! There are unsaved changes in TiddlyWiki\n\nChoose OK to save\nChoose CANCEL to discard",confirmExit:"--------------------------------\n\nThere are unsaved changes in TiddlyWiki. If you continue you will lose those changes\n\n--------------------------------",saveInstructions:"SaveChanges",unsupportedTWFormat:"Unsupported TiddlyWiki format '%0'",tiddlerSaveError:"Error when saving tiddler '%0'",tiddlerLoadError:"Error when loading tiddler '%0'",wrongSaveFormat:"Cannot save with storage format '%0'. Using standard format for save.",invalidFieldName:"Invalid field name %0",fieldCannotBeChanged:"Field '%0' cannot be changed",loadingMissingTiddler:"Attempting to retrieve the tiddler '%0' from the '%1' server at:\n\n'%2' in the workspace '%3'",upgradeDone:"The upgrade to version %0 is now complete\n\nClick 'OK' to reload the newly upgraded TiddlyWiki",invalidCookie:"Invalid cookie '%0'"});merge(config.messages.messageClose,{text:"close",tooltip:"close this message area"});config.messages.backstage={open:{text:"backstage",tooltip:"Open the backstage area to perform authoring and editing tasks"},close:{text:"close",tooltip:"Close the backstage area"},prompt:"backstage: ",decal:{edit:{text:"edit",tooltip:"Edit the tiddler '%0'"}}};config.messages.listView={tiddlerTooltip:"Click for the full text of this tiddler",previewUnavailable:"(preview not available)"};config.messages.dates.months=["January","February","March","April","May","June","July","August","September","October","November","December"];config.messages.dates.days=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];config.messages.dates.shortMonths=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];config.messages.dates.shortDays=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];config.messages.dates.daySuffixes=["st","nd","rd","th","th","th","th","th","th","th","th","th","th","th","th","th","th","th","th","th","st","nd","rd","th","th","th","th","th","th","th","st"];config.messages.dates.am="am";config.messages.dates.pm="pm";merge(config.messages.tiddlerPopup,{});merge(config.views.wikified.tag,{labelNoTags:"no tags",labelTags:"tags: ",openTag:"Open tag '%0'",tooltip:"Show tiddlers tagged with '%0'",openAllText:"Open all",openAllTooltip:"Open all of these tiddlers",popupNone:"No other tiddlers tagged with '%0'"});merge(config.views.wikified,{defaultText:"The tiddler '%0' doesn't yet exist. Double-click to create it",defaultModifier:"(missing)",shadowModifier:"(built-in shadow tiddler)",dateFormat:"DD MMM YYYY",createdPrompt:"created"});merge(config.views.editor,{tagPrompt:"Type tags separated with spaces, [[use double square brackets]] if necessary, or add existing",defaultText:"Type the text for '%0'"});merge(config.views.editor.tagChooser,{text:"tags",tooltip:"Choose existing tags to add to this tiddler",popupNone:"There are no tags defined",tagTooltip:"Add the tag '%0'"});merge(config.messages,{sizeTemplates:[{unit:1024*1024*1024,template:"%0\u00a0GB"},{unit:1024*1024,template:"%0\u00a0MB"},{unit:1024,template:"%0\u00a0KB"},{unit:1,template:"%0\u00a0B"}]});merge(config.macros.search,{label:"search",prompt:"Search this TiddlyWiki",accessKey:"F",successMsg:"%0 tiddlers found matching %1",failureMsg:"No tiddlers found matching %0"});merge(config.macros.tagging,{label:"tagging: ",labelNotTag:"not tagging",tooltip:"List of tiddlers tagged with '%0'"});merge(config.macros.timeline,{dateFormat:"DD MMM YYYY"});merge(config.macros.allTags,{tooltip:"Show tiddlers tagged with '%0'",noTags:"There are no tagged tiddlers"});config.macros.list.all.prompt="All tiddlers in alphabetical order";config.macros.list.missing.prompt="Tiddlers that have links to them but are not defined";config.macros.list.orphans.prompt="Tiddlers that are not linked to from any other tiddlers";config.macros.list.shadowed.prompt="Tiddlers shadowed with default contents";config.macros.list.touched.prompt="Tiddlers that have been modified locally";merge(config.macros.closeAll,{label:"close all",prompt:"Close all displayed tiddlers (except any that are being edited)"});merge(config.macros.permaview,{label:"permaview",prompt:"Link to an URL that retrieves all the currently displayed tiddlers"});merge(config.macros.saveChanges,{label:"save changes",prompt:"Save all tiddlers to create a new TiddlyWiki",accessKey:"S"});merge(config.macros.newTiddler,{label:"new tiddler",prompt:"Create a new tiddler",title:"New Tiddler",accessKey:"N"});merge(config.macros.newJournal,{label:"new journal",prompt:"Create a new tiddler from the current date and time",accessKey:"J"});merge(config.macros.options,{wizardTitle:"Tweak advanced options",step1Title:"These options are saved in cookies in your browser",step1Html:"<input type='hidden' name='markList'></input><br><input type='checkbox' checked='false' name='chkUnknown'>Show unknown options</input>",unknownDescription:"//(unknown)//",listViewTemplate:{columns:[{name:"Option",field:"option",title:"Option",type:"String"},{name:"Description",field:"description",title:"Description",type:"WikiText"},{name:"Name",field:"name",title:"Name",type:"String"}],rowClasses:[{className:"lowlight",field:"lowlight"}]}});merge(config.macros.plugins,{wizardTitle:"Manage plugins",step1Title:"Currently loaded plugins",step1Html:"<input type='hidden' name='markList'></input>",skippedText:"(This plugin has not been executed because it was added since startup)",noPluginText:"There are no plugins installed",confirmDeleteText:"Are you sure you want to delete these plugins:\n\n%0",removeLabel:"remove systemConfig tag",removePrompt:"Remove systemConfig tag",deleteLabel:"delete",deletePrompt:"Delete these tiddlers forever",listViewTemplate:{columns:[{name:"Selected",field:"Selected",rowName:"title",type:"Selector"},{name:"Tiddler",field:"tiddler",title:"Tiddler",type:"Tiddler"},{name:"Description",field:"Description",title:"Description",type:"String"},{name:"Version",field:"Version",title:"Version",type:"String"},{name:"Size",field:"size",tiddlerLink:"size",title:"Size",type:"Size"},{name:"Forced",field:"forced",title:"Forced",tag:"systemConfigForce",type:"TagCheckbox"},{name:"Disabled",field:"disabled",title:"Disabled",tag:"systemConfigDisable",type:"TagCheckbox"},{name:"Executed",field:"executed",title:"Loaded",type:"Boolean",trueText:"Yes",falseText:"No"},{name:"Startup Time",field:"startupTime",title:"Startup Time",type:"String"},{name:"Error",field:"error",title:"Status",type:"Boolean",trueText:"Error",falseText:"OK"},{name:"Log",field:"log",title:"Log",type:"StringList"}],rowClasses:[{className:"error",field:"error"},{className:"warning",field:"warning"}]}});merge(config.macros.toolbar,{moreLabel:"more",morePrompt:"Show additional commands",lessLabel:"less",lessPrompt:"Hide additional commands",separator:"|"});merge(config.macros.refreshDisplay,{label:"refresh",prompt:"Redraw the entire TiddlyWiki display"});merge(config.macros.importTiddlers,{readOnlyWarning:"You cannot import into a read-only TiddlyWiki file. Try opening it from a file:// URL",wizardTitle:"Import tiddlers from another file or server",step1Title:"Step 1: Locate the server or TiddlyWiki file",step1Html:"Specify the type of the server: <select name='selTypes'><option value=''>Choose...</option></select><br>Enter the URL or pathname here: <input type='text' size=50 name='txtPath'><br>...or browse for a file: <input type='file' size=50 name='txtBrowse'><br><hr>...or select a pre-defined feed: <select name='selFeeds'><option value=''>Choose...</option></select>",openLabel:"open",openPrompt:"Open the connection to this file or server",statusOpenHost:"Opening the host",statusGetWorkspaceList:"Getting the list of available workspaces",step2Title:"Step 2: Choose the workspace",step2Html:"Enter a workspace name: <input type='text' size=50 name='txtWorkspace'><br>...or select a workspace: <select name='selWorkspace'><option value=''>Choose...</option></select>",cancelLabel:"cancel",cancelPrompt:"Cancel this import",statusOpenWorkspace:"Opening the workspace",statusGetTiddlerList:"Getting the list of available tiddlers",errorGettingTiddlerList:"Error getting list of tiddlers, click Cancel to try again",step3Title:"Step 3: Choose the tiddlers to import",step3Html:"<input type='hidden' name='markList'></input><br><input type='checkbox' checked='true' name='chkSync'>Keep these tiddlers linked to this server so that you can synchronise subsequent changes</input><br><input type='checkbox' name='chkSave'>Save the details of this server in a 'systemServer' tiddler called:</input> <input type='text' size=25 name='txtSaveTiddler'>",importLabel:"import",importPrompt:"Import these tiddlers",confirmOverwriteText:"Are you sure you want to overwrite these tiddlers:\n\n%0",step4Title:"Step 4: Importing %0 tiddler(s)",step4Html:"<input type='hidden' name='markReport'></input>",doneLabel:"done",donePrompt:"Close this wizard",statusDoingImport:"Importing tiddlers",statusDoneImport:"All tiddlers imported",systemServerNamePattern:"%2 on %1",systemServerNamePatternNoWorkspace:"%1",confirmOverwriteSaveTiddler:"The tiddler '%0' already exists. Click 'OK' to overwrite it with the details of this server, or 'Cancel' to leave it unchanged",serverSaveTemplate:"|''Type:''|%0|\n|''URL:''|%1|\n|''Workspace:''|%2|\n\nThis tiddler was automatically created to record the details of this server",serverSaveModifier:"(System)",listViewTemplate:{columns:[{name:"Selected",field:"Selected",rowName:"title",type:"Selector"},{name:"Tiddler",field:"tiddler",title:"Tiddler",type:"Tiddler"},{name:"Size",field:"size",tiddlerLink:"size",title:"Size",type:"Size"},{name:"Tags",field:"tags",title:"Tags",type:"Tags"}],rowClasses:[]}});merge(config.macros.upgrade,{wizardTitle:"Upgrade TiddlyWiki core code",step1Title:"Update or repair this TiddlyWiki to the latest release",step1Html:"You are about to upgrade to the latest release of the TiddlyWiki core code (from <a href='%0' class='externalLink' target='_blank'>%1</a>). Your content will be preserved across the upgrade.<br><br>Note that core upgrades have been known to interfere with older plugins. If you run into problems with the upgraded file, see <a href='http://www.tiddlywiki.org/wiki/CoreUpgrades' class='externalLink' target='_blank'>http://www.tiddlywiki.org/wiki/CoreUpgrades</a>",errorCantUpgrade:"Unable to upgrade this TiddlyWiki. You can only perform upgrades on TiddlyWiki files stored locally",errorNotSaved:"You must save changes before you can perform an upgrade",step2Title:"Confirm the upgrade details",step2Html_downgrade:"You are about to downgrade to TiddlyWiki version %0 from %1.<br><br>Downgrading to an earlier version of the core code is not recommended",step2Html_restore:"This TiddlyWiki appears to be already using the latest version of the core code (%0).<br><br>You can continue to upgrade anyway to ensure that the core code hasn't been corrupted or damaged",step2Html_upgrade:"You are about to upgrade to TiddlyWiki version %0 from %1",upgradeLabel:"upgrade",upgradePrompt:"Prepare for the upgrade process",statusPreparingBackup:"Preparing backup",statusSavingBackup:"Saving backup file",errorSavingBackup:"There was a problem saving the backup file",statusLoadingCore:"Loading core code",errorLoadingCore:"Error loading the core code",errorCoreFormat:"Error with the new core code",statusSavingCore:"Saving the new core code",statusReloadingCore:"Reloading the new core code",startLabel:"start",startPrompt:"Start the upgrade process",cancelLabel:"cancel",cancelPrompt:"Cancel the upgrade process",step3Title:"Upgrade cancelled",step3Html:"You have cancelled the upgrade process"});merge(config.macros.sync,{listViewTemplate:{columns:[{name:"Selected",field:"selected",rowName:"title",type:"Selector"},{name:"Tiddler",field:"tiddler",title:"Tiddler",type:"Tiddler"},{name:"Server Type",field:"serverType",title:"Server type",type:"String"},{name:"Server Host",field:"serverHost",title:"Server host",type:"String"},{name:"Server Workspace",field:"serverWorkspace",title:"Server workspace",type:"String"},{name:"Status",field:"status",title:"Synchronisation status",type:"String"},{name:"Server URL",field:"serverUrl",title:"Server URL",text:"View",type:"Link"}],rowClasses:[],buttons:[{caption:"Sync these tiddlers",name:"sync"}]},wizardTitle:"Synchronize with external servers and files",step1Title:"Choose the tiddlers you want to synchronize",step1Html:"<input type='hidden' name='markList'></input>",syncLabel:"sync",syncPrompt:"Sync these tiddlers",hasChanged:"Changed while unplugged",hasNotChanged:"Unchanged while unplugged",syncStatusList:{none:{text:"...",display:null,className:"notChanged"},changedServer:{text:"Changed on server",display:null,className:"changedServer"},changedLocally:{text:"Changed while unplugged",display:null,className:"changedLocally"},changedBoth:{text:"Changed while unplugged and on server",display:null,className:"changedBoth"},notFound:{text:"Not found on server",display:null,className:"notFound"},putToServer:{text:"Saved update on server",display:null,className:"putToServer"},gotFromServer:{text:"Retrieved update from server",display:null,className:"gotFromServer"}}});merge(config.macros.annotations,{});merge(config.commands.closeTiddler,{text:"close",tooltip:"Close this tiddler"});merge(config.commands.closeOthers,{text:"close others",tooltip:"Close all other tiddlers"});merge(config.commands.editTiddler,{text:"edit",tooltip:"Edit this tiddler",readOnlyText:"view",readOnlyTooltip:"View the source of this tiddler"});merge(config.commands.saveTiddler,{text:"done",tooltip:"Save changes to this tiddler"});merge(config.commands.cancelTiddler,{text:"cancel",tooltip:"Undo changes to this tiddler",warning:"Are you sure you want to abandon your changes to '%0'?",readOnlyText:"done",readOnlyTooltip:"View this tiddler normally"});merge(config.commands.deleteTiddler,{text:"delete",tooltip:"Delete this tiddler",warning:"Are you sure you want to delete '%0'?"});merge(config.commands.permalink,{text:"permalink",tooltip:"Permalink for this tiddler"});merge(config.commands.references,{text:"references",tooltip:"Show tiddlers that link to this one",popupNone:"No references"});merge(config.commands.jump,{text:"jump",tooltip:"Jump to another open tiddler"});merge(config.commands.syncing,{text:"syncing",tooltip:"Control synchronisation of this tiddler with a server or external file",currentlySyncing:"<div>Currently syncing via <span class='popupHighlight'>'%0'</span> to:</div><div>host: <span class='popupHighlight'>%1</span></div><div>workspace: <span class='popupHighlight'>%2</span></div>",notCurrentlySyncing:"Not currently syncing",captionUnSync:"Stop synchronising this tiddler",chooseServer:"Synchronise this tiddler with another server:",currServerMarker:"\u25cf ",notCurrServerMarker:"  "});merge(config.commands.fields,{text:"fields",tooltip:"Show the extended fields of this tiddler",emptyText:"There are no extended fields for this tiddler",listViewTemplate:{columns:[{name:"Field",field:"field",title:"Field",type:"String"},{name:"Value",field:"value",title:"Value",type:"String"}],rowClasses:[],buttons:[]}});merge(config.shadowTiddlers,{DefaultTiddlers:"[[GettingStarted]]",MainMenu:"[[GettingStarted]]",SiteTitle:"My TiddlyWiki",SiteSubtitle:"a reusable non-linear personal web notebook",SiteUrl:"",SideBarOptions:'<<search>><<closeAll>><<permaview>><<newTiddler>><<newJournal "DD MMM YYYY" "journal">><<saveChanges>><<slider chkSliderOptionsPanel OptionsPanel "options \u00bb" "Change TiddlyWiki advanced options">>',SideBarTabs:'<<tabs txtMainTab "Timeline" "Timeline" TabTimeline "All" "All tiddlers" TabAll "Tags" "All tags" TabTags "More" "More lists" TabMore>>',TabMore:'<<tabs txtMoreTab "Missing" "Missing tiddlers" TabMoreMissing "Orphans" "Orphaned tiddlers" TabMoreOrphans "Shadowed" "Shadowed tiddlers" TabMoreShadowed>>'});merge(config.annotations,{AdvancedOptions:"This shadow tiddler provides access to several advanced options",ColorPalette:"These values in this shadow tiddler determine the colour scheme of the ~TiddlyWiki user interface",DefaultTiddlers:"The tiddlers listed in this shadow tiddler will be automatically displayed when ~TiddlyWiki starts up",EditTemplate:"The HTML template in this shadow tiddler determines how tiddlers look while they are being edited",GettingStarted:"This shadow tiddler provides basic usage instructions",ImportTiddlers:"This shadow tiddler provides access to importing tiddlers",MainMenu:"This shadow tiddler is used as the contents of the main menu in the left-hand column of the screen",MarkupPreHead:"This tiddler is inserted at the top of the <head> section of the TiddlyWiki HTML file",MarkupPostHead:"This tiddler is inserted at the bottom of the <head> section of the TiddlyWiki HTML file",MarkupPreBody:"This tiddler is inserted at the top of the <body> section of the TiddlyWiki HTML file",MarkupPostBody:"This tiddler is inserted at the end of the <body> section of the TiddlyWiki HTML file immediately after the script block",OptionsPanel:"This shadow tiddler is used as the contents of the options panel slider in the right-hand sidebar",PageTemplate:"The HTML template in this shadow tiddler determines the overall ~TiddlyWiki layout",PluginManager:"This shadow tiddler provides access to the plugin manager",SideBarOptions:"This shadow tiddler is used as the contents of the option panel in the right-hand sidebar",SideBarTabs:"This shadow tiddler is used as the contents of the tabs panel in the right-hand sidebar",SiteSubtitle:"This shadow tiddler is used as the second part of the page title",SiteTitle:"This shadow tiddler is used as the first part of the page title",SiteUrl:"This shadow tiddler should be set to the full target URL for publication",StyleSheetColors:"This shadow tiddler contains CSS definitions related to the color of page elements. ''DO NOT EDIT THIS TIDDLER'', instead make your changes in the StyleSheet shadow tiddler",StyleSheet:"This tiddler can contain custom CSS definitions",StyleSheetLayout:"This shadow tiddler contains CSS definitions related to the layout of page elements. ''DO NOT EDIT THIS TIDDLER'', instead make your changes in the StyleSheet shadow tiddler",StyleSheetLocale:"This shadow tiddler contains CSS definitions related to the translation locale",StyleSheetPrint:"This shadow tiddler contains CSS definitions for printing",TabAll:"This shadow tiddler contains the contents of the 'All' tab in the right-hand sidebar",TabMore:"This shadow tiddler contains the contents of the 'More' tab in the right-hand sidebar",TabMoreMissing:"This shadow tiddler contains the contents of the 'Missing' tab in the right-hand sidebar",TabMoreOrphans:"This shadow tiddler contains the contents of the 'Orphans' tab in the right-hand sidebar",TabMoreShadowed:"This shadow tiddler contains the contents of the 'Shadowed' tab in the right-hand sidebar",TabTags:"This shadow tiddler contains the contents of the 'Tags' tab in the right-hand sidebar",TabTimeline:"This shadow tiddler contains the contents of the 'Timeline' tab in the right-hand sidebar",ToolbarCommands:"This shadow tiddler determines which commands are shown in tiddler toolbars",ViewTemplate:"The HTML template in this shadow tiddler determines how tiddlers look"});var params=null;var store=null;var story=null;var formatter=null;var anim=typeof Animator=="function"?new Animator():null;var readOnly=false;var highlightHack=null;var hadConfirmExit=false;var safeMode=false;var showBackstage;var installedPlugins=[];var startingUp=false;var pluginInfo,tiddler;var useJavaSaver=(config.browser.isSafari||config.browser.isOpera)&&(document.location.toString().substr(0,4)!="http");function main(){var a,b,c,e,f,h,j,k,l,n,o=new Date();startingUp=true;var p=jQuery(document);jQuery.noConflict();window.onbeforeunload=function(m){if(window.confirmExit){return confirmExit()}};params=getParameters();if(params){params=params.parseParams("open",null,false)}store=new TiddlyWiki();invokeParamifier(params,"oninit");story=new Story("tiddlerDisplay","tiddler");addEvent(document,"click",Popup.onDocumentClick);saveTest();loadOptionsCookie();for(var q=0;q<config.notifyTiddlers.length;q++){store.addNotification(config.notifyTiddlers[q].name,config.notifyTiddlers[q].notify)}n=new Date();loadShadowTiddlers();p.trigger("loadShadows");l=new Date();store.loadFromDiv("storeArea","store",true);p.trigger("loadTiddlers");k=new Date();invokeParamifier(params,"onload");j=new Date();readOnly=(window.location.protocol=="file:")?false:config.options.chkHttpReadOnly;var g=loadPlugins();p.trigger("loadPlugins");h=new Date();formatter=new Formatter(config.formatters);invokeParamifier(params,"onconfig");story.switchTheme(config.options.txtTheme);showBackstage=showBackstage!==undefined?showBackstage:!readOnly;f=new Date();for(var d in config.macros){if(config.macros[d].init){config.macros[d].init()}}e=new Date();store.notifyAll();c=new Date();restart();refreshDisplay();b=new Date();if(g){story.displayTiddler(null,"PluginManager");displayMessage(config.messages.customConfigError)}if(showBackstage){backstage.init()}a=new Date();if(config.options.chkDisplayInstrumentation){displayMessage("LoadShadows "+(l-n)+" ms");displayMessage("LoadFromDiv "+(k-l)+" ms");displayMessage("LoadPlugins "+(h-j)+" ms");displayMessage("Macro init "+(e-f)+" ms");displayMessage("Notify "+(c-e)+" ms");displayMessage("Restart "+(b-c)+" ms");displayMessage("Total: "+(a-o)+" ms")}startingUp=false;p.trigger("startup")}function unload(){if(window.checkUnsavedChanges){checkUnsavedChanges()}if(window.scrubNodes){scrubNodes(document.body)}}function restart(){invokeParamifier(params,"onstart");if(story.isEmpty()){story.displayDefaultTiddlers()}window.scrollTo(0,0)}function saveTest(){var a=document.getElementById("saveTest");if(a.hasChildNodes()){alert(config.messages.savedSnapshotError)}a.appendChild(document.createTextNode("savetest"))}function loadShadowTiddlers(){var a=new TiddlyWiki();a.loadFromDiv("shadowArea","shadows",true);a.forEachTiddler(function(c,b){config.shadowTiddlers[c]=b.text});delete a}function loadPlugins(){if(safeMode){return false}var tiddlers=store.getTaggedTiddlers("systemConfig");var toLoad=[];var nLoaded=0;var map={};var nPlugins=tiddlers.length;installedPlugins=[];for(var i=0;i<nPlugins;i++){var p=getPluginInfo(tiddlers[i]);installedPlugins[i]=p;var n=p.Name||p.title;if(n){map[n]=p}n=p.Source;if(n){map[n]=p}}var visit=function(p){if(!p||p.done){return}p.done=1;var reqs=p.Requires;if(reqs){reqs=reqs.readBracketedList();for(var i=0;i<reqs.length;i++){visit(map[reqs[i]])}}toLoad.push(p)};for(i=0;i<nPlugins;i++){visit(installedPlugins[i])}for(i=0;i<toLoad.length;i++){p=toLoad[i];pluginInfo=p;tiddler=p.tiddler;if(isPluginExecutable(p)){if(isPluginEnabled(p)){p.executed=true;var startTime=new Date();try{if(tiddler.text){window.eval(tiddler.text)}nLoaded++}catch(ex){p.log.push(config.messages.pluginError.format([exceptionText(ex)]));p.error=true;if(!console.tiddlywiki){console.log("error evaluating "+tiddler.title,ex)}}pluginInfo.startupTime=String((new Date())-startTime)+"ms"}else{nPlugins--}}else{p.warning=true}}return nLoaded!=nPlugins}function getPluginInfo(a){var b=store.getTiddlerSlices(a.title,["Name","Description","Version","Requires","CoreVersion","Date","Source","Author","License","Browsers"]);b.tiddler=a;b.title=a.title;b.log=[];return b}function isPluginExecutable(c){if(c.tiddler.isTagged("systemConfigForce")){c.log.push(config.messages.pluginForced);return true}if(c.CoreVersion){var b=c.CoreVersion.split(".");var a=parseInt(b[0],10)-version.major;if(a==0&&b[1]){a=parseInt(b[1],10)-version.minor}if(a==0&&b[2]){a=parseInt(b[2],10)-version.revision}if(a>0){c.log.push(config.messages.pluginVersionError);return false}}return true}function isPluginEnabled(a){if(a.tiddler.isTagged("systemConfigDisable")){a.log.push(config.messages.pluginDisabled);return false}return true}function invokeMacro(b,g,h,f,d){try{var a=config.macros[g];if(a&&a.handler){var e=story.findContainingTiddler(b);window.tiddler=e?store.getTiddler(e.getAttribute("tiddler")):null;window.place=b;a.handler(b,g,a.noPreParse?null:h.readMacroParams(),f,h,d)}else{createTiddlyError(b,config.messages.macroError.format([g]),config.messages.macroErrorDetails.format([g,config.messages.missingMacro]))}}catch(c){createTiddlyError(b,config.messages.macroError.format([g]),config.messages.macroErrorDetails.format([g,c.toString()]))}}function getParameters(){var a=null;if(window.location.hash){a=decodeURIComponent(window.location.hash.substr(1));if(config.browser.firefoxDate!=null&&config.browser.firefoxDate[1]<"20051111"){a=convertUTF8ToUnicode(a)}}return a}function invokeParamifier(e,c){if(!e||e.length==undefined||e.length<=1){return}for(var a=1;a<e.length;a++){var d=config.paramifiers[e[a].name];if(d&&d[c] instanceof Function){d[c](e[a].value)}else{var b=config.optionHandlers[e[a].name.substr(0,3)];if(b&&b.set instanceof Function){b.set(e[a].name,e[a].value)}}}}config.paramifiers={};config.paramifiers.start={oninit:function(a){safeMode=a.toLowerCase()=="safe"}};config.paramifiers.open={onstart:function(a){if(!readOnly||store.tiddlerExists(a)||store.isShadowTiddler(a)){story.displayTiddler("bottom",a,null,false,null)}}};config.paramifiers.story={onstart:function(a){var b=store.getTiddlerText(a,"").parseParams("open",null,false);invokeParamifier(b,"onstart")}};config.paramifiers.search={onstart:function(a){story.search(a,false,false)}};config.paramifiers.searchRegExp={onstart:function(a){story.prototype.search(a,false,true)}};config.paramifiers.tag={onstart:function(a){story.displayTiddlers(null,store.filterTiddlers("[tag["+a+"]]"),null,false,null)}};config.paramifiers.newTiddler={onstart:function(a){if(!readOnly){story.displayTiddler(null,a,DEFAULT_EDIT_TEMPLATE);story.focusTiddler(a,"text")}}};config.paramifiers.newJournal={onstart:function(a){if(!readOnly){var b=new Date();var c=b.formatString(a.trim());story.displayTiddler(null,c,DEFAULT_EDIT_TEMPLATE);story.focusTiddler(c,"text")}}};config.paramifiers.readOnly={onconfig:function(a){var b=a.toLowerCase();readOnly=b=="yes"?true:(b=="no"?false:readOnly)}};config.paramifiers.theme={onconfig:function(a){story.switchTheme(a)}};config.paramifiers.upgrade={onstart:function(a){upgradeFrom(a)}};config.paramifiers.recent={onstart:function(a){var d=[];var c=store.getTiddlers("modified","excludeLists").reverse();for(var b=0;b<a&&b<c.length;b++){d.push(c[b].title)}story.displayTiddlers(null,d)}};config.paramifiers.filter={onstart:function(a){story.displayTiddlers(null,store.filterTiddlers(a),null,false)}};function Formatter(a){this.formatters=[];var b=[];for(var c=0;c<a.length;c++){b.push("("+a[c].match+")");this.formatters.push(a[c])}this.formatterRegExp=new RegExp(b.join("|"),"mg")}config.formatterHelpers={createElementAndWikify:function(a){a.subWikifyTerm(createTiddlyElement(a.output,this.element),this.termRegExp)},inlineCssHelper:function(a){var e=[];config.textPrimitives.cssLookaheadRegExp.lastIndex=a.nextMatch;var c=config.textPrimitives.cssLookaheadRegExp.exec(a.source);while(c&&c.index==a.nextMatch){var d,b;if(c[1]){d=c[1].unDash();b=c[2]}else{d=c[3].unDash();b=c[4]}if(d=="bgcolor"){d="backgroundColor"}e.push({style:d,value:b});a.nextMatch=c.index+c[0].length;config.textPrimitives.cssLookaheadRegExp.lastIndex=a.nextMatch;c=config.textPrimitives.cssLookaheadRegExp.exec(a.source)}return e},applyCssHelper:function(d,c){for(var b=0;b<c.length;b++){try{d.style[c[b].style]=c[b].value}catch(a){}}},enclosedTextHelper:function(a){this.lookaheadRegExp.lastIndex=a.matchStart;var b=this.lookaheadRegExp.exec(a.source);if(b&&b.index==a.matchStart){var c=b[1];if(config.browser.isIE){c=c.replace(/\n/g,"\r")}createTiddlyElement(a.output,this.element,null,null,c);a.nextMatch=b.index+b[0].length}},isExternalLink:function(a){if(store.tiddlerExists(a)||store.isShadowTiddler(a)){return false}var b=new RegExp(config.textPrimitives.urlPattern,"mg");if(b.exec(a)){return true}if(a.indexOf(".")!=-1||a.indexOf("\\")!=-1||a.indexOf("/")!=-1||a.indexOf("#")!=-1){return true}return false}};config.formatters=[{name:"table",match:"^\\|(?:[^\\n]*)\\|(?:[fhck]?)$",lookaheadRegExp:/^\|([^\n]*)\|([fhck]?)$/mg,rowTermRegExp:/(\|(?:[fhck]?)$\n?)/mg,cellRegExp:/(?:\|([^\n\|]*)\|)|(\|[fhck]?$\n?)/mg,cellTermRegExp:/((?:\x20*)\|)/mg,rowTypes:{c:"caption",h:"thead","":"tbody",f:"tfoot"},handler:function(f){var h=createTiddlyElement(f.output,"table",null,"twtable");var g=[];var c=null;var j;var e=0;f.nextMatch=f.matchStart;this.lookaheadRegExp.lastIndex=f.nextMatch;var d=this.lookaheadRegExp.exec(f.source);while(d&&d.index==f.nextMatch){var a=d[2];if(a=="k"){h.className=d[1];f.nextMatch+=d[0].length+1}else{if(a!=c){j=createTiddlyElement(h,this.rowTypes[a]);c=a}if(c=="c"){f.nextMatch++;if(j!=h.firstChild){h.insertBefore(j,h.firstChild)}j.setAttribute("align",e==0?"top":"bottom");f.subWikifyTerm(j,this.rowTermRegExp)}else{var b=createTiddlyElement(j,"tr",null,(e&1)?"oddRow":"evenRow");b.onmouseover=function(){addClass(this,"hoverRow")};b.onmouseout=function(){removeClass(this,"hoverRow")};this.rowHandler(f,b,g);e++}}this.lookaheadRegExp.lastIndex=f.nextMatch;d=this.lookaheadRegExp.exec(f.source)}},rowHandler:function(j,f,m){var a=0;var c=1;var h=null;this.cellRegExp.lastIndex=j.nextMatch;var g=this.cellRegExp.exec(j.source);while(g&&g.index==j.nextMatch){if(g[1]=="~"){var l=m[a];if(l){l.rowSpanCount++;l.element.setAttribute("rowspan",l.rowSpanCount);l.element.setAttribute("rowSpan",l.rowSpanCount);l.element.valign="center";if(c>1){l.element.setAttribute("colspan",c);l.element.setAttribute("colSpan",c);c=1}}j.nextMatch=this.cellRegExp.lastIndex-1}else{if(g[1]==">"){c++;j.nextMatch=this.cellRegExp.lastIndex-1}else{if(g[2]){if(h&&c>1){h.setAttribute("colspan",c);h.setAttribute("colSpan",c)}j.nextMatch=this.cellRegExp.lastIndex;break}else{j.nextMatch++;var n=config.formatterHelpers.inlineCssHelper(j);var d=false;var b=j.source.substr(j.nextMatch,1);while(b==" "){d=true;j.nextMatch++;b=j.source.substr(j.nextMatch,1)}var k;if(b=="!"){k=createTiddlyElement(f,"th");j.nextMatch++}else{k=createTiddlyElement(f,"td")}h=k;m[a]={rowSpanCount:1,element:k};if(c>1){k.setAttribute("colspan",c);k.setAttribute("colSpan",c);c=1}config.formatterHelpers.applyCssHelper(k,n);j.subWikifyTerm(k,this.cellTermRegExp);if(j.matchText.substr(j.matchText.length-2,1)==" "){k.align=d?"center":"left"}else{if(d){k.align="right"}}j.nextMatch--}}}a++;this.cellRegExp.lastIndex=j.nextMatch;g=this.cellRegExp.exec(j.source)}}},{name:"heading",match:"^!{1,6}",termRegExp:/(\n)/mg,handler:function(a){a.subWikifyTerm(createTiddlyElement(a.output,"h"+a.matchLength),this.termRegExp)}},{name:"list",match:"^(?:[\\*#;:]+)",lookaheadRegExp:/^(?:(?:(\*)|(#)|(;)|(:))+)/mg,termRegExp:/(\n)/mg,handler:function(l){var j=[l.output];var b=0,m=null;var h,k,f,g;l.nextMatch=l.matchStart;this.lookaheadRegExp.lastIndex=l.nextMatch;var a=this.lookaheadRegExp.exec(l.source);while(a&&a.index==l.nextMatch){if(a[1]){k="ul";f="li"}else{if(a[2]){k="ol";f="li"}else{if(a[3]){k="dl";f="dt"}else{if(a[4]){k="dl";f="dd"}}}}if(!g){g=k}h=a[0].length;l.nextMatch+=a[0].length;var n;if(h>b){for(n=b;n<h;n++){var d=(b==0)?j[j.length-1]:j[j.length-1].lastChild;j.push(createTiddlyElement(d,k))}}else{if(k!=g&&h==1){l.nextMatch-=a[0].length;return}else{if(h<b){for(n=b;n>h;n--){j.pop()}}else{if(h==b&&k!=m){j.pop();j.push(createTiddlyElement(j[j.length-1].lastChild,k))}}}}b=h;m=k;var c=createTiddlyElement(j[j.length-1],f);l.subWikifyTerm(c,this.termRegExp);this.lookaheadRegExp.lastIndex=l.nextMatch;a=this.lookaheadRegExp.exec(l.source)}}},{name:"quoteByBlock",match:"^<<<\\n",termRegExp:/(^<<<(\n|$))/mg,element:"blockquote",handler:config.formatterHelpers.createElementAndWikify},{name:"quoteByLine",match:"^>+",lookaheadRegExp:/^>+/mg,termRegExp:/(\n)/mg,element:"blockquote",handler:function(d){var c=[d.output];var g=0;var b=d.matchLength;var f;do{if(b>g){for(f=g;f<b;f++){c.push(createTiddlyElement(c[c.length-1],this.element))}}else{if(b<g){for(f=g;f>b;f--){c.pop()}}}g=b;d.subWikifyTerm(c[c.length-1],this.termRegExp);createTiddlyElement(c[c.length-1],"br");this.lookaheadRegExp.lastIndex=d.nextMatch;var e=this.lookaheadRegExp.exec(d.source);var a=e&&e.index==d.nextMatch;if(a){b=e[0].length;d.nextMatch+=e[0].length}}while(a)}},{name:"rule",match:"^----+$\\n?|<hr ?/?>\\n?",handler:function(a){createTiddlyElement(a.output,"hr")}},{name:"monospacedByLine",match:"^(?:/\\*\\{\\{\\{\\*/|\\{\\{\\{|//\\{\\{\\{|<!--\\{\\{\\{-->)\\n",element:"pre",handler:function(a){switch(a.matchText){case"/*{{{*/\n":this.lookaheadRegExp=/\/\*\{\{\{\*\/\n*((?:^[^\n]*\n)+?)(\n*^\f*\/\*\}\}\}\*\/$\n?)/mg;break;case"{{{\n":this.lookaheadRegExp=/^\{\{\{\n((?:^[^\n]*\n)+?)(^\f*\}\}\}$\n?)/mg;break;case"//{{{\n":this.lookaheadRegExp=/^\/\/\{\{\{\n\n*((?:^[^\n]*\n)+?)(\n*^\f*\/\/\}\}\}$\n?)/mg;break;case"<!--{{{-->\n":this.lookaheadRegExp=/<!--\{\{\{-->\n*((?:^[^\n]*\n)+?)(\n*^\f*<!--\}\}\}-->$\n?)/mg;break;default:break}config.formatterHelpers.enclosedTextHelper.call(this,a)}},{name:"wikifyComment",match:"^(?:/\\*\\*\\*|<!---)\\n",handler:function(a){var b=(a.matchText=="/***\n")?(/(^\*\*\*\/\n)/mg):(/(^--->\n)/mg);a.subWikifyTerm(a.output,b)}},{name:"macro",match:"<<",lookaheadRegExp:/<<([^>\s]+)(?:\s*)((?:[^>]|(?:>(?!>)))*)>>/mg,handler:function(a){this.lookaheadRegExp.lastIndex=a.matchStart;var b=this.lookaheadRegExp.exec(a.source);if(b&&b.index==a.matchStart&&b[1]){a.nextMatch=this.lookaheadRegExp.lastIndex;invokeMacro(a.output,b[1],b[2],a,a.tiddler)}}},{name:"prettyLink",match:"\\[\\[",lookaheadRegExp:/\[\[(.*?)(?:\|(~)?(.*?))?\]\]/mg,handler:function(a){this.lookaheadRegExp.lastIndex=a.matchStart;var b=this.lookaheadRegExp.exec(a.source);if(b&&b.index==a.matchStart){var d;var f=b[1];if(b[3]){var c=b[3];d=(!b[2]&&config.formatterHelpers.isExternalLink(c))?createExternalLink(a.output,c):createTiddlyLink(a.output,c,false,null,a.isStatic,a.tiddler)}else{d=createTiddlyLink(a.output,f,false,null,a.isStatic,a.tiddler)}createTiddlyText(d,f);a.nextMatch=this.lookaheadRegExp.lastIndex}}},{name:"wikiLink",match:config.textPrimitives.unWikiLink+"?"+config.textPrimitives.wikiLink,handler:function(a){if(a.matchText.substr(0,1)==config.textPrimitives.unWikiLink){a.outputText(a.output,a.matchStart+1,a.nextMatch);return}if(a.matchStart>0){var c=new RegExp(config.textPrimitives.anyLetterStrict,"mg");c.lastIndex=a.matchStart-1;var b=c.exec(a.source);if(b.index==a.matchStart-1){a.outputText(a.output,a.matchStart,a.nextMatch);return}}if(a.autoLinkWikiWords||store.isShadowTiddler(a.matchText)){var d=createTiddlyLink(a.output,a.matchText,false,null,a.isStatic,a.tiddler);a.outputText(d,a.matchStart,a.nextMatch)}else{a.outputText(a.output,a.matchStart,a.nextMatch)}}},{name:"urlLink",match:config.textPrimitives.urlPattern,handler:function(a){a.outputText(createExternalLink(a.output,a.matchText),a.matchStart,a.nextMatch)}},{name:"image",match:"\\[[<>]?[Ii][Mm][Gg]\\[",lookaheadRegExp:/\[([<]?)(>?)[Ii][Mm][Gg]\[(?:([^\|\]]+)\|)?([^\[\]\|]+)\](?:\[([^\]]*)\])?\]/mg,handler:function(a){this.lookaheadRegExp.lastIndex=a.matchStart;var c=this.lookaheadRegExp.exec(a.source);if(c&&c.index==a.matchStart){var f=a.output;if(c[5]){var d=c[5];f=config.formatterHelpers.isExternalLink(d)?createExternalLink(a.output,d):createTiddlyLink(a.output,d,false,null,a.isStatic,a.tiddler);addClass(f,"imageLink")}var b=createTiddlyElement(f,"img");if(c[1]){b.align="left"}else{if(c[2]){b.align="right"}}if(c[3]){b.title=c[3];b.setAttribute("alt",c[3])}b.src=c[4];a.nextMatch=this.lookaheadRegExp.lastIndex}}},{name:"html",match:"<[Hh][Tt][Mm][Ll]>",lookaheadRegExp:/<[Hh][Tt][Mm][Ll]>((?:.|\n)*?)<\/[Hh][Tt][Mm][Ll]>/mg,handler:function(a){this.lookaheadRegExp.lastIndex=a.matchStart;var b=this.lookaheadRegExp.exec(a.source);if(b&&b.index==a.matchStart){createTiddlyElement(a.output,"span").innerHTML=b[1];a.nextMatch=this.lookaheadRegExp.lastIndex}}},{name:"commentByBlock",match:"/%",lookaheadRegExp:/\/%((?:.|\n)*?)%\//mg,handler:function(a){this.lookaheadRegExp.lastIndex=a.matchStart;var b=this.lookaheadRegExp.exec(a.source);if(b&&b.index==a.matchStart){a.nextMatch=this.lookaheadRegExp.lastIndex}}},{name:"characterFormat",match:"''|//|__|\\^\\^|~~|--(?!\\s|$)|\\{\\{\\{",handler:function(a){switch(a.matchText){case"''":a.subWikifyTerm(a.output.appendChild(document.createElement("strong")),/('')/mg);break;case"//":a.subWikifyTerm(createTiddlyElement(a.output,"em"),/(\/\/)/mg);break;case"__":a.subWikifyTerm(createTiddlyElement(a.output,"u"),/(__)/mg);break;case"^^":a.subWikifyTerm(createTiddlyElement(a.output,"sup"),/(\^\^)/mg);break;case"~~":a.subWikifyTerm(createTiddlyElement(a.output,"sub"),/(~~)/mg);break;case"--":a.subWikifyTerm(createTiddlyElement(a.output,"strike"),/(--)/mg);break;case"{{{":var b=/\{\{\{((?:.|\n)*?)\}\}\}/mg;b.lastIndex=a.matchStart;var c=b.exec(a.source);if(c&&c.index==a.matchStart){createTiddlyElement(a.output,"code",null,null,c[1]);a.nextMatch=b.lastIndex}break}}},{name:"customFormat",match:"@@|\\{\\{",handler:function(a){switch(a.matchText){case"@@":var f=createTiddlyElement(a.output,"span");var d=config.formatterHelpers.inlineCssHelper(a);if(d.length==0){f.className="marked"}else{config.formatterHelpers.applyCssHelper(f,d)}a.subWikifyTerm(f,/(@@)/mg);break;case"{{":var b=/\{\{[\s]*([\w]+[\s\w]*)[\s]*\{(\n?)/mg;b.lastIndex=a.matchStart;var c=b.exec(a.source);if(c){a.nextMatch=b.lastIndex;f=createTiddlyElement(a.output,c[2]=="\n"?"div":"span",null,c[1]);a.subWikifyTerm(f,/(\}\}\})/mg)}break}}},{name:"mdash",match:"--",handler:function(a){createTiddlyElement(a.output,"span").innerHTML="&mdash;"}},{name:"lineBreak",match:"\\n|<br ?/?>",handler:function(a){createTiddlyElement(a.output,"br")}},{name:"rawText",match:'"{3}|<nowiki>',lookaheadRegExp:/(?:\"{3}|<nowiki>)((?:.|\n)*?)(?:\"{3}|<\/nowiki>)/mg,handler:function(a){this.lookaheadRegExp.lastIndex=a.matchStart;var b=this.lookaheadRegExp.exec(a.source);if(b&&b.index==a.matchStart){createTiddlyElement(a.output,"span",null,null,b[1]);a.nextMatch=this.lookaheadRegExp.lastIndex}}},{name:"htmlEntitiesEncoding",match:"(?:(?:&#?[a-zA-Z0-9]{2,8};|.)(?:&#?(?:x0*(?:3[0-6][0-9a-fA-F]|1D[c-fC-F][0-9a-fA-F]|20[d-fD-F][0-9a-fA-F]|FE2[0-9a-fA-F])|0*(?:76[89]|7[7-9][0-9]|8[0-7][0-9]|761[6-9]|76[2-7][0-9]|84[0-3][0-9]|844[0-7]|6505[6-9]|6506[0-9]|6507[0-1]));)+|&#?[a-zA-Z0-9]{2,8};)",handler:function(a){createTiddlyElement(a.output,"span").innerHTML=a.matchText}}];function getParser(b,c){if(b){if(!c){c=b.fields.wikiformat}var a;if(c){for(a in config.parsers){if(c==config.parsers[a].format){return config.parsers[a]}}}else{for(a in config.parsers){if(b.isTagged(config.parsers[a].formatTag)){return config.parsers[a]}}}}return formatter}function wikify(e,a,f,b){if(e){var c=new Wikifier(e,getParser(b),f,b);var d=new Date();c.subWikify(a);if(b&&config.options.chkDisplayInstrumentation){displayMessage("wikify:"+b.title+" in "+(new Date()-d)+" ms")}}}function wikifyStatic(d,h,b,g){var f=createTiddlyElement(document.body,"pre");f.style.display="none";var a="";if(d&&d!=""){if(!b){b=new Tiddler("temp")}var c=new Wikifier(d,getParser(b,g),h,b);c.isStatic=true;c.subWikify(f);a=f.innerHTML;removeNode(f)}return a}function wikifyPlain(c,b,a){if(!b){b=store}if(b.tiddlerExists(c)||b.isShadowTiddler(c)){return wikifyPlainText(b.getTiddlerText(c),a,tiddler)}else{return""}}function wikifyPlainText(d,a,b){if(a>0){d=d.substr(0,a)}var c=new Wikifier(d,formatter,null,b);return c.wikifyPlain()}function highlightify(d,a,e,b){if(d){var c=new Wikifier(d,formatter,e,b);c.outputText(a,0,d.length)}}function Wikifier(c,b,d,a){this.source=c;this.output=null;this.formatter=b;this.nextMatch=0;this.autoLinkWikiWords=a&&a.autoLinkWikiWords()==false?false:true;this.highlightRegExp=d;this.highlightMatch=null;this.isStatic=false;if(d){d.lastIndex=0;this.highlightMatch=d.exec(c)}this.tiddler=a}Wikifier.prototype.wikifyPlain=function(){var a=createTiddlyElement(document.body,"div");a.style.display="none";this.subWikify(a);var b=getPlainText(a);removeNode(a);return b};Wikifier.prototype.subWikify=function(b,a){try{if(a){this.subWikifyTerm(b,new RegExp("("+a+")","mg"))}else{this.subWikifyUnterm(b)}}catch(c){showException(c)}};Wikifier.prototype.subWikifyUnterm=function(b){var a=this.output;this.output=b;this.formatter.formatterRegExp.lastIndex=this.nextMatch;var d=this.formatter.formatterRegExp.exec(this.source);while(d){if(d.index>this.nextMatch){this.outputText(this.output,this.nextMatch,d.index)}this.matchStart=d.index;this.matchLength=d[0].length;this.matchText=d[0];this.nextMatch=this.formatter.formatterRegExp.lastIndex;for(var c=1;c<d.length;c++){if(d[c]){this.formatter.formatters[c-1].handler(this);this.formatter.formatterRegExp.lastIndex=this.nextMatch;break}}d=this.formatter.formatterRegExp.exec(this.source)}if(this.nextMatch<this.source.length){this.outputText(this.output,this.nextMatch,this.source.length);this.nextMatch=this.source.length}this.output=a};Wikifier.prototype.subWikifyTerm=function(b,e){var a=this.output;this.output=b;e.lastIndex=this.nextMatch;var d=e.exec(this.source);this.formatter.formatterRegExp.lastIndex=this.nextMatch;var f=this.formatter.formatterRegExp.exec(d?this.source.substr(0,d.index):this.source);while(d||f){if(d&&(!f||d.index<=f.index)){if(d.index>this.nextMatch){this.outputText(this.output,this.nextMatch,d.index)}this.matchText=d[1];this.matchLength=d[1].length;this.matchStart=d.index;this.nextMatch=this.matchStart+this.matchLength;this.output=a;return}if(f.index>this.nextMatch){this.outputText(this.output,this.nextMatch,f.index)}this.matchStart=f.index;this.matchLength=f[0].length;this.matchText=f[0];this.nextMatch=this.formatter.formatterRegExp.lastIndex;for(var c=1;c<f.length;c++){if(f[c]){this.formatter.formatters[c-1].handler(this);this.formatter.formatterRegExp.lastIndex=this.nextMatch;break}}e.lastIndex=this.nextMatch;d=e.exec(this.source);f=this.formatter.formatterRegExp.exec(d?this.source.substr(0,d.index):this.source)}if(this.nextMatch<this.source.length){this.outputText(this.output,this.nextMatch,this.source.length);this.nextMatch=this.source.length}this.output=a};Wikifier.prototype.outputText=function(a,c,b){while(this.highlightMatch&&(this.highlightRegExp.lastIndex>c)&&(this.highlightMatch.index<b)&&(c<b)){if(this.highlightMatch.index>c){createTiddlyText(a,this.source.substring(c,this.highlightMatch.index));c=this.highlightMatch.index}var e=Math.min(this.highlightRegExp.lastIndex,b);var d=createTiddlyElement(a,"span",null,"highlight",this.source.substring(c,e));c=e;if(c>=this.highlightRegExp.lastIndex){this.highlightMatch=this.highlightRegExp.exec(this.source)}}if(c<b){createTiddlyText(a,this.source.substring(c,b))}};config.macros.today.handler=function(a,c,e){var b=new Date();var d=e[0]?b.formatString(e[0].trim()):b.toLocaleString();jQuery("<span/>").text(d).appendTo(a)};config.macros.version.handler=function(a){jQuery("<span/>").text(formatVersion()).appendTo(a)};config.macros.list.handler=function(b,g,h){var e=h[0]||"all";var f=document.createElement("ul");b.appendChild(f);if(this[e].prompt){createTiddlyElement(f,"li",null,"listTitle",this[e].prompt)}var d;if(this[e].handler){d=this[e].handler(h)}for(var c=0;c<d.length;c++){var a=document.createElement("li");f.appendChild(a);createTiddlyLink(a,typeof d[c]=="string"?d[c]:d[c].title,true)}};config.macros.list.all.handler=function(a){return store.reverseLookup("tags","excludeLists",false,"title")};config.macros.list.missing.handler=function(a){return store.getMissingLinks()};config.macros.list.orphans.handler=function(a){return store.getOrphans()};config.macros.list.shadowed.handler=function(a){return store.getShadowed()};config.macros.list.touched.handler=function(a){return store.getTouched()};config.macros.list.filter.handler=function(e){var c=e[1];var b=[];if(c){var d=store.filterTiddlers(c);for(var a=0;a<d.length;a++){b.push(d[a].title)}}return b};config.macros.allTags.handler=function(e,b,d){var k=store.getTags(d[0]);var f=createTiddlyElement(e,"ul");if(k.length==0){createTiddlyElement(f,"li",null,"listTitle",this.noTags)}for(var j=0;j<k.length;j++){var g=k[j][0];var c=getTiddlyLinkInfo(g);var h=createTiddlyElement(f,"li");var a=createTiddlyButton(h,g+" ("+k[j][1]+")",this.tooltip.format([g]),onClickTag,c.classes);a.setAttribute("tag",g);a.setAttribute("refresh","link");a.setAttribute("tiddlyLink",g);if(d[1]){a.setAttribute("sortby",d[1])}}};config.macros.timeline.handler=function(e,c,d){var j=d[0]||"modified";var b=store.reverseLookup("tags","excludeLists",false,j);var g="";var k=d[1]?b.length-Math.min(b.length,parseInt(d[1])):0;var a=d[2]||this.dateFormat;for(var m=b.length-1;m>=k;m--){var h=b[m];var l=h[j].convertToLocalYYYYMMDDHHMM().substr(0,8);if(l!=g){var f=document.createElement("ul");addClass(f,"timeline");e.appendChild(f);createTiddlyElement(f,"li",null,"listTitle",h[j].formatString(a));g=l}createTiddlyElement(f,"li",null,"listLink").appendChild(createTiddlyLink(e,h.title,true))}};config.macros.tiddler.handler=function(f,b,e,g,d,l){e=d.parseParams("name",null,true,false,true);var k=e[0]["name"];var c=k[0];var j=k[1]||null;var h=e[0]["with"];var a=createTiddlyElement(f,"span",null,j,null,{refresh:"content",tiddler:c});if(h!==undefined){a.setAttribute("args","[["+h.join("]] [[")+"]]")}this.transclude(a,c,h)};config.macros.tiddler.transclude=function(h,b,c){var f=store.getTiddlerText(b);if(!f){return}var a=config.macros.tiddler.tiddlerStack;if(a.indexOf(b)!==-1){return}a.push(b);try{if(typeof c=="string"){c=c.readBracketedList()}var g=c?Math.min(c.length,9):0;for(var d=0;d<g;d++){var e=new RegExp("\\$"+(d+1),"mg");f=f.replace(e,c[d])}config.macros.tiddler.renderText(h,f,b,params)}finally{a.pop()}};config.macros.tiddler.renderText=function(a,d,b,c){wikify(d,a,null,store.getTiddler(b))};config.macros.tiddler.tiddlerStack=[];config.macros.tag.handler=function(a,b,c){createTagButton(a,c[0],null,c[1],c[2]);if(c[3]){btn.setAttribute("sortby",c[3])}};config.macros.tags.handler=function(d,a,c,e,b,k){c=b.parseParams("anon",null,true,false,false);var g=createTiddlyElement(d,"ul");var j=getParam(c,"anon","");if(j&&store.tiddlerExists(j)){k=store.getTiddler(j)}var n=getParam(c,"sep"," ");var f=config.views.wikified.tag;var h=null;for(var l=0;l<k.tags.length;l++){var m=store.getTiddler(k.tags[l]);if(!m||!m.tags.contains("excludeLists")){if(!h){h=createTiddlyElement(g,"li",null,"listTitle",f.labelTags.format([k.title]))}createTagButton(createTiddlyElement(g,"li"),k.tags[l],k.title);if(l<k.tags.length-1){createTiddlyText(g,n)}}}if(!h){createTiddlyElement(g,"li",null,"listTitle",f.labelNoTags.format([k.title]))}};config.macros.tagging.handler=function(f,c,e,g,d,k){e=d.parseParams("anon",null,true,false,false);var h=createTiddlyElement(f,"ul");var j=getParam(e,"anon","");if(j==""&&k instanceof Tiddler){j=k.title}var m=getParam(e,"sep"," ");h.setAttribute("title",this.tooltip.format([j]));var b=store.getTaggedTiddlers(j);var a=b.length==0?this.labelNotTag:this.label;createTiddlyElement(h,"li",null,"listTitle",a.format([j,b.length]));for(var l=0;l<b.length;l++){createTiddlyLink(createTiddlyElement(h,"li"),b[l].title,true);if(l<b.length-1){createTiddlyText(h,m)}}};config.macros.closeAll.handler=function(a){createTiddlyButton(a,this.label,this.prompt,this.onClick)};config.macros.closeAll.onClick=function(a){story.closeAllTiddlers();return false};config.macros.permaview.handler=function(a){createTiddlyButton(a,this.label,this.prompt,this.onClick)};config.macros.permaview.onClick=function(a){story.permaView();return false};config.macros.saveChanges.handler=function(a,b,c){if(!readOnly){createTiddlyButton(a,c[0]||this.label,c[1]||this.prompt,this.onClick,null,null,this.accessKey)}};config.macros.saveChanges.onClick=function(a){saveChanges();return false};config.macros.slider.onClickSlider=function(c){var d=c||window.event;var f=this.nextSibling;var b=f.getAttribute("cookie");var a=f.style.display!="none";if(config.options.chkAnimate&&anim&&typeof Slider=="function"){anim.startAnimating(new Slider(f,!a,null,"none"))}else{f.style.display=a?"none":"block"}config.options[b]=!a;saveOptionCookie(b);return false};config.macros.slider.createSlider=function(b,e,g,f){var h=e||"";var d=createTiddlyButton(b,g,f,this.onClickSlider);var a=createTiddlyElement(null,"div",null,"sliderPanel");a.setAttribute("cookie",h);a.style.display=config.options[h]?"block":"none";b.appendChild(a);return a};config.macros.slider.handler=function(b,c,e){var a=this.createSlider(b,e[0],e[2],e[3]);var d=store.getTiddlerText(e[1]);a.setAttribute("refresh","content");a.setAttribute("tiddler",e[1]);if(d){wikify(d,a,null,store.getTiddler(e[1]))}};config.macros.gradient.handler=function(f,b,e,h,d,l){var a=h?createTiddlyElement(f,"div",null,"gradient"):f;a.style.position="relative";a.style.overflow="hidden";a.style.zIndex="0";if(h){var n=config.formatterHelpers.inlineCssHelper(h);config.formatterHelpers.applyCssHelper(a,n)}e=d.parseParams("color");var k=[],g=[];for(var m=2;m<e.length;m++){var j=e[m].value;if(e[m].name=="snap"){g[g.length-1]=j}else{k.push(j);g.push(j)}}drawGradient(a,e[1].value!="vert",k,g);if(h){h.subWikify(a,">>")}if(document.all){a.style.height="100%";a.style.width="100%"}};config.macros.message.handler=function(b,e,f){if(f[0]){var d=f[0].split(".");var c=function(g,h){if(d[h] in g){if(h<d.length-1){return(c(g[d[h]],h+1))}else{return g[d[h]]}}else{return null}};var a=c(config,0);if(a==null){a=c(window,0)}createTiddlyText(b,a.toString().format(f.splice(1)))}};config.macros.view.views={text:function(d,a,f,c,e,b){highlightify(d,a,highlightHack,b)},link:function(d,a,f,c,e,b){createTiddlyLink(a,d,true)},wikified:function(d,a,f,c,e,b){if(f[2]){d=f[2].unescapeLineBreaks().format([d])}wikify(d,a,highlightHack,b)},date:function(d,a,f,c,e,b){d=Date.convertFromYYYYMMDDHHMM(d);createTiddlyText(a,d.formatString(f[2]?f[2]:config.views.wikified.dateFormat))}};config.macros.view.handler=function(d,a,c,e,b,g){if((g instanceof Tiddler)&&c[0]){var h=store.getValue(g,c[0]);if(h){var f=c[1]||config.macros.view.defaultView;var j=config.macros.view.views[f];if(j){j(h,d,c,e,b,g)}}}};config.macros.edit.handler=function(d,a,c,f,b,n){var m=c[0];var q=c[1]||0;var j=c[2]||"";if((n instanceof Tiddler)&&m){story.setDirty(n.title,true);var k,o;if(m!="text"&&!q){k=createTiddlyElement(null,"input",null,null,null,{type:"text",edit:m,size:"40",autocomplete:"off"});k.value=store.getValue(n,m)||j;d.appendChild(k)}else{var h=createTiddlyElement(null,"fieldset",null,"fieldsetFix");var g=createTiddlyElement(h,"div");k=createTiddlyElement(g,"textarea");k.value=o=store.getValue(n,m)||j;q=q||10;var p=o.match(/\n/mg);var l=Math.max(parseInt(config.options.txtMaxEditRows),5);if(p!=null&&p.length>q){q=p.length+5}q=Math.min(q,l);k.setAttribute("rows",q);k.setAttribute("edit",m);d.appendChild(h)}if(n.isReadOnly()){k.setAttribute("readOnly","readOnly");addClass(k,"readOnly")}return k}};config.macros.tagChooser.onClick=function(f){var g=f||window.event;var h=config.views.editor.tagChooser;var b=Popup.create(this);var c=store.getTags(this.getAttribute("tags"));if(c.length==0){jQuery("<li/>").text(h.popupNone).appendTo(b)}for(var d=0;d<c.length;d++){var a=createTiddlyButton(createTiddlyElement(b,"li"),c[d][0],h.tagTooltip.format([c[d][0]]),config.macros.tagChooser.onTagClick);a.setAttribute("tag",c[d][0]);a.setAttribute("tiddler",this.getAttribute("tiddler"))}Popup.show();g.cancelBubble=true;if(g.stopPropagation){g.stopPropagation()}return false};config.macros.tagChooser.onTagClick=function(b){var c=b||window.event;if(c.metaKey||c.ctrlKey){stopEvent(c)}var a=this.getAttribute("tag");var d=this.getAttribute("tiddler");if(!readOnly){story.setTiddlerTag(d,a,0)}return false};config.macros.tagChooser.handler=function(a,e,h,d,g,c){if(c instanceof Tiddler){var f=config.views.editor.tagChooser;var b=createTiddlyButton(a,f.text,f.tooltip,this.onClick);b.setAttribute("tiddler",c.title);b.setAttribute("tags",h[0])}};config.macros.refreshDisplay.handler=function(a){createTiddlyButton(a,this.label,this.prompt,this.onClick)};config.macros.refreshDisplay.onClick=function(a){refreshAll();return false};config.macros.annotations.handler=function(e,b,d,f,c,h){var g=h?h.title:null;var j=g?config.annotations[g]:null;if(!h||!g||!j){return}var k=j.format([g]);wikify(k,createTiddlyElement(e,"div",null,"annotation"),null,h)};config.macros.newTiddler.createNewTiddlerButton=function(e,h,d,j,b,l,c,g){var n=[];for(var m=1;m<d.length;m++){if((d[m].name=="anon"&&m!=1)||(d[m].name=="tag")){n.push(d[m].value)}}j=getParam(d,"label",j);b=getParam(d,"prompt",b);l=getParam(d,"accessKey",l);c=getParam(d,"focus",c);var f=getParam(d,"fields","");if(!f&&!store.isShadowTiddler(h)){f=String.encodeHashMap(config.defaultCustomFields)}var a=createTiddlyButton(e,j,b,this.onClickNewTiddler,null,null,l);a.setAttribute("newTitle",h);a.setAttribute("isJournal",g?"true":"false");if(n.length>0){a.setAttribute("params",n.join("|"))}a.setAttribute("newFocus",c);a.setAttribute("newTemplate",getParam(d,"template",DEFAULT_EDIT_TEMPLATE));if(f!==""){a.setAttribute("customFields",f)}var k=getParam(d,"text");if(k!==undefined){a.setAttribute("newText",k)}return a};config.macros.newTiddler.onClickNewTiddler=function(){var d=this.getAttribute("newTitle");if(this.getAttribute("isJournal")=="true"){d=new Date().formatString(d.trim())}var a=this.getAttribute("params");var h=a?a.split("|"):[];var j=this.getAttribute("newFocus");var e=this.getAttribute("newTemplate");var c=this.getAttribute("customFields");if(!c&&!store.isShadowTiddler(d)){c=String.encodeHashMap(config.defaultCustomFields)}story.displayTiddler(null,d,e,false,null,null);var b=story.getTiddler(d);if(c){story.addCustomFields(b,c)}var f=this.getAttribute("newText");if(typeof f=="string"&&story.getTiddlerField(d,"text")){story.getTiddlerField(d,"text").value=f.format([d])}for(var g=0;g<h.length;g++){story.setTiddlerTag(d,h[g],+1)}story.focusTiddler(d,j);return false};config.macros.newTiddler.handler=function(a,c,f,b,e){if(!readOnly){f=e.parseParams("anon",null,true,false,false);var d=f[1]&&f[1].name=="anon"?f[1].value:this.title;d=getParam(f,"title",d);this.createNewTiddlerButton(a,d,f,this.label,this.prompt,this.accessKey,"title",false)}};config.macros.newJournal.handler=function(a,c,f,b,e){if(!readOnly){f=e.parseParams("anon",null,true,false,false);var d=f[1]&&f[1].name=="anon"?f[1].value:config.macros.timeline.dateFormat;d=getParam(f,"title",d);config.macros.newTiddler.createNewTiddlerButton(a,d,f,this.label,this.prompt,this.accessKey,"text",true)}};config.macros.search.handler=function(b,e,f){var d=null;var c=createTiddlyButton(b,this.label,this.prompt,this.onClick,"searchButton");var a=createTiddlyElement(null,"input",null,"txtOptionInput searchField");if(f[0]){a.value=f[0]}if(config.browser.isSafari){a.setAttribute("type","search");a.setAttribute("results","5")}else{a.setAttribute("type","text")}b.appendChild(a);a.onkeyup=this.onKeyPress;a.onfocus=this.onFocus;a.setAttribute("size",this.sizeTextbox);a.setAttribute("accessKey",f[1]||this.accessKey);a.setAttribute("autocomplete","off");a.setAttribute("lastSearchText","")};config.macros.search.timeout=null;config.macros.search.doSearch=function(a){if(a.value.length>0){story.search(a.value,config.options.chkCaseSensitiveSearch,config.options.chkRegExpSearch);a.setAttribute("lastSearchText",a.value)}};config.macros.search.onClick=function(a){config.macros.search.doSearch(this.nextSibling);return false};config.macros.search.onKeyPress=function(c){var b=config.macros.search;var d=c||window.event;switch(d.keyCode){case 13:case 10:b.doSearch(this);break;case 27:this.value="";clearMessage();break}if(config.options.chkIncrementalSearch){if(this.value.length>2){if(this.value!=this.getAttribute("lastSearchText")){if(b.timeout){clearTimeout(b.timeout)}var a=this;b.timeout=setTimeout(function(){b.doSearch(a)},500)}}else{if(b.timeout){clearTimeout(b.timeout)}}}};config.macros.search.onFocus=function(a){this.select()};config.macros.tabs.handler=function(h,e,g){var b=g[0];var f=(g.length-1)/3;var a=createTiddlyElement(null,"div",null,"tabsetWrapper "+b);var j=createTiddlyElement(a,"div",null,"tabset");j.setAttribute("cookie",b);var l=false;for(var n=0;n<f;n++){var m=g[n*3+1];var c=g[n*3+2];var k=g[n*3+3];var d=createTiddlyButton(j,m,c,this.onClickTab,"tab tabUnselected");createTiddlyElement(d,"span",null,null," ",{style:"font-size:0pt;line-height:0px"});d.setAttribute("tab",m);d.setAttribute("content",k);d.title=c;if(config.options[b]==m){l=true}}if(!l){config.options[b]=g[1]}h.appendChild(a);this.switchTab(j,config.options[b])};config.macros.tabs.onClickTab=function(a){config.macros.tabs.switchTab(this.parentNode,this.getAttribute("tab"));return false};config.macros.tabs.switchTab=function(g,e){var c=g.getAttribute("cookie");var h=null;var a=g.childNodes;for(var b=0;b<a.length;b++){if(a[b].getAttribute&&a[b].getAttribute("tab")==e){h=a[b];h.className="tab tabSelected"}else{a[b].className="tab tabUnselected"}}if(h){if(g.nextSibling&&g.nextSibling.className=="tabContents"){removeNode(g.nextSibling)}var f=createTiddlyElement(null,"div",null,"tabContents");g.parentNode.insertBefore(f,g.nextSibling);var d=h.getAttribute("content");wikify(store.getTiddlerText(d),f,null,store.getTiddler(d));if(c){config.options[c]=e;saveOptionCookie(c)}}};config.macros.toolbar.createCommand=function(e,f,j,g){if(typeof f!="string"){var h=null;for(var l in config.commands){if(config.commands[l]==f){h=l}}f=h}if((j instanceof Tiddler)&&(typeof f=="string")){var d=config.commands[f];if(d.isEnabled?d.isEnabled(j):this.isCommandEnabled(d,j)){var k=d.getText?d.getText(j):this.getCommandText(d,j);var m=d.getTooltip?d.getTooltip(j):this.getCommandTooltip(d,j);var b;switch(d.type){case"popup":b=this.onClickPopup;break;case"command":default:b=this.onClickCommand;break}var a=createTiddlyButton(null,k,m,b);a.setAttribute("commandName",f);a.setAttribute("tiddler",j.title);addClass(a,"command_"+f);if(g){addClass(a,g)}e.appendChild(a)}}};config.macros.toolbar.isCommandEnabled=function(d,a){var c=a.title;var b=a.isReadOnly();var e=store.isShadowTiddler(c)&&!store.tiddlerExists(c);return(!b||(b&&!d.hideReadOnly))&&!(e&&d.hideShadow)};config.macros.toolbar.getCommandText=function(b,a){return a.isReadOnly()&&b.readOnlyText||b.text};config.macros.toolbar.getCommandTooltip=function(b,a){return a.isReadOnly()&&b.readOnlyTooltip||b.tooltip};config.macros.toolbar.onClickCommand=function(a){var b=a||window.event;b.cancelBubble=true;if(b.stopPropagation){b.stopPropagation()}var c=config.commands[this.getAttribute("commandName")];return c.handler(b,this,this.getAttribute("tiddler"))};config.macros.toolbar.onClickPopup=function(c){var d=c||window.event;d.cancelBubble=true;if(d.stopPropagation){d.stopPropagation()}var a=Popup.create(this);var g=config.commands[this.getAttribute("commandName")];var f=this.getAttribute("tiddler");var b=store.fetchTiddler(f);a.setAttribute("tiddler",f);g.handlePopup(a,f);Popup.show();return false};config.macros.toolbar.invokeCommand=function(a,e,f){var d=a.getElementsByTagName("a");for(var b=0;b<d.length;b++){var g=d[b];if(hasClass(g,e)&&g.getAttribute&&g.getAttribute("commandName")){if(g.onclick instanceof Function){g.onclick.call(g,f)}break}}};config.macros.toolbar.onClickMore=function(a){var b=this.nextSibling;b.style.display="inline";this.style.display="none";return false};config.macros.toolbar.onClickLess=function(b){var c=this.parentNode;var a=c.previousSibling;c.style.display="none";a.style.display="inline";return false};config.macros.toolbar.handler=function(g,b,f,h,d,m){for(var n=0;n<f.length;n++){var l=f[n];switch(l){case"!":createTiddlyText(g,this.separator);break;case"*":createTiddlyElement(g,"br");break;case"<":var a=createTiddlyButton(g,this.lessLabel,this.lessPrompt,config.macros.toolbar.onClickLess);addClass(a,"lessCommand");break;case">":var a=createTiddlyButton(g,this.moreLabel,this.morePrompt,config.macros.toolbar.onClickMore);addClass(a,"moreCommand");var j=createTiddlyElement(g,"span",null,"moreCommand");j.style.display="none";g=j;break;default:var k="";switch(l.substr(0,1)){case"+":k="defaultCommand";l=l.substr(1);break;case"-":k="cancelCommand";l=l.substr(1);break}if(l in config.commands){this.createCommand(g,l,m,k)}else{this.customCommand(g,l,h,m)}break}}};config.macros.toolbar.customCommand=function(a,d,c,b){};config.commands.closeTiddler.handler=function(a,c,b){if(story.isDirty(b)&&!readOnly){if(!confirm(config.commands.cancelTiddler.warning.format([b]))){return false}}story.setDirty(b,false);story.closeTiddler(b,true);return false};config.commands.closeOthers.handler=function(a,c,b){story.closeAllTiddlers(b);return false};config.commands.editTiddler.handler=function(c,e,d){clearMessage();var b=story.getTiddler(d);var a=b.getAttribute("tiddlyFields");story.displayTiddler(null,d,DEFAULT_EDIT_TEMPLATE,false,null,a);story.focusTiddler(d,config.options.txtEditorFocus||"text");return false};config.commands.saveTiddler.handler=function(a,c,b){var d=story.saveTiddler(b,a.shiftKey);if(d){story.displayTiddler(null,d)}return false};config.commands.cancelTiddler.handler=function(a,c,b){if(story.hasChanges(b)&&!readOnly){if(!confirm(this.warning.format([b]))){return false}}story.setDirty(b,false);story.displayTiddler(null,b);return false};config.commands.deleteTiddler.handler=function(b,d,c){var a=true;if(config.options.chkConfirmDelete){a=confirm(this.warning.format([c]))}if(a){store.removeTiddler(c);story.closeTiddler(c,true);autoSaveChanges()}return false};config.commands.permalink.handler=function(b,d,c){var a=encodeURIComponent(String.encodeTiddlyLink(c));if(window.location.hash!=a){window.location.hash=a}return false};config.commands.references.handlePopup=function(a,e){var b=store.getReferringTiddlers(e);var f=false;for(var d=0;d<b.length;d++){if(b[d].title!=e&&!b[d].isTagged("excludeLists")){createTiddlyLink(createTiddlyElement(a,"li"),b[d].title,true);f=true}}if(!f){createTiddlyElement(a,"li",null,"disabled",this.popupNone)}};config.commands.jump.handlePopup=function(a,b){story.forEachTiddler(function(d,c){createTiddlyLink(createTiddlyElement(a,"li"),d,true,null,false,null,true)})};config.commands.syncing.handlePopup=function(a,m){var k=config.commands.syncing;var n=store.fetchTiddler(m);if(!n){return}var l=n.getServerType();var s=n.fields["server.host"];var g=n.fields["server.workspace"];if(!g){g=""}if(l){var j=createTiddlyElement(a,"li",null,"popupMessage");j.innerHTML=k.currentlySyncing.format([l,s,g])}else{createTiddlyElement(a,"li",null,"popupMessage",k.notCurrentlySyncing)}if(l){createTiddlyElement(createTiddlyElement(a,"li",null,"listBreak"),"div");var c=createTiddlyButton(createTiddlyElement(a,"li"),this.captionUnSync,null,k.onChooseServer);c.setAttribute("tiddler",m);c.setAttribute("server.type","")}createTiddlyElement(createTiddlyElement(a,"li",null,"listBreak"),"div");createTiddlyElement(a,"li",null,"popupMessage",k.chooseServer);var r=store.getTaggedTiddlers("systemServer","title");for(var q=0;q<r.length;q++){var h=r[q];var o=store.getTiddlerSlice(h.title,"Type");if(!o){o="file"}var b=store.getTiddlerSlice(h.title,"URL");if(!b){b=""}var d=store.getTiddlerSlice(h.title,"Workspace");if(!d){d=""}var p=h.title;if(l==o&&s==b&&g==d){p=k.currServerMarker+p}else{p=k.notCurrServerMarker+p}c=createTiddlyButton(createTiddlyElement(a,"li"),p,null,k.onChooseServer);c.setAttribute("tiddler",m);c.setAttribute("server.type",o);c.setAttribute("server.host",b);c.setAttribute("server.workspace",d)}};config.commands.syncing.onChooseServer=function(c){var b=this.getAttribute("tiddler");var a=this.getAttribute("server.type");if(a){store.addTiddlerFields(b,{"server.type":a,"server.host":this.getAttribute("server.host"),"server.workspace":this.getAttribute("server.workspace")})}else{store.setValue(b,"server",null)}return false};config.commands.fields.handlePopup=function(a,d){var c=store.fetchTiddler(d);if(!c){return}var b=[];store.forEachField(c,function(e,g,f){b.push({field:g,value:f})},true);b.sort(function(f,e){return f.field<e.field?-1:(f.field==e.field?0:+1)});if(b.length>0){ListView.create(a,b,this.listViewTemplate)}else{createTiddlyElement(a,"div",null,null,this.emptyText)}};function Tiddler(a){this.title=a;this.text="";this.creator=null;this.modifier=null;this.created=new Date();this.modified=this.created;this.links=[];this.linksUpdated=false;this.tags=[];this.fields={};return this}Tiddler.prototype.getLinks=function(){if(this.linksUpdated==false){this.changed()}return this.links};Tiddler.prototype.getInheritedFields=function(){var b={};for(var a in this.fields){if(a=="server.host"||a=="server.workspace"||a=="wikiformat"||a=="server.type"){b[a]=this.fields[a]}}return String.encodeHashMap(b)};Tiddler.prototype.incChangeCount=function(){var a=this.fields.changecount;a=a?parseInt(a,10):0;this.fields.changecount=String(a+1)};Tiddler.prototype.clearChangeCount=function(){if(this.fields.changecount){delete this.fields.changecount}};Tiddler.prototype.doNotSave=function(){return this.fields.doNotSave};Tiddler.prototype.isTouched=function(){var a=this.fields.changecount;if(a===undefined){a=0}return a>0};Tiddler.prototype.set=function(g,f,b,d,c,h,a,e){this.assign(g,f,b,d,c,h,a,e);this.changed();return this};Tiddler.prototype.assign=function(g,f,b,d,c,h,a,e){if(g!=undefined){this.title=g}if(f!=undefined){this.text=f}if(b!=undefined){this.modifier=b}if(d!=undefined){this.modified=d}if(e!=undefined){this.creator=e}if(h!=undefined){this.created=h}if(a!=undefined){this.fields=a}if(c!=undefined){this.tags=(typeof c=="string")?c.readBracketedList():c}else{if(this.tags==undefined){this.tags=[]}}return this};Tiddler.prototype.getTags=function(){return String.encodeTiddlyLinkList(this.tags)};Tiddler.prototype.isTagged=function(a){return this.tags.indexOf(a)!=-1};Tiddler.unescapeLineBreaks=function(a){return a?a.unescapeLineBreaks():""};Tiddler.prototype.escapeLineBreaks=function(){return this.text.escapeLineBreaks()};Tiddler.prototype.changed=function(){this.links=[];var f=this.text;f=f.replace(/\/%((?:.|\n)*?)%\//g,"").replace(/\{{3}((?:.|\n)*?)\}{3}/g,"").replace(/"""((?:.|\n)*?)"""/g,"").replace(/\<nowiki\>((?:.|\n)*?)\<\/nowiki\>/g,"").replace(/\<html\>((?:.|\n)*?)\<\/html\>/g,"").replace(/\<script((?:.|\n)*?)\<\/script\>/g,"");var d=this.autoLinkWikiWords()?0:1;var a=d==0?config.textPrimitives.tiddlerAnyLinkRegExp:config.textPrimitives.tiddlerForcedLinkRegExp;a.lastIndex=0;var e=a.exec(f);while(e){var g=a.lastIndex;if(d==0&&e[1]&&e[1]!=this.title){if(e.index>0){var c=new RegExp(config.textPrimitives.unWikiLink+"|"+config.textPrimitives.anyLetter,"mg");c.lastIndex=e.index-1;var b=c.exec(f);if(b.index!=e.index-1){this.links.pushUnique(e[1])}}else{this.links.pushUnique(e[1])}}else{if(e[2-d]&&!config.formatterHelpers.isExternalLink(e[3-d])){this.links.pushUnique(e[3-d])}else{if(e[4-d]&&e[4-d]!=this.title){this.links.pushUnique(e[4-d])}}}a.lastIndex=g;e=a.exec(f)}this.linksUpdated=true};Tiddler.prototype.getSubtitle=function(){var a=this.modifier;if(!a){a=config.messages.subtitleUnknown}var b=this.modified;if(b){b=b.toLocaleString()}else{b=config.messages.subtitleUnknown}return config.messages.tiddlerLinkTooltip.format([this.title,a,b])};Tiddler.prototype.isReadOnly=function(){return readOnly};Tiddler.prototype.autoLinkWikiWords=function(){return !(this.isTagged("systemConfig")||this.isTagged("excludeMissing"))};Tiddler.prototype.getServerType=function(){var a=null;if(this.fields["server.type"]){a=this.fields["server.type"]}if(!a){a=this.fields.wikiformat}if(a&&!config.adaptors[a]){a=null}return a};Tiddler.prototype.getAdaptor=function(){var a=this.getServerType();return a?new config.adaptors[a]():null};function TiddlyWiki(){var a={};this.tiddlersUpdated=false;this.namedNotifications=[];this.notificationLevel=0;this.slices={};this.clear=function(){a={};this.setDirty(false)};this.fetchTiddler=function(c){var b=a[c];return b instanceof Tiddler?b:null};this.deleteTiddler=function(b){delete this.slices[b];delete a[b]};this.addTiddler=function(b){delete this.slices[b.title];a[b.title]=b};this.forEachTiddler=function(d){for(var c in a){var b=a[c];if(b instanceof Tiddler){d.call(this,c,b)}}}}TiddlyWiki.prototype.setDirty=function(a){this.dirty=a};TiddlyWiki.prototype.isDirty=function(){return this.dirty};TiddlyWiki.prototype.tiddlerExists=function(b){var a=this.fetchTiddler(b);return a!=undefined};TiddlyWiki.prototype.isShadowTiddler=function(a){return config.shadowTiddlers[a]===undefined?false:true};TiddlyWiki.prototype.createTiddler=function(b){var a=this.fetchTiddler(b);if(!a){a=new Tiddler(b);this.addTiddler(a);this.setDirty(true)}return a};TiddlyWiki.prototype.getTiddler=function(b){var a=this.fetchTiddler(b);if(a!=undefined){return a}else{return null}};TiddlyWiki.prototype.getShadowTiddlerText=function(a){if(typeof config.shadowTiddlers[a]=="string"){return config.shadowTiddlers[a]}else{return""}};TiddlyWiki.prototype.getTiddlerText=function(e,d){if(!e){return d}var c=e.indexOf(config.textPrimitives.sectionSeparator);var h=null;if(c!=-1){h=e.substr(c+config.textPrimitives.sectionSeparator.length);e=e.substr(0,c)}c=e.indexOf(config.textPrimitives.sliceSeparator);if(c!=-1){var g=this.getTiddlerSlice(e.substr(0,c),e.substr(c+config.textPrimitives.sliceSeparator.length));if(g){return g}}var f=this.fetchTiddler(e);if(f){if(!h){return f.text}var k=new RegExp("(^!{1,6}[ \t]*"+h.escapeRegExp()+"[ \t]*\n)","mg");k.lastIndex=0;var b=k.exec(f.text);if(b){var j=f.text.substr(b.index+b[1].length);var a=/^!/mg;a.lastIndex=0;b=a.exec(j);if(b){j=j.substr(0,b.index-1)}return j}return d}if(this.isShadowTiddler(e)){return this.getShadowTiddlerText(e)}if(d!=undefined){return d}return null};TiddlyWiki.prototype.getRecursiveTiddlerText=function(h,c,g){var a=new RegExp("(?:\\[\\[([^\\]]+)\\]\\])","mg");var f=this.getTiddlerText(h,null);if(f==null){return c}var d=[];var e=0;do{var b=a.exec(f);if(b){d.push(f.substr(e,b.index-e));if(b[1]){if(g<=0){d.push(b[1])}else{d.push(this.getRecursiveTiddlerText(b[1],"",g-1))}}e=b.index+b[0].length}else{d.push(f.substr(e))}}while(b);return d.join("")};TiddlyWiki.prototype.slicesRE=/(?:^([\'\/]{0,2})~?([\.\w]+)\:\1[\t\x20]*([^\n]+)[\t\x20]*$)|(?:^\|([\'\/]{0,2})~?([\.\w]+)\:?\4\|[\t\x20]*([^\n]+)[\t\x20]*\|$)/gm;TiddlyWiki.prototype.calcAllSlices=function(d){var c={};var b=this.getTiddlerText(d,"");this.slicesRE.lastIndex=0;var a=this.slicesRE.exec(b);while(a){if(a[2]){c[a[2]]=a[3]}else{c[a[5]]=a[6]}a=this.slicesRE.exec(b)}return c};TiddlyWiki.prototype.getTiddlerSlice=function(c,a){var b=this.slices[c];if(!b){b=this.calcAllSlices(c);this.slices[c]=b}return b[a]};TiddlyWiki.prototype.getTiddlerSlices=function(e,a){var c={};for(var b=0;b<a.length;b++){var d=this.getTiddlerSlice(e,a[b]);if(d){c[a[b]]=d}}return c};TiddlyWiki.prototype.suspendNotifications=function(){this.notificationLevel--};TiddlyWiki.prototype.resumeNotifications=function(){this.notificationLevel++};TiddlyWiki.prototype.notify=function(c,a){if(!this.notificationLevel){for(var b=0;b<this.namedNotifications.length;b++){var d=this.namedNotifications[b];if((d.name==null&&a)||(d.name==c)){d.notify(c)}}}};TiddlyWiki.prototype.notifyAll=function(){if(!this.notificationLevel){for(var a=0;a<this.namedNotifications.length;a++){var b=this.namedNotifications[a];if(b.name){b.notify(b.name)}}}};TiddlyWiki.prototype.addNotification=function(c,b){for(var a=0;a<this.namedNotifications.length;a++){if((this.namedNotifications[a].name==c)&&(this.namedNotifications[a].notify==b)){return this}}this.namedNotifications.push({name:c,notify:b});return this};TiddlyWiki.prototype.removeTiddler=function(b){var a=this.fetchTiddler(b);if(a){this.deleteTiddler(b);this.notify(b,true);this.setDirty(true)}};TiddlyWiki.prototype.resetTiddler=function(b){var a=this.fetchTiddler(b);if(a){a.clearChangeCount();this.notify(b,true);this.setDirty(true)}};TiddlyWiki.prototype.setTiddlerTag=function(e,b,a){var d=this.fetchTiddler(e);if(d){var c=d.tags.indexOf(a);if(c!=-1){d.tags.splice(c,1)}if(b){d.tags.push(a)}d.changed();d.incChangeCount();this.notify(e,true);this.setDirty(true)}};TiddlyWiki.prototype.addTiddlerFields=function(c,a){var b=this.fetchTiddler(c);if(!b){return}merge(b.fields,a);b.changed();b.incChangeCount();this.notify(c,true);this.setDirty(true)};TiddlyWiki.prototype.saveTiddler=function(j,a,b,d,k,l,f,g,e,c){var h=this.fetchTiddler(j);if(h){e=e||h.created;c=c||h.creator;this.deleteTiddler(j)}else{e=e||k;h=new Tiddler()}f=merge({},f);h.set(a,b,d,k,l,e,f,c);this.addTiddler(h);if(g){h.clearChangeCount()}else{h.incChangeCount()}if(j!=a){this.notify(j,true)}this.notify(a,true);this.setDirty(true);return h};TiddlyWiki.prototype.incChangeCount=function(b){var a=this.fetchTiddler(b);if(a){a.incChangeCount()}};TiddlyWiki.prototype.getLoader=function(){if(!this.loader){this.loader=new TW21Loader()}return this.loader};TiddlyWiki.prototype.getSaver=function(){if(!this.saver){this.saver=new TW21Saver()}return this.saver};TiddlyWiki.prototype.allTiddlersAsHtml=function(){return this.getSaver().externalize(store)};TiddlyWiki.prototype.loadFromDiv=function(f,e,d){this.idPrefix=e;var c=(typeof f=="string")?document.getElementById(f):f;if(!c){return}var b=this.getLoader().loadTiddlers(this,c.childNodes);this.setDirty(false);if(!d){for(var a=0;a<b.length;a++){b[a].changed()}}jQuery(document).trigger("loadTiddlers")};TiddlyWiki.prototype.importTiddlyWiki=function(f){var e=locateStoreArea(f);if(!e){return null}var c="<html><body>"+f.substring(e[0],e[1]+endSaveArea.length)+"</body></html>";var a=document.createElement("iframe");a.style.display="none";document.body.appendChild(a);var d=a.document;if(a.contentDocument){d=a.contentDocument}else{if(a.contentWindow){d=a.contentWindow.document}}d.open();d.writeln(c);d.close();var b=d.getElementById("storeArea");this.loadFromDiv(b,"store");a.parentNode.removeChild(a);return this};TiddlyWiki.prototype.updateTiddlers=function(){this.tiddlersUpdated=true;this.forEachTiddler(function(b,a){a.changed()})};TiddlyWiki.prototype.search=function(c,a,g,b){var f=this.reverseLookup("tags",g,!!b);var e=[];for(var d=0;d<f.length;d++){if((f[d].title.search(c)!=-1)||(f[d].text.search(c)!=-1)){e.push(f[d])}}if(!a){a="title"}e.sort(function(j,h){return j[a]<h[a]?-1:(j[a]==h[a]?0:+1)});return e};TiddlyWiki.prototype.getTags=function(b){var a=[];this.forEachTiddler(function(j,f){for(var h=0;h<f.tags.length;h++){var d=f.tags[h];var l=true;for(var k=0;k<a.length;k++){if(a[k][0]==d){l=false;a[k][1]++}}if(l&&b){var e=this.fetchTiddler(d);if(e&&e.isTagged(b)){l=false}}if(l){a.push([d,1])}}});a.sort(function(d,c){return d[0].toLowerCase()<c[0].toLowerCase()?-1:(d[0].toLowerCase()==c[0].toLowerCase()?0:+1)});return a};TiddlyWiki.prototype.getTaggedTiddlers=function(a,b){return this.reverseLookup("tags",a,true,b)};TiddlyWiki.prototype.getReferringTiddlers=function(c,b,a){if(!this.tiddlersUpdated){this.updateTiddlers()}return this.reverseLookup("links",c,true,a)};TiddlyWiki.prototype.reverseLookup=function(e,d,b,a){var c=[];this.forEachTiddler(function(k,g){var h=!b;for(var j=0;j<g[e].length;j++){if(g[e][j]==d){h=b}}if(h){c.push(g)}});if(!a){a="title"}c.sort(function(g,f){return g[a]<f[a]?-1:(g[a]==f[a]?0:+1)});return c};TiddlyWiki.prototype.getTiddlers=function(c,b){var a=[];this.forEachTiddler(function(e,d){if(b==undefined||!d.isTagged(b)){a.push(d)}});if(c){a.sort(function(e,d){return e[c]<d[c]?-1:(e[c]==d[c]?0:+1)})}return a};TiddlyWiki.prototype.getMissingLinks=function(a){if(!this.tiddlersUpdated){this.updateTiddlers()}var b=[];this.forEachTiddler(function(e,c){if(c.isTagged("excludeMissing")||c.isTagged("systemConfig")){return}for(var f=0;f<c.links.length;f++){var d=c.links[f];if(this.fetchTiddler(d)==null&&!this.isShadowTiddler(d)){b.pushUnique(d)}}});b.sort();return b};TiddlyWiki.prototype.getOrphans=function(){var a=[];this.forEachTiddler(function(c,b){if(this.getReferringTiddlers(c).length==0&&!b.isTagged("excludeLists")){a.push(c)}});a.sort();return a};TiddlyWiki.prototype.getShadowed=function(){var b=[];for(var a in config.shadowTiddlers){if(this.isShadowTiddler(a)){b.push(a)}}b.sort();return b};TiddlyWiki.prototype.getTouched=function(){var a=[];this.forEachTiddler(function(c,b){if(b.isTouched()){a.push(b)}});a.sort();return a};TiddlyWiki.prototype.resolveTiddler=function(b){var a=(typeof b=="string")?this.getTiddler(b):b;return a instanceof Tiddler?a:null};TiddlyWiki.prototype.filterTiddlers=function(g){var e=[];if(g){var d;var f=/([^\s\[\]]+)|(?:\[([ \w]+)\[([^\]]+)\]\])|(?:\[\[([^\]]+)\]\])/mg;var c=f.exec(g);while(c){if(c[1]||c[4]){var h=c[1]||c[4];d=this.fetchTiddler(h);if(d){e.pushUnique(d)}else{if(this.isShadowTiddler(h)){d=new Tiddler();d.set(h,this.getTiddlerText(h));e.pushUnique(d)}else{e.pushUnique(new Tiddler(h))}}}else{if(c[2]){switch(c[2]){case"tag":var b=this.getTaggedTiddlers(c[3]);for(var a=0;a<b.length;a++){e.pushUnique(b[a])}break;case"sort":e=this.sortTiddlers(e,c[3]);break}}}c=f.exec(g)}}return e};TiddlyWiki.prototype.sortTiddlers=function(b,c){var a=+1;switch(c.substr(0,1)){case"-":a=-1;case"+":c=c.substr(1);break}if(TiddlyWiki.standardFieldAccess[c]){b.sort(function(e,d){return e[c]<d[c]?-a:(e[c]==d[c]?0:a)})}else{b.sort(function(e,d){return e.fields[c]<d.fields[c]?-a:(e.fields[c]==d.fields[c]?0:+a)})}return b};TiddlyWiki.isValidFieldName=function(b){var a=/[a-zA-Z_]\w*(\.[a-zA-Z_]\w*)*/.exec(b);return a&&(a[0]==b)};TiddlyWiki.checkFieldName=function(a){if(!TiddlyWiki.isValidFieldName(a)){throw config.messages.invalidFieldName.format([a])}};function StringFieldAccess(b,a){this.set=a?function(d,c){if(c!=d[b]){throw config.messages.fieldCannotBeChanged.format([b])}}:function(d,c){if(c!=d[b]){d[b]=c;return true}};this.get=function(c){return c[b]}}function DateFieldAccess(a){this.set=function(c,b){var e=b instanceof Date?b:Date.convertFromYYYYMMDDHHMM(b);if(e!=c[a]){c[a]=e;return true}};this.get=function(b){return b[a].convertToYYYYMMDDHHMM()}}function LinksFieldAccess(a){this.set=function(c,b){var d=(typeof b=="string")?b.readBracketedList():b;if(d.toString()!=c[a].toString()){c[a]=d;return true}};this.get=function(b){return String.encodeTiddlyLinkList(b[a])}}TiddlyWiki.standardFieldAccess={title:new StringFieldAccess("title",true),tiddler:new StringFieldAccess("title",true),text:new StringFieldAccess("text"),modifier:new StringFieldAccess("modifier"),modified:new DateFieldAccess("modified"),creator:new StringFieldAccess("creator"),created:new DateFieldAccess("created"),tags:new LinksFieldAccess("tags")};TiddlyWiki.isStandardField=function(a){return TiddlyWiki.standardFieldAccess[a]!=undefined};TiddlyWiki.prototype.setValue=function(g,k,j){TiddlyWiki.checkFieldName(k);var m=this.resolveTiddler(g);if(!m){return}k=k.toLowerCase();var a=(j===undefined)||(j===null);var e=TiddlyWiki.standardFieldAccess[k];if(e){if(a){return}var f=TiddlyWiki.standardFieldAccess[k];if(!f.set(m,j)){return}}else{var b=m.fields[k];if(a){if(b!==undefined){delete m.fields[k]}else{var l=new RegExp("^"+k+"\\.");var c=false;for(var d in m.fields){if(d.match(l)){delete m.fields[d];c=true}}if(!c){return}}}else{j=j instanceof Date?j.convertToYYYYMMDDHHMMSSMMM():String(j);if(b==j){return}m.fields[k]=j}}this.notify(m.title,true);if(!k.match(/^temp\./)){this.setDirty(true)}};TiddlyWiki.prototype.getValue=function(c,d){var b=this.resolveTiddler(c);if(!b){return undefined}d=d.toLowerCase();var a=TiddlyWiki.standardFieldAccess[d];if(a){return a.get(b)}return b.fields[d]};TiddlyWiki.prototype.forEachField=function(c,f,d){var b=this.resolveTiddler(c);if(!b){return undefined}var e,a;for(e in b.fields){a=f(b,e,b.fields[e]);if(a){return a}}if(d){return undefined}for(e in TiddlyWiki.standardFieldAccess){if(e=="tiddler"){continue}a=f(b,e,TiddlyWiki.standardFieldAccess[e].get(b));if(a){return a}}return undefined};function Story(a,b){this.container=a;this.idPrefix=b;this.highlightRegExp=null;this.tiddlerId=function(c){var d=this.idPrefix+c;return d==this.container?this.idPrefix+"_"+c:d};this.containerId=function(){return this.container}}Story.prototype.getTiddler=function(a){return document.getElementById(this.tiddlerId(a))};Story.prototype.getContainer=function(){return document.getElementById(this.containerId())};Story.prototype.forEachTiddler=function(b){var a=this.getContainer();if(!a){return}var c=a.firstChild;while(c){var f=c.nextSibling;var d=c.getAttribute("tiddler");b.call(this,d,c);c=f}};Story.prototype.displayDefaultTiddlers=function(){this.displayTiddlers(null,store.filterTiddlers(store.getTiddlerText("DefaultTiddlers")))};Story.prototype.displayTiddlers=function(c,g,f,d,b,h,a){for(var e=g.length-1;e>=0;e--){this.displayTiddler(c,g[e],f,d,b,h)}};Story.prototype.displayTiddler=function(g,k,m,a,b,e,f,l){var j=(k instanceof Tiddler)?k.title:k;var d=this.getTiddler(j);if(d){if(f){if(d.getAttribute("dirty")!="true"){this.closeTiddler(j,true)}}else{this.refreshTiddler(j,m,false,e)}}else{var c=this.getContainer();var h=this.positionTiddler(g);d=this.createTiddler(c,h,j,m,e)}if(l&&typeof l!=="string"){g=l}if(g&&typeof g!=="string"){if(config.options.chkAnimate&&(a==undefined||a==true)&&anim&&typeof Zoomer=="function"&&typeof Scroller=="function"){anim.startAnimating(new Zoomer(j,g,d),new Scroller(d))}else{window.scrollTo(0,ensureVisible(d))}}return d};Story.prototype.positionTiddler=function(b){var a=this.getContainer();var c=null;if(typeof b=="string"){switch(b){case"top":c=a.firstChild;break;case"bottom":c=null;break}}else{var d=this.findContainingTiddler(b);if(d==null){c=a.firstChild}else{if(d.nextSibling){c=d.nextSibling;if(c.nodeType!=1){c=null}}}}return c};Story.prototype.createTiddler=function(a,e,f,d,g){var c=createTiddlyElement(null,"div",this.tiddlerId(f),"tiddler");c.setAttribute("refresh","tiddler");if(g){c.setAttribute("tiddlyFields",g)}a.insertBefore(c,e);var b=null;if(!store.tiddlerExists(f)&&!store.isShadowTiddler(f)){b=this.loadMissingTiddler(f,g,c)}this.refreshTiddler(f,d,false,g,b);return c};Story.prototype.loadMissingTiddler=function(f,a,e){var d=function(j){if(j.status){var h=j.tiddler;if(!h.created){h.created=new Date()}if(!h.modified){h.modified=h.created}store.saveTiddler(h.title,h.title,h.text,h.modifier,h.modified,h.tags,h.fields,true,h.created,h.creator);autoSaveChanges()}else{story.refreshTiddler(j.title,null,true)}j.adaptor.close();delete j.adaptor};var c=new Tiddler(f);c.fields=typeof a=="string"?a.decodeHashMap():a||{};var b={serverType:c.getServerType()};if(!b.serverType){return}b.host=c.fields["server.host"];b.workspace=c.fields["server.workspace"];var g=new config.adaptors[b.serverType];g.getTiddler(f,b,null,d);return config.messages.loadingMissingTiddler.format([f,b.serverType,b.host,b.workspace])};Story.prototype.chooseTemplateForTiddler=function(b,a){if(!a){a=DEFAULT_VIEW_TEMPLATE}if(a==DEFAULT_VIEW_TEMPLATE||a==DEFAULT_EDIT_TEMPLATE){a=config.tiddlerTemplates[a]}return a};Story.prototype.getTemplateForTiddler=function(c,b,a){return store.getRecursiveTiddlerText(b,null,10)};Story.prototype.refreshTiddler=function(f,h,a,c,e){var b=this.getTiddler(f);if(b){if(b.getAttribute("dirty")=="true"&&!a){return b}h=this.chooseTemplateForTiddler(f,h);var j=b.getAttribute("template");if((h!=j)||a){var g=store.getTiddler(f);if(!g){g=new Tiddler();if(store.isShadowTiddler(f)){var l=[];g.set(f,store.getTiddlerText(f),config.views.wikified.shadowModifier,version.date,l,version.date)}else{var k=h=="EditTemplate"?config.views.editor.defaultText.format([f]):config.views.wikified.defaultText.format([f]);k=e||k;var d=c?c.decodeHashMap():null;g.set(f,k,config.views.wikified.defaultModifier,version.date,[],version.date,d)}}b.setAttribute("tags",g.tags.join(" "));b.setAttribute("tiddler",f);b.setAttribute("template",h);b.onmouseover=this.onTiddlerMouseOver;b.onmouseout=this.onTiddlerMouseOut;b.ondblclick=this.onTiddlerDblClick;b[window.event?"onkeydown":"onkeypress"]=this.onTiddlerKeyPress;b.innerHTML=this.getTemplateForTiddler(f,h,g);applyHtmlMacros(b,g);if(store.getTaggedTiddlers(f).length>0){addClass(b,"isTag")}else{removeClass(b,"isTag")}if(store.tiddlerExists(f)){removeClass(b,"shadow");removeClass(b,"missing")}else{addClass(b,store.isShadowTiddler(f)?"shadow":"missing")}if(c){this.addCustomFields(b,c)}forceReflow()}}return b};Story.prototype.addCustomFields=function(c,g){var a=g.decodeHashMap();var b=createTiddlyElement(c,"div",null,"customFields");b.style.display="none";for(var d in a){var f=document.createElement("input");f.setAttribute("type","text");f.setAttribute("value",a[d]);b.appendChild(f);f.setAttribute("edit",d)}};Story.prototype.refreshAllTiddlers=function(b){var c=this.getContainer().firstChild;while(c){var a=c.getAttribute("template");if(a&&c.getAttribute("dirty")!="true"){this.refreshTiddler(c.getAttribute("tiddler"),b?null:a,true)}c=c.nextSibling}};Story.prototype.onTiddlerMouseOver=function(a){addClass(this,"selected")};Story.prototype.onTiddlerMouseOut=function(a){removeClass(this,"selected")};Story.prototype.onTiddlerDblClick=function(a){var c=a||window.event;var b=resolveTarget(c);if(b&&b.nodeName.toLowerCase()!="input"&&b.nodeName.toLowerCase()!="textarea"){if(document.selection&&document.selection.empty){document.selection.empty()}config.macros.toolbar.invokeCommand(this,"defaultCommand",c);c.cancelBubble=true;if(c.stopPropagation){c.stopPropagation()}return true}return false};Story.prototype.onTiddlerKeyPress=function(b){var d=b||window.event;clearMessage();var a=false;var f=this.getAttribute("tiddler");var c=resolveTarget(d);switch(d.keyCode){case 9:if(config.options.chkInsertTabs&&c.tagName.toLowerCase()=="textarea"){replaceSelection(c,String.fromCharCode(9));a=true}if(config.isOpera){c.onblur=function(){this.focus();this.onblur=null}}break;case 13:case 10:case 77:if(d.ctrlKey){blurElement(this);config.macros.toolbar.invokeCommand(this,"defaultCommand",d);a=true}break;case 27:blurElement(this);config.macros.toolbar.invokeCommand(this,"cancelCommand",d);a=true;break}d.cancelBubble=a;if(a){if(d.stopPropagation){d.stopPropagation()}d.returnValue=true;if(d.preventDefault){d.preventDefault()}}return !a};Story.prototype.getTiddlerField=function(h,g){var d=this.getTiddler(h);var f=null;if(d){var b=d.getElementsByTagName("*");for(var a=0;a<b.length;a++){var j=b[a];if(j.tagName.toLowerCase()=="input"||j.tagName.toLowerCase()=="textarea"){if(!f){f=j}if(j.getAttribute("edit")==g){f=j}}}}return f};Story.prototype.focusTiddler=function(c,b){var a=this.getTiddlerField(c,b);if(a){a.focus();a.select()}};Story.prototype.blurTiddler=function(b){var a=this.getTiddler(b);if(a&&a.focus&&a.blur){a.focus();a.blur()}};Story.prototype.setTiddlerField=function(f,a,e,d){var g=this.getTiddlerField(f,d);var b=g.value.readBracketedList();b.setItem(a,e);g.value=String.encodeTiddlyLinkList(b)};Story.prototype.setTiddlerTag=function(c,a,b){this.setTiddlerField(c,a,b,"tags")};Story.prototype.closeTiddler=function(d,b,a){var c=this.getTiddler(d);if(c){clearMessage();this.scrubTiddler(c);if(config.options.chkAnimate&&b&&anim&&typeof Slider=="function"){anim.startAnimating(new Slider(c,false,null,"all"))}else{removeNode(c);forceReflow()}}};Story.prototype.scrubTiddler=function(a){a.id=null};Story.prototype.setDirty=function(c,b){var a=this.getTiddler(c);if(a){a.setAttribute("dirty",b?"true":"false")}};Story.prototype.isDirty=function(b){var a=this.getTiddler(b);if(a){return a.getAttribute("dirty")=="true"}return null};Story.prototype.areAnyDirty=function(){var a=false;this.forEachTiddler(function(c,b){if(this.isDirty(c)){a=true}});return a};Story.prototype.closeAllTiddlers=function(a){clearMessage();this.forEachTiddler(function(c,b){if((c!=a)&&b.getAttribute("dirty")!="true"){this.closeTiddler(c)}});window.scrollTo(0,ensureVisible(this.container))};Story.prototype.isEmpty=function(){var a=this.getContainer();return a&&a.firstChild==null};Story.prototype.search=function(e,a,d){this.closeAllTiddlers();highlightHack=new RegExp(d?e:e.escapeRegExp(),a?"mg":"img");var c=store.search(highlightHack,"title","excludeSearch");this.displayTiddlers(null,c);highlightHack=null;var b=d?"/":"'";if(c.length>0){displayMessage(config.macros.search.successMsg.format([c.length.toString(),b+e+b]))}else{displayMessage(config.macros.search.failureMsg.format([b+e+b]))}};Story.prototype.findContainingTiddler=function(a){while(a&&!hasClass(a,"tiddler")){a=hasClass(a,"popup")&&Popup.stack[0]?Popup.stack[0].root:a.parentNode}return a};Story.prototype.gatherSaveFields=function(g,a){if(g&&g.getAttribute){var d=g.getAttribute("edit");if(d){a[d]=g.value.replace(/\r/mg,"")}if(g.hasChildNodes()){var h=g.childNodes;for(var b=0;b<h.length;b++){this.gatherSaveFields(h[b],a)}}}};Story.prototype.hasChanges=function(c){var b=this.getTiddler(c);if(b){var a={};this.gatherSaveFields(b,a);if(store.fetchTiddler(c)){for(var d in a){if(store.getValue(c,d)!=a[d]){return true}}}else{if(store.isShadowTiddler(c)&&store.getShadowTiddlerText(c)==a.text){return false}else{return true}}}return false};Story.prototype.saveTiddler=function(j,g){var d=this.getTiddler(j);if(d){var f={};this.gatherSaveFields(d,f);var a=f.title||j;if(!store.tiddlerExists(a)){a=a.trim();var c=config.options.txtUserName}if(store.tiddlerExists(a)&&a!=j){if(!confirm(config.messages.overwriteWarning.format([a.toString()]))){return null}}if(a!=j){this.closeTiddler(a,false)}d.id=this.tiddlerId(a);d.setAttribute("tiddler",a);d.setAttribute("template",DEFAULT_VIEW_TEMPLATE);d.setAttribute("dirty","false");if(config.options.chkForceMinorUpdate){g=!g}if(!store.tiddlerExists(a)){g=false}var k=new Date();if(store.tiddlerExists(j)){var l=store.fetchTiddler(j);var e=l.fields;c=l.creator}else{e=merge({},config.defaultCustomFields)}for(var b in f){if(!TiddlyWiki.isStandardField(b)){e[b]=f[b]}}var h=store.saveTiddler(j,a,f.text,g?undefined:config.options.txtUserName,g?undefined:k,f.tags,e,null,null,c);autoSaveChanges(null,[h]);return a}return null};Story.prototype.permaView=function(){var a=[];this.forEachTiddler(function(d,c){a.push(String.encodeTiddlyLink(d))});var b=encodeURIComponent(a.join(" "));if(b==""){b="#"}if(window.location.hash!=b){window.location.hash=b}};Story.prototype.switchTheme=function(h){if(safeMode){return}var c=function(n){var m=n?n.indexOf(config.textPrimitives.sectionSeparator):-1;if(m!=-1){n=n.substr(0,m)}return store.tiddlerExists(n)||store.isShadowTiddler(n)};var f=function(n,o){var m;if(readOnly){m=store.getTiddlerSlice(n,o+"ReadOnly")||store.getTiddlerSlice(n,"Web"+o)}m=m||store.getTiddlerSlice(n,o);if(m&&m.indexOf(config.textPrimitives.sectionSeparator)==0){m=n+m}return c(m)?m:o};var b=function(o,n,p,q){var m=f(p,q);if(n!=m&&store.namedNotifications[o].name==n){store.namedNotifications[o].name=m;return m}return n};var l=config.refresherData.pageTemplate;var e=DEFAULT_VIEW_TEMPLATE;var k=config.tiddlerTemplates[e];var d=DEFAULT_EDIT_TEMPLATE;var j=config.tiddlerTemplates[d];for(var g=0;g<config.notifyTiddlers.length;g++){var a=config.notifyTiddlers[g].name;switch(a){case"PageTemplate":config.refresherData.pageTemplate=b(g,config.refresherData.pageTemplate,h,a);break;case"StyleSheet":removeStyleSheet(config.refresherData.styleSheet);config.refresherData.styleSheet=b(g,config.refresherData.styleSheet,h,a);break;case"ColorPalette":config.refresherData.colorPalette=b(g,config.refresherData.colorPalette,h,a);break;default:break}}config.tiddlerTemplates[e]=f(h,"ViewTemplate");config.tiddlerTemplates[d]=f(h,"EditTemplate");if(!startingUp){if(config.refresherData.pageTemplate!=l||config.tiddlerTemplates[e]!=k||config.tiddlerTemplates[d]!=j){refreshAll();this.refreshAllTiddlers(true)}else{setStylesheet(store.getRecursiveTiddlerText(config.refresherData.styleSheet,"",10),config.refreshers.styleSheet)}config.options.txtTheme=h;saveOptionCookie("txtTheme")}};var backstage={area:null,toolbar:null,button:null,showButton:null,hideButton:null,cloak:null,panel:null,panelBody:null,panelFooter:null,currTabName:null,currTabElem:null,content:null,init:function(){var g=config.messages.backstage;this.area=document.getElementById("backstageArea");this.toolbar=jQuery("#backstageToolbar").empty()[0];this.button=jQuery("#backstageButton").empty()[0];this.button.style.display="block";var d=g.open.text+" "+glyph("bentArrowLeft");this.showButton=createTiddlyButton(this.button,d,g.open.tooltip,function(h){backstage.show();return false},null,"backstageShow");d=glyph("bentArrowRight")+" "+g.close.text;this.hideButton=createTiddlyButton(this.button,d,g.close.tooltip,function(h){backstage.hide();return false},null,"backstageHide");this.cloak=document.getElementById("backstageCloak");this.panel=document.getElementById("backstagePanel");this.panelFooter=createTiddlyElement(this.panel,"div",null,"backstagePanelFooter");this.panelBody=createTiddlyElement(this.panel,"div",null,"backstagePanelBody");this.cloak.onmousedown=function(h){backstage.switchTab(null)};createTiddlyText(this.toolbar,g.prompt);for(d=0;d<config.backstageTasks.length;d++){var a=config.backstageTasks[d];var b=config.tasks[a];var e=b.action?this.onClickCommand:this.onClickTab;var f=b.text+(b.action?"":glyph("downTriangle"));var c=createTiddlyButton(this.toolbar,f,b.tooltip,e,"backstageTab");addClass(c,b.action?"backstageAction":"backstageTask");c.setAttribute("task",a)}this.content=document.getElementById("contentWrapper");if(config.options.chkBackstage){this.show()}else{this.hide()}},isVisible:function(){return this.area?this.area.style.display=="block":false},show:function(){this.area.style.display="block";if(anim&&config.options.chkAnimate){backstage.toolbar.style.left=findWindowWidth()+"px";var a=[{style:"left",start:findWindowWidth(),end:0,template:"%0px"}];anim.startAnimating(new Morpher(backstage.toolbar,config.animDuration,a))}else{backstage.area.style.left="0px"}jQuery(this.showButton).hide();jQuery(this.hideButton).show();config.options.chkBackstage=true;saveOptionCookie("chkBackstage");addClass(this.content,"backstageVisible")},hide:function(){if(this.currTabElem){this.switchTab(null)}else{backstage.toolbar.style.left="0px";if(anim&&config.options.chkAnimate){var a=[{style:"left",start:0,end:findWindowWidth(),template:"%0px"}];var b=function(d,c){backstage.area.style.display="none"};anim.startAnimating(new Morpher(backstage.toolbar,config.animDuration,a,b))}else{this.area.style.display="none"}this.showButton.style.display="block";this.hideButton.style.display="none";config.options.chkBackstage=false;saveOptionCookie("chkBackstage");removeClass(this.content,"backstageVisible")}},onClickCommand:function(b){var a=config.tasks[this.getAttribute("task")];if(a.action){backstage.switchTab(null);a.action()}return false},onClickTab:function(a){backstage.switchTab(this.getAttribute("task"));return false},switchTab:function(b){var d=null;var c=this.toolbar.firstChild;while(c){if(c.getAttribute&&c.getAttribute("task")==b){d=c}c=c.nextSibling}if(b==backstage.currTabName){backstage.hidePanel();return}if(backstage.currTabElem){removeClass(this.currTabElem,"backstageSelTab")}if(d&&b){backstage.preparePanel();addClass(d,"backstageSelTab");var a=config.tasks[b];wikify(a.content,backstage.panelBody,null,null);backstage.showPanel()}else{if(backstage.currTabElem){backstage.hidePanel()}}backstage.currTabName=b;backstage.currTabElem=d},isPanelVisible:function(){return backstage.panel?backstage.panel.style.display=="block":false},preparePanel:function(){backstage.cloak.style.height=findWindowHeight()+"px";backstage.cloak.style.display="block";removeChildren(backstage.panelBody);return backstage.panelBody},showPanel:function(){backstage.panel.style.display="block";if(anim&&config.options.chkAnimate){backstage.panel.style.top=(-backstage.panel.offsetHeight)+"px";var a=[{style:"top",start:-backstage.panel.offsetHeight,end:0,template:"%0px"}];anim.startAnimating(new Morpher(backstage.panel,config.animDuration,a),new Scroller(backstage.panel,false))}else{backstage.panel.style.top="0px"}return backstage.panelBody},hidePanel:function(){if(backstage.currTabElem){removeClass(backstage.currTabElem,"backstageSelTab")}backstage.currTabElem=null;backstage.currTabName=null;if(anim&&config.options.chkAnimate){var a=[{style:"top",start:0,end:-(backstage.panel.offsetHeight),template:"%0px"},{style:"display",atEnd:"none"}];var b=function(d,c){backstage.cloak.style.display="none"};anim.startAnimating(new Morpher(backstage.panel,config.animDuration,a,b))}else{jQuery([backstage.panel,backstage.cloak]).hide()}}};config.macros.backstage={};config.macros.backstage.handler=function(a,c,d){var b=config.tasks[d[0]];if(b){createTiddlyButton(a,b.text,b.tooltip,function(f){backstage.switchTab(d[0]);return false})}};config.macros.importTiddlers.handler=function(b,e,g,d,f,c){if(readOnly){createTiddlyElement(b,"div",null,"marked",this.readOnlyWarning);return}var a=new Wizard();a.createWizard(b,this.wizardTitle);this.restart(a)};config.macros.importTiddlers.onCancel=function(c){var b=new Wizard(this);var a=b.clear();config.macros.importTiddlers.restart(b);return false};config.macros.importTiddlers.onClose=function(a){backstage.hidePanel();return false};config.macros.importTiddlers.restart=function(g){var f=config.macros.importTiddlers;g.addStep(this.step1Title,this.step1Html);var c=g.getElement("selTypes");for(var b in config.adaptors){var h=createTiddlyElement(c,"option",null,null,config.adaptors[b].serverLabel?config.adaptors[b].serverLabel:b);h.value=b}if(config.defaultAdaptor){c.value=config.defaultAdaptor}c=g.getElement("selFeeds");var a=this.getFeeds();for(b in a){h=createTiddlyElement(c,"option",null,null,b);h.value=b}g.setValue("feeds",a);c.onchange=f.onFeedChange;var d=g.getElement("txtBrowse");d.onchange=f.onBrowseChange;d.onkeyup=f.onBrowseChange;g.setButtons([{caption:this.openLabel,tooltip:this.openPrompt,onClick:f.onOpen}]);g.formElem.action="javascript:;";g.formElem.onsubmit=function(){if(!this.txtPath||this.txtPath.value.length){this.lastChild.firstChild.onclick()}}};config.macros.importTiddlers.getFeeds=function(){var a={};var c=store.getTaggedTiddlers("systemServer","title");for(var d=0;d<c.length;d++){var e=c[d].title;var b=store.getTiddlerSlice(e,"Type");if(!b){b="file"}a[e]={title:e,url:store.getTiddlerSlice(e,"URL"),workspace:store.getTiddlerSlice(e,"Workspace"),workspaceList:store.getTiddlerSlice(e,"WorkspaceList"),tiddlerFilter:store.getTiddlerSlice(e,"TiddlerFilter"),serverType:b,description:store.getTiddlerSlice(e,"Description")}}return a};config.macros.importTiddlers.onFeedChange=function(h){var g=new Wizard(this);var b=g.getElement("selTypes");var c=g.getElement("txtPath");var a=g.getValue("feeds");var d=a[this.value];if(d){b.value=d.serverType;c.value=d.url;g.setValue("feedName",d.serverType);g.setValue("feedHost",d.url);g.setValue("feedWorkspace",d.workspace);g.setValue("feedWorkspaceList",d.workspaceList);g.setValue("feedTiddlerFilter",d.tiddlerFilter)}return false};config.macros.importTiddlers.onBrowseChange=function(f){var d=new Wizard(this);if(this.files&&this.files[0]){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalFileRead")}catch(b){showException(b)}}var c=d.getElement("txtPath");c.value=config.macros.importTiddlers.getURLFromLocalPath(this.value);var a=d.getElement("selTypes");a.value="file";return true};config.macros.importTiddlers.getURLFromLocalPath=function(a){if(!a||!a.length){return a}a=a.replace(/\\/g,"/");var b;var d=a.split(":");var e=d[1]||d[0];if(d[1]&&(d[0]=="http"||d[0]=="https"||d[0]=="file")){b=a}else{if(e.substr(0,1)=="/"){b=document.location.protocol+"//"+document.location.hostname+(d[1]?"/":"")+a}else{var g=document.location.href.replace(/\\/g,"/");var f=g.lastIndexOf("/");if(f!=-1){g=g.substr(0,f)}b=g+"/"+e}}return b};config.macros.importTiddlers.onOpen=function(h){var f=config.macros.importTiddlers;var g=new Wizard(this);var d=g.getElement("txtPath");var c=d.value;var a=g.getElement("selTypes").value||config.defaultAdaptor;var j=new config.adaptors[a]();g.setValue("adaptor",j);g.setValue("serverType",a);g.setValue("host",c);var b=j.openHost(c,null,g,f.onOpenHost);if(b!==true){displayMessage(b)}g.setButtons([{caption:f.cancelLabel,tooltip:f.cancelPrompt,onClick:f.onCancel}],f.statusOpenHost);return false};config.macros.importTiddlers.onOpenHost=function(b,d){var c=config.macros.importTiddlers;var e=d.getValue("adaptor");if(b.status!==true){displayMessage("Error in importTiddlers.onOpenHost: "+b.statusText)}var a=e.getWorkspaceList(b,d,c.onGetWorkspaceList);if(a!==true){displayMessage(a)}d.setButtons([{caption:c.cancelLabel,tooltip:c.cancelPrompt,onClick:c.onCancel}],c.statusGetWorkspaceList)};config.macros.importTiddlers.onGetWorkspaceList=function(a,g){var j=config.macros.importTiddlers;if(a.status!==true){displayMessage("Error in importTiddlers.onGetWorkspaceList: "+a.statusText)}g.setValue("context",a);var c=g.getValue("feedWorkspace");if(!c&&a.workspaces.length==1){c=a.workspaces[0].title}if(c){var h=a.adaptor.openWorkspace(c,a,g,j.onOpenWorkspace);if(h!==true){displayMessage(h)}g.setValue("workspace",c);g.setButtons([{caption:j.cancelLabel,tooltip:j.cancelPrompt,onClick:j.onCancel}],j.statusOpenWorkspace);return}g.addStep(j.step2Title,j.step2Html);var m=g.getElement("selWorkspace");m.onchange=j.onWorkspaceChange;for(var l=0;l<a.workspaces.length;l++){var f=createTiddlyElement(m,"option",null,null,a.workspaces[l].title);f.value=a.workspaces[l].title}var k=g.getValue("feedWorkspaceList");if(k){var d=k.parseParams("workspace",null,false,true);for(var b=1;b<d.length;b++){if(a.workspaces.findByField("title",d[b].value)==null){f=createTiddlyElement(m,"option",null,null,d[b].value);f.value=d[b].value}}}if(c){l=g.getElement("txtWorkspace");l.value=c}g.setButtons([{caption:j.openLabel,tooltip:j.openPrompt,onClick:j.onChooseWorkspace}])};config.macros.importTiddlers.onWorkspaceChange=function(c){var b=new Wizard(this);var a=b.getElement("txtWorkspace");a.value=this.value;this.selectedIndex=0;return false};config.macros.importTiddlers.onChooseWorkspace=function(g){var d=config.macros.importTiddlers;var f=new Wizard(this);var h=f.getValue("adaptor");var a=f.getElement("txtWorkspace").value;f.setValue("workspace",a);var c=f.getValue("context");var b=h.openWorkspace(a,c,f,d.onOpenWorkspace);if(b!==true){displayMessage(b)}f.setButtons([{caption:d.cancelLabel,tooltip:d.cancelPrompt,onClick:d.onCancel}],d.statusOpenWorkspace);return false};config.macros.importTiddlers.onOpenWorkspace=function(b,d){var c=config.macros.importTiddlers;if(b.status!==true){displayMessage("Error in importTiddlers.onOpenWorkspace: "+b.statusText)}var e=d.getValue("adaptor");var a=e.getTiddlerList(b,d,c.onGetTiddlerList,d.getValue("feedTiddlerFilter"));if(a!==true){displayMessage(a)}d.setButtons([{caption:c.cancelLabel,tooltip:c.cancelPrompt,onClick:c.onCancel}],c.statusGetTiddlerList)};config.macros.importTiddlers.onGetTiddlerList=function(a,e){var f=config.macros.importTiddlers;if(a.status!==true){e.setButtons([{caption:f.cancelLabel,tooltip:f.cancelPrompt,onClick:f.onCancel}],f.errorGettingTiddlerList);return}var d=[];if(a.tiddlers){for(var b=0;b<a.tiddlers.length;b++){var h=a.tiddlers[b];d.push({title:h.title,modified:h.modified,modifier:h.modifier,text:h.text?wikifyPlainText(h.text,100):"",tags:h.tags,size:h.text?h.text.length:0,tiddler:h})}}d.sort(function(m,l){return m.title<l.title?-1:(m.title==l.title?0:+1)});e.addStep(f.step3Title,f.step3Html);var g=e.getElement("markList");var c=document.createElement("div");g.parentNode.insertBefore(c,g);var k=ListView.create(c,d,f.listViewTemplate);e.setValue("listView",k);e.setValue("context",a);var j=e.getElement("txtSaveTiddler");j.value=f.generateSystemServerName(e);e.setButtons([{caption:f.cancelLabel,tooltip:f.cancelPrompt,onClick:f.onCancel},{caption:f.importLabel,tooltip:f.importPrompt,onClick:f.doImport}])};config.macros.importTiddlers.generateSystemServerName=function(e){var a=e.getValue("serverType");var c=e.getValue("host");var b=e.getValue("workspace");var d=config.macros.importTiddlers[b?"systemServerNamePattern":"systemServerNamePatternNoWorkspace"];return d.format([a,c,b])};config.macros.importTiddlers.saveServerTiddler=function(f){var e=config.macros.importTiddlers;var c=f.getElement("txtSaveTiddler").value;if(store.tiddlerExists(c)){if(!confirm(e.confirmOverwriteSaveTiddler.format([c]))){return}store.suspendNotifications();store.removeTiddler(c);store.resumeNotifications()}var a=f.getValue("serverType");var d=f.getValue("host");var b=f.getValue("workspace");var g=e.serverSaveTemplate.format([a,d,b]);store.saveTiddler(c,c,g,e.serverSaveModifier,new Date(),["systemServer"])};config.macros.importTiddlers.doImport=function(h){var l=config.macros.importTiddlers;var j=new Wizard(this);if(j.getElement("chkSave").checked){l.saveServerTiddler(j)}var f=j.getElement("chkSync").checked;j.setValue("sync",f);var n=j.getValue("listView");var o=ListView.getSelectedRows(n);var c=j.getValue("adaptor");var g=[];var p;for(p=0;p<o.length;p++){if(store.tiddlerExists(o[p])){g.push(o[p])}}if(g.length>0){if(!confirm(l.confirmOverwriteText.format([g.join(", ")]))){return false}}j.addStep(l.step4Title.format([o.length]),l.step4Html);for(p=0;p<o.length;p++){var m=document.createElement("div");createTiddlyLink(m,o[p],true);var d=j.getElement("markReport");d.parentNode.insertBefore(m,d)}j.setValue("remainingImports",o.length);j.setButtons([{caption:l.cancelLabel,tooltip:l.cancelPrompt,onClick:l.onCancel}],l.statusDoingImport);var k=j.getValue("context");var b=k?k.tiddlers:[];for(p=0;p<o.length;p++){var a={allowSynchronous:true,tiddler:b[b.findByField("title",o[p])]};c.getTiddler(o[p],a,j,l.onGetTiddler)}return false};config.macros.importTiddlers.onGetTiddler=function(c,e){var d=config.macros.importTiddlers;if(!c.status){displayMessage("Error in importTiddlers.onGetTiddler: "+c.statusText)}var b=c.tiddler;store.suspendNotifications();store.saveTiddler(b.title,b.title,b.text,b.modifier,b.modified,b.tags,b.fields,true,b.created);if(!e.getValue("sync")){store.setValue(b.title,"server",null)}store.resumeNotifications();if(!c.isSynchronous){store.notify(b.title,true)}var a=e.getValue("remainingImports")-1;e.setValue("remainingImports",a);if(a==0){if(c.isSynchronous){store.notifyAll();refreshDisplay()}e.setButtons([{caption:d.doneLabel,tooltip:d.donePrompt,onClick:d.onClose}],d.statusDoneImport);autoSaveChanges()}};config.macros.upgrade.handler=function(b){var a=new Wizard();a.createWizard(b,this.wizardTitle);a.addStep(this.step1Title,this.step1Html.format([this.source,this.source]));a.setButtons([{caption:this.upgradeLabel,tooltip:this.upgradePrompt,onClick:this.onClickUpgrade}])};config.macros.upgrade.onClickUpgrade=function(j){var f=config.macros.upgrade;var a=new Wizard(this);if(window.location.protocol!="file:"){alert(f.errorCantUpgrade);return false}if(story.areAnyDirty()||store.isDirty()){alert(f.errorNotSaved);return false}var h=getLocalPath(document.location.toString());var d=getBackupPath(h,f.backupExtension);a.setValue("backupPath",d);a.setButtons([],f.statusPreparingBackup);var c=loadOriginal(h);a.setButtons([],f.statusSavingBackup);var b=copyFile(d,h);if(!b){b=saveFile(d,c)}if(!b){a.setButtons([],f.errorSavingBackup);alert(f.errorSavingBackup);return false}a.setButtons([],f.statusLoadingCore);var g=loadRemoteFile(f.source,f.onLoadCore,a);if(typeof g=="string"){a.setButtons([],f.errorLoadingCore);alert(f.errorLoadingCore);return false}return false};config.macros.upgrade.onLoadCore=function(c,b,g,a,l){var h=config.macros.upgrade;var k=b;var f;if(!c){f=h.errorLoadingCore}var d=h.extractVersion(g);if(!d){f=h.errorCoreFormat}if(f){k.setButtons([],f);alert(f);return}var j=function(p){k.setButtons([],h.statusSavingCore);var o=getLocalPath(document.location.toString());saveFile(o,g);k.setButtons([],h.statusReloadingCore);var n=k.getValue("backupPath");var m=document.location.toString()+"?time="+new Date().convertToYYYYMMDDHHMM()+"#upgrade:[["+encodeURI(n)+"]]";window.setTimeout(function(){window.location=m},10)};var e=[h.step2Html_downgrade,h.step2Html_restore,h.step2Html_upgrade][compareVersions(version,d)+1];k.addStep(h.step2Title,e.format([formatVersion(d),formatVersion(version)]));k.setButtons([{caption:h.startLabel,tooltip:h.startPrompt,onClick:j},{caption:h.cancelLabel,tooltip:h.cancelPrompt,onClick:h.onCancel}])};config.macros.upgrade.onCancel=function(c){var b=config.macros.upgrade;var a=new Wizard(this);a.addStep(b.step3Title,b.step3Html);a.setButtons([]);return false};config.macros.upgrade.extractVersion=function(c){var b=/^var version = \{title: "([^"]+)", major: (\d+), minor: (\d+), revision: (\d+)(, beta: (\d+)){0,1}, date: new Date\("([^"]+)"\)/mg;var a=b.exec(c);return a?{title:a[1],major:a[2],minor:a[3],revision:a[4],beta:a[6],date:new Date(a[7])}:null};function upgradeFrom(c){var b=new TiddlyWiki();var a=loadFile(c);if(window.netscape!==undefined){a=convertUTF8ToUnicode(a)}b.importTiddlyWiki(a);b.forEachTiddler(function(e,d){if(!store.getTiddler(e)){store.addTiddler(d)}});refreshDisplay();saveChanges();alert(config.messages.upgradeDone.format([formatVersion()]));window.location=window.location.toString().substr(0,window.location.toString().lastIndexOf("?"))}config.syncers={};var currSync=null;config.macros.sync.handler=function(a,d,f,c,e,b){if(!c.isStatic){this.startSync(a)}};config.macros.sync.cancelSync=function(){currSync=null};config.macros.sync.startSync=function(b){if(currSync){config.macros.sync.cancelSync()}currSync={};currSync.syncList=this.getSyncableTiddlers();currSync.syncTasks=this.createSyncTasks(currSync.syncList);this.preProcessSyncableTiddlers(currSync.syncList);var c=new Wizard();currSync.wizard=c;c.createWizard(b,this.wizardTitle);c.addStep(this.step1Title,this.step1Html);var d=c.getElement("markList");var a=document.createElement("div");d.parentNode.insertBefore(a,d);currSync.listView=ListView.create(a,currSync.syncList,this.listViewTemplate);this.processSyncableTiddlers(currSync.syncList);c.setButtons([{caption:this.syncLabel,tooltip:this.syncPrompt,onClick:this.doSync}])};config.macros.sync.getSyncableTiddlers=function(){var a=[];store.forEachTiddler(function(d,b){var c={};c.serverType=b.getServerType();c.serverHost=b.fields["server.host"];if(c.serverType&&c.serverHost){c.adaptor=new config.adaptors[c.serverType];c.serverHost=c.adaptor.fullHostName(c.serverHost);c.serverWorkspace=b.fields["server.workspace"];c.tiddler=b;c.title=b.title;c.isTouched=b.isTouched();c.selected=c.isTouched;c.syncStatus=config.macros.sync.syncStatusList[c.isTouched?"changedLocally":"none"];c.status=c.syncStatus.text;a.push(c)}});a.sort(function(d,c){return d.title<c.title?-1:(d.title==c.title?0:+1)});return a};config.macros.sync.preProcessSyncableTiddlers=function(c){for(var b=0;b<c.length;b++){var a=c[b];a.serverUrl=a.adaptor.generateTiddlerInfo(a.tiddler).uri}};config.macros.sync.processSyncableTiddlers=function(c){for(var b=0;b<c.length;b++){var a=c[b];if(a.syncStatus.display){a.rowElement.style.display=a.syncStatus.display}if(a.syncStatus.className){a.rowElement.className=a.syncStatus.className}}};config.macros.sync.createSyncTasks=function(g){var f=[];for(var d=0;d<g.length;d++){var c=g[d];var e=null;for(var b=0;b<f.length;b++){var a=f[b];if(c.serverType==a.serverType&&c.serverHost==a.serverHost&&c.serverWorkspace==a.serverWorkspace){e=a}}if(e){c.syncTask=e;e.syncItems.push(c)}else{c.syncTask=this.createSyncTask(c);f.push(c.syncTask)}}return f};config.macros.sync.createSyncTask=function(d){var b={};b.serverType=d.serverType;b.serverHost=d.serverHost;b.serverWorkspace=d.serverWorkspace;b.syncItems=[d];var e=function(f,g){if(f.status){f.adaptor.getTiddlerList(f,g,a);return true}displayMessage(f.statusText);return false};var a=function(k,g){var m=config.macros.sync;if(!k.status){displayMessage(k.statusText);return false}syncItems=k.userParams;var l=k.tiddlers;for(var j=0;j<syncItems.length;j++){var h=syncItems[j];var n=l.findByField("title",h.title);if(n!==null){if(l[n].fields["server.page.revision"]>h.tiddler.fields["server.page.revision"]){h.syncStatus=m.syncStatusList[h.isTouched?"changedBoth":"changedServer"]}}else{h.syncStatus=m.syncStatusList.notFound}m.updateSyncStatus(h)}return true};var c={host:b.serverHost,workspace:b.serverWorkspace};d.adaptor.openHost(b.serverHost);d.adaptor.openWorkspace(b.serverWorkspace,c,b.syncItems,e);return b};config.macros.sync.updateSyncStatus=function(a){var b=a.colElements.status;removeChildren(b);createTiddlyText(b,a.syncStatus.text);if(a.syncStatus.display){a.rowElement.style.display=a.syncStatus.display}if(a.syncStatus.className){a.rowElement.className=a.syncStatus.className}};config.macros.sync.doSync=function(h){var k=config.macros.sync;var b=function(n,o){if(o){var e=n.tiddler;store.saveTiddler(e.title,e.title,e.text,e.modifier,e.modified,e.tags,e.fields,true,e.created);o.syncStatus=k.syncStatusList.gotFromServer;k.updateSyncStatus(o)}};var l=function(e,n){if(n){store.resetTiddler(e.title);n.syncStatus=k.syncStatusList.putToServer;k.updateSyncStatus(n)}};var m=ListView.getSelectedRows(currSync.listView);var c=k.syncStatusList;for(var d=0;d<currSync.syncList.length;d++){var f=currSync.syncList[d];if(m.indexOf(f.title)!=-1){var g="Error in doSync: ";try{var a=true;switch(f.syncStatus){case c.changedServer:a=f.adaptor.getTiddler(f.title,null,f,b);break;case c.notFound:case c.changedLocally:case c.changedBoth:a=f.adaptor.putTiddler(f.tiddler,null,f,l);break;default:break}if(!a){displayMessage(g+a)}}catch(j){if(j.name=="TypeError"){displayMessage("sync operation unsupported: "+j.message)}else{displayMessage(g+j.message)}}}}return false};config.macros.plugins.handler=function(b,e,h,c,g){var d=new Wizard();d.createWizard(b,this.wizardTitle);d.addStep(this.step1Title,this.step1Html);var f=d.getElement("markList");var a=document.createElement("div");f.parentNode.insertBefore(a,f);a.setAttribute("refresh","macro");a.setAttribute("macroName","plugins");a.setAttribute("params",g);this.refresh(a,g)};config.macros.plugins.refresh=function(e,c){var g=config.macros.plugins;var f=new Wizard(e);var b=[];ListView.forEachSelector(e,function(n,m){if(n.checked){b.push(n.getAttribute("rowName"))}});removeChildren(e);c=c.parseParams("anon");var d=installedPlugins.slice(0);var l,h,a;var k=store.getTaggedTiddlers("systemConfig");for(l=0;l<k.length;l++){h=k[l];if(d.findByField("title",h.title)==null){a=getPluginInfo(h);a.executed=false;a.log.splice(0,0,this.skippedText);d.push(a)}}for(l=0;l<d.length;l++){a=d[l];a.size=a.tiddler.text?a.tiddler.text.length:0;a.forced=a.tiddler.isTagged("systemConfigForce");a.disabled=a.tiddler.isTagged("systemConfigDisable");a.Selected=b.indexOf(d[l].title)!=-1}if(d.length==0){createTiddlyElement(e,"em",null,null,this.noPluginText);f.setButtons([])}else{var j=ListView.create(e,d,this.listViewTemplate,this.onSelectCommand);f.setValue("listView",j);f.setButtons([{caption:g.removeLabel,tooltip:g.removePrompt,onClick:g.doRemoveTag},{caption:g.deleteLabel,tooltip:g.deletePrompt,onClick:g.doDelete}])}};config.macros.plugins.doRemoveTag=function(f){var d=new Wizard(this);var a=d.getValue("listView");var c=ListView.getSelectedRows(a);if(c.length==0){alert(config.messages.nothingSelected)}else{for(var b=0;b<c.length;b++){store.setTiddlerTag(c[b],false,"systemConfig")}}};config.macros.plugins.doDelete=function(f){var d=new Wizard(this);var a=d.getValue("listView");var c=ListView.getSelectedRows(a);if(c.length==0){alert(config.messages.nothingSelected)}else{if(confirm(config.macros.plugins.confirmDeleteText.format([c.join(", ")]))){for(var b=0;b<c.length;b++){store.removeTiddler(c[b]);story.closeTiddler(c[b],true)}}}};function getMessageDiv(){var a=document.getElementById("messageArea");if(!a){return null}if(!a.hasChildNodes()){createTiddlyButton(createTiddlyElement(a,"div",null,"messageToolbar"),config.messages.messageClose.text,config.messages.messageClose.tooltip,clearMessage)}a.style.display="block";return createTiddlyElement(a,"div")}function displayMessage(d,a){var c=getMessageDiv();if(!c){alert(d);return}if(a){var b=createTiddlyElement(c,"a",null,null,d);b.href=a;b.target="_blank"}else{c.appendChild(document.createTextNode(d))}}function clearMessage(){var a=document.getElementById("messageArea");if(a){removeChildren(a);a.style.display="none"}return false}config.notifyTiddlers=[{name:"StyleSheetLayout",notify:refreshStyles},{name:"StyleSheetColors",notify:refreshStyles},{name:"StyleSheet",notify:refreshStyles},{name:"StyleSheetPrint",notify:refreshStyles},{name:"PageTemplate",notify:refreshPageTemplate},{name:"SiteTitle",notify:refreshPageTitle},{name:"SiteSubtitle",notify:refreshPageTitle},{name:"WindowTitle",notify:refreshPageTitle},{name:"ColorPalette",notify:refreshColorPalette},{name:null,notify:refreshDisplay}];config.refreshers={link:function(b,a){var c=b.getAttribute("tiddlyLink");refreshTiddlyLink(b,c);return true},tiddler:function(c,a){var d=c.getAttribute("tiddler");var b=c.getAttribute("template");if(a&&a.indexOf(d)!=-1&&!story.isDirty(d)){story.refreshTiddler(d,b,true)}else{refreshElements(c,a)}return true},content:function(d,a){var f=d.getAttribute("tiddler");var c=d.getAttribute("force");var b=d.getAttribute("args");if(c!=null||a==null||a.indexOf(f)!=-1){removeChildren(d);config.macros.tiddler.transclude(d,f,b);return true}else{return false}},macro:function(c,a){var b=c.getAttribute("macroName");var d=c.getAttribute("params");if(b){b=config.macros[b]}if(b&&b.refresh){b.refresh(c,d)}return true}};config.refresherData={styleSheet:"StyleSheet",defaultStyleSheet:"StyleSheet",pageTemplate:"PageTemplate",defaultPageTemplate:"PageTemplate",colorPalette:"ColorPalette",defaultColorPalette:"ColorPalette"};function refreshElements(a,d){var b=a.childNodes;for(var k=0;k<b.length;k++){var j=b[k],g=null;if(j.getAttribute&&(j.tagName?j.tagName!="IFRAME":true)){g=j.getAttribute("refresh")}var f=config.refreshers[g];var h=false;if(f!=undefined){h=f(j,d)}if(j.hasChildNodes()&&!h){refreshElements(j,d)}}}function applyHtmlMacros(a,b){var g=a.firstChild;while(g){var d=g.nextSibling;if(g.getAttribute){var c=g.getAttribute("macro");if(c){g.removeAttribute("macro");var h="";var f=c.indexOf(" ");if(f!=-1){h=c.substr(f+1);c=c.substr(0,f)}invokeMacro(g,c,h,null,b)}}if(g.hasChildNodes()){applyHtmlMacros(g,b)}g=d}}function refreshPageTemplate(f){var c=jQuery("<div/>").appendTo("body").hide()[0];var e=story.getContainer();var b,d;if(e){b=e.childNodes;for(d=b.length-1;d>=0;d--){c.appendChild(b[d])}}var g=document.getElementById("contentWrapper");var a=function(j){var h=j?j.indexOf(config.textPrimitives.sectionSeparator):-1;if(h!=-1){j=j.substr(0,h)}return store.tiddlerExists(j)||store.isShadowTiddler(j)};if(!f||!a(f)){f=config.refresherData.pageTemplate}if(!a(f)){f=config.refresherData.defaultPageTemplate}g.innerHTML=store.getRecursiveTiddlerText(f,null,10);applyHtmlMacros(g);refreshElements(g);e=story.getContainer();removeChildren(e);if(!e){e=createTiddlyElement(g,"div",story.containerId())}b=c.childNodes;for(d=b.length-1;d>=0;d--){e.appendChild(b[d])}removeNode(c)}function refreshDisplay(b){if(typeof b=="string"){b=[b]}var a=document.getElementById("contentWrapper");refreshElements(a,b);if(backstage.isPanelVisible()){a=document.getElementById("backstage");refreshElements(a,b)}}function refreshPageTitle(){document.title=getPageTitle()}function getPageTitle(){return wikifyPlain("WindowTitle")}function refreshStyles(b,a){setStylesheet(b==null?"":store.getRecursiveTiddlerText(b,"",10),b,a||document)}function refreshColorPalette(a){if(!startingUp){refreshAll()}}function refreshAll(){refreshPageTemplate();refreshDisplay();refreshStyles("StyleSheetLayout");refreshStyles("StyleSheetColors");refreshStyles(config.refresherData.styleSheet);refreshStyles("StyleSheetPrint")}config.optionHandlers={txt:{get:function(a){return encodeCookie(config.options[a].toString())},set:function(a,b){config.options[a]=decodeCookie(b)}},chk:{get:function(a){return config.options[a]?"true":"false"},set:function(a,b){config.options[a]=b=="true"}}};function loadOptionsCookie(){if(safeMode){return}var e=document.cookie.split(";");for(var h=0;h<e.length;h++){var g=e[h].indexOf("=");if(g!=-1){var d=e[h].substr(0,g).trim();var f=e[h].substr(g+1).trim();var a=d.substr(0,3);var b=config.optionHandlers;if(b[a]&&b[a].set){b[a].set(d,f)}}}}function saveOptionCookie(d){if(safeMode){return}if(d.match(/[()\s]/g,"_")){alert(config.messages.invalidCookie.format([d]));return}var e=d+"=";var a=d.substr(0,3);var b=config.optionHandlers;if(b[a]&&b[a].get){e+=b[a].get(d)}e+="; expires=Fri, 1 Jan 2038 12:00:00 UTC; path=/";document.cookie=e}function removeCookie(a){document.cookie=a+"=; expires=Thu, 01-Jan-1970 00:00:01 UTC; path=/;"}function encodeCookie(a){return escape(convertUnicodeToHtmlEntities(a))}function decodeCookie(s){s=unescape(s);var re=/&#[0-9]{1,5};/g;return s.replace(re,function($0){return String.fromCharCode(eval($0.replace(/[&#;]/g,"")))})}config.macros.option.genericCreate=function(a,e,b,d,g){var f=config.macros.option.types[e];var h=document.createElement(f.elementType);if(f.typeValue){h.setAttribute("type",f.typeValue)}h[f.eventName]=f.onChange;h.setAttribute("option",b);h.className=d||f.className;if(config.optionsDesc[b]){h.setAttribute("title",config.optionsDesc[b])}a.appendChild(h);if(g!="no"){createTiddlyText(a,config.optionsDesc[b]||b)}h[f.valueField]=config.options[b];return h};config.macros.option.genericOnChange=function(d){var b=this.getAttribute("option");if(b){var a=b.substr(0,3);var c=config.macros.option.types[a];if(c.elementType&&c.valueField){config.macros.option.propagateOption(b,c.valueField,this[c.valueField],c.elementType,this)}}return true};config.macros.option.types={txt:{elementType:"input",valueField:"value",eventName:"onchange",className:"txtOptionInput",create:config.macros.option.genericCreate,onChange:config.macros.option.genericOnChange},chk:{elementType:"input",valueField:"checked",eventName:"onclick",className:"chkOptionInput",typeValue:"checkbox",create:config.macros.option.genericCreate,onChange:config.macros.option.genericOnChange}};config.macros.option.propagateOption=function(f,d,h,c,g){config.options[f]=h;saveOptionCookie(f);var b=document.getElementsByTagName(c);for(var e=0;e<b.length;e++){var a=b[e].getAttribute("option");if(f==a&&b[e]!=g){b[e][d]=h}}};config.macros.option.handler=function(e,b,d,f,c){d=c.parseParams("anon",null,true,false,false);var a=(d[1]&&d[1].name=="anon")?d[1].value:getParam(d,"name",null);var k=(d[2]&&d[2].name=="anon")?d[2].value:getParam(d,"class",null);var j=getParam(d,"desc","no");var l=a.substr(0,3);var g=config.macros.option.types[l];if(g&&g.create){g.create(e,l,a,k,j)}};config.macros.options.handler=function(f,b,e,g,d){e=d.parseParams("anon",null,true,false,false);var c=getParam(e,"showUnknown","no");var j=new Wizard();j.createWizard(f,this.wizardTitle);j.addStep(this.step1Title,this.step1Html);var k=j.getElement("markList");var a=j.getElement("chkUnknown");a.checked=c=="yes";a.onchange=this.onChangeUnknown;var h=document.createElement("div");k.parentNode.insertBefore(h,k);j.setValue("listWrapper",h);this.refreshOptions(h,c=="yes")};config.macros.options.refreshOptions=function(a,b){var g=[];for(var j in config.options){var d={};d.option="";d.name=j;d.lowlight=!config.optionsDesc[j];d.description=d.lowlight?this.unknownDescription:config.optionsDesc[j];if(!d.lowlight||b){g.push(d)}}g.sort(function(k,h){return k.name.substr(3)<h.name.substr(3)?-1:(k.name.substr(3)==h.name.substr(3)?0:+1)});var c=ListView.create(a,g,this.listViewTemplate);for(j=0;j<g.length;j++){var f=g[j].name.substr(0,3);var e=config.macros.option.types[f];if(e&&e.create){e.create(g[j].colElements.option,f,g[j].name,null,"no")}}};config.macros.options.onChangeUnknown=function(c){var b=new Wizard(this);var a=b.getValue("listWrapper");removeChildren(a);config.macros.options.refreshOptions(a,this.checked);return false};var saveUsingSafari=false;var startSaveArea='<div id="storeArea">';var endSaveArea="</div>";function confirmExit(){hadConfirmExit=true;if((store&&store.isDirty&&store.isDirty())||(story&&story.areAnyDirty&&story.areAnyDirty())){return config.messages.confirmExit}}function checkUnsavedChanges(){if(store&&store.isDirty&&store.isDirty()&&window.hadConfirmExit===false){if(confirm(config.messages.unsavedChangesWarning)){saveChanges()}}}function updateLanguageAttribute(c){if(config.locale){var d=/(<html(?:.*?)?)(?: xml:lang\="([a-z]+)")?(?: lang\="([a-z]+)")?>/;var a=d.exec(c);if(a){var b=a[1];if(a[2]){b+=' xml:lang="'+config.locale+'"'}if(a[3]){b+=' lang="'+config.locale+'"'}b+=">";c=c.substr(0,a.index)+b+c.substr(a.index+a[0].length)}}return c}function updateMarkupBlock(c,b,a){return c.replaceChunk("<!--%0-START-->".format([b]),"<!--%0-END-->".format([b]),"\n"+convertUnicodeToFileFormat(store.getRecursiveTiddlerText(a,""))+"\n")}function updateOriginal(b,d,c){if(!d){d=locateStoreArea(b)}if(!d){alert(config.messages.invalidFileError.format([c]));return null}var a=b.substr(0,d[0]+startSaveArea.length)+"\n"+convertUnicodeToFileFormat(store.allTiddlersAsHtml())+"\n"+b.substr(d[1]);var e=convertUnicodeToFileFormat(getPageTitle()).htmlEncode();a=a.replaceChunk("<title>","</title>"," "+e+" ");a=updateLanguageAttribute(a);a=updateMarkupBlock(a,"PRE-HEAD","MarkupPreHead");a=updateMarkupBlock(a,"POST-HEAD","MarkupPostHead");a=updateMarkupBlock(a,"PRE-BODY","MarkupPreBody");a=updateMarkupBlock(a,"POST-SCRIPT","MarkupPostBody");return a}function locateStoreArea(c){var d=c.indexOf(startSaveArea);var b=c.indexOf("<!--POST-STOREAREA-->");if(b==-1){b=c.indexOf("<!--POST-BODY-START-->")}var a=c.lastIndexOf(endSaveArea,b==-1?c.length:b);return(d!=-1&&a!=-1)?[d,a]:null}function autoSaveChanges(a,b){if(config.options.chkAutoSave){saveChanges(a,b)}}function loadOriginal(a){return loadFile(a)}function saveChanges(b,c){if(b&&!store.isDirty()){return}clearMessage();var e=new Date();var h=config.messages;var g=document.location.toString();if(g.substr(0,5)!="file:"){alert(h.notFileUrlError);if(store.tiddlerExists(h.saveInstructions)){story.displayTiddler(null,h.saveInstructions)}return}var d=getLocalPath(g);var a=loadOriginal(d);if(a==null){alert(h.cantSaveError);if(store.tiddlerExists(h.saveInstructions)){story.displayTiddler(null,h.saveInstructions)}return}var f=locateStoreArea(a);if(!f){alert(h.invalidFileError.format([d]));return}saveMain(d,a,f);if(config.options.chkSaveBackups){saveBackup(d,a)}if(config.options.chkSaveEmptyTemplate){saveEmpty(d,a,f)}if(config.options.chkGenerateAnRssFeed&&saveRss instanceof Function){saveRss(d)}if(config.options.chkDisplayInstrumentation){displayMessage("saveChanges "+(new Date()-e)+" ms")}}function saveMain(e,c,f){var d;try{var b=updateOriginal(c,f,e);d=saveFile(e,b)}catch(a){showException(a)}if(d){displayMessage(config.messages.mainSaved,"file://"+e);store.setDirty(false)}else{alert(config.messages.mainFailed)}}function saveBackup(d,b){var c=getBackupPath(d);var a=copyFile(c,d);if(!a){a=saveFile(c,b)}if(a){displayMessage(config.messages.backupSaved,"file://"+c)}else{alert(config.messages.backupFailed)}}function saveEmpty(c,a,f){var g,e;if((e=c.lastIndexOf("/"))!=-1){g=c.substr(0,e)+"/"}else{if((e=c.lastIndexOf("\\"))!=-1){g=c.substr(0,e)+"\\"}else{g=c+"."}}g+="empty.html";var b=a.substr(0,f[0]+startSaveArea.length)+a.substr(f[1]);var d=saveFile(g,b);if(d){displayMessage(config.messages.emptySaved,"file://"+g)}else{alert(config.messages.emptyFailed)}}function getLocalPath(e){var d=convertUriToUTF8(e,config.options.txtFileSystemCharSet);var b=d.indexOf("?");if(b!=-1){d=d.substr(0,b)}var a=d.indexOf("#");if(a!=-1){d=d.substr(0,a)}if(d.indexOf("file://localhost/")==0){d="file://"+d.substr(16)}var c;if(d.charAt(9)==":"){c=unescape(d.substr(8)).replace(new RegExp("/","g"),"\\")}else{if(d.indexOf("file://///")==0){c="\\\\"+unescape(d.substr(10)).replace(new RegExp("/","g"),"\\")}else{if(d.indexOf("file:///")==0){c=unescape(d.substr(7))}else{if(d.indexOf("file:/")==0){c=unescape(d.substr(5))}else{c="\\\\"+unescape(d.substr(7)).replace(new RegExp("/","g"),"\\")}}}}return c}function getBackupPath(d,f,g){var b="\\";var a=d.lastIndexOf("\\");if(a==-1){a=d.lastIndexOf("/");b="/"}var e=config.options.txtBackupFolder;if(!e||e==""){e="."}var c=d.substr(0,a)+b+e+d.substr(a);c=c.substr(0,c.lastIndexOf("."))+".";if(f){c+=f.replace(/[\\\/\*\?\":<> ]/g,"_")+"."}c+=(new Date()).convertToYYYYMMDDHHMMSSMMM()+"."+(g||"html");return c}function saveRss(b){var a=b.substr(0,b.lastIndexOf("."))+".xml";if(saveFile(a,convertUnicodeToFileFormat(generateRss()))){displayMessage(config.messages.rssSaved,"file://"+a)}else{alert(config.messages.rssFailed)}}tiddlerToRssItem=function(b,d){var c="<title>"+b.title.htmlEncode()+"</title>\n";c+="<description>"+wikifyStatic(b.text,null,b).htmlEncode()+"</description>\n";for(var a=0;a<b.tags.length;a++){c+="<category>"+b.tags[a]+"</category>\n"}c+="<link>"+d+"#"+encodeURIComponent(String.encodeTiddlyLink(b.title))+"</link>\n";c+="<pubDate>"+b.modified.toGMTString()+"</pubDate>\n";return c};function generateRss(){var c=[];var f=new Date();var a=store.getTiddlerText("SiteUrl");c.push('<?xml version="1.0"?>');c.push('<rss version="2.0">');c.push("<channel>");c.push("<title>"+wikifyPlain("SiteTitle").htmlEncode()+"</title>");if(a){c.push("<link>"+a.htmlEncode()+"</link>")}c.push("<description>"+wikifyPlain("SiteSubtitle").htmlEncode()+"</description>");c.push("<language>"+config.locale+"</language>");c.push("<copyright>Copyright "+f.getFullYear()+" "+config.options.txtUserName.htmlEncode()+"</copyright>");c.push("<pubDate>"+f.toGMTString()+"</pubDate>");c.push("<lastBuildDate>"+f.toGMTString()+"</lastBuildDate>");c.push("<docs>http://blogs.law.harvard.edu/tech/rss</docs>");c.push("<generator>TiddlyWiki "+formatVersion()+"</generator>");var e=store.getTiddlers("modified","excludeLists");var g=config.numRssItems>e.length?0:e.length-config.numRssItems;for(var b=e.length-1;b>=g;b--){c.push("<item>\n"+tiddlerToRssItem(e[b],a)+"\n</item>")}c.push("</channel>");c.push("</rss>");return c.join("\n")}function convertUTF8ToUnicode(a){return config.browser.isOpera||!window.netscape?manualConvertUTF8ToUnicode(a):mozConvertUTF8ToUnicode(a)}function manualConvertUTF8ToUnicode(d){var g=d;var f=0;var j=0;var e,b,a;var h;while(f<d.length){e=d.charCodeAt(f++);if(e<128){j++}else{if(e<224){b=d.charCodeAt(f++);h=String.fromCharCode(((e&31)<<6)|(b&63));g=g.substring(0,j++).concat(h,d.substr(f))}else{b=d.charCodeAt(f++);a=d.charCodeAt(f++);h=String.fromCharCode(((e&15)<<12)|((b&63)<<6)|(a&63));g=g.substring(0,j++).concat(h,d.substr(f))}}}return g}function mozConvertUTF8ToUnicode(a){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var d=Components.classes["@mozilla.org/intl/scriptableunicodeconverter"].createInstance(Components.interfaces.nsIScriptableUnicodeConverter);d.charset="UTF-8"}catch(b){return manualConvertUTF8ToUnicode(a)}var c=d.ConvertToUnicode(a);var e=d.Finish();return e.length>0?c+e:c}function convertUnicodeToFileFormat(a){return config.browser.isOpera||!window.netscape?(config.browser.isIE?convertUnicodeToHtmlEntities(a):a):mozConvertUnicodeToUTF8(a)}function convertUnicodeToHtmlEntities(b){var a=/[^\u0000-\u007F]/g;return b.replace(a,function(c){return"&#"+c.charCodeAt(0).toString()+";"})}function convertUnicodeToUTF8(a){return convertUnicodeToFileFormat(a)}function manualConvertUnicodeToUTF8(a){return unescape(encodeURIComponent(a))}function mozConvertUnicodeToUTF8(d){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var c=Components.classes["@mozilla.org/intl/scriptableunicodeconverter"].createInstance(Components.interfaces.nsIScriptableUnicodeConverter);c.charset="UTF-8"}catch(b){return manualConvertUnicodeToUTF8(d)}var a=c.ConvertFromUnicode(d);var e=c.Finish();return e.length>0?a+e:a}function convertUriToUTF8(d,c){if(window.netscape==undefined||c==undefined||c==""){return d}try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var b=Components.classes["@mozilla.org/intl/utf8converterservice;1"].getService(Components.interfaces.nsIUTF8ConverterService)}catch(a){return d}return b.convertURISpecToUTF8(d,c)}function copyFile(a,b){return config.browser.isIE?ieCopyFile(a,b):false}function saveFile(a,c){var b=mozillaSaveFile(a,c);if(!b){b=ieSaveFile(a,c)}if(!b){b=javaSaveFile(a,c)}return b}function loadFile(a){var b=mozillaLoadFile(a);if((b==null)||(b==false)){b=ieLoadFile(a)}if((b==null)||(b==false)){b=javaLoadFile(a)}return b}function ieCreatePath(e){try{var d=new ActiveXObject("Scripting.FileSystemObject")}catch(b){return null}var f=e.lastIndexOf("\\");if(f==-1){f=e.lastIndexOf("/")}if(f!=-1){e=e.substring(0,f+1)}var a=[e];var c=d.GetParentFolderName(e);while(c&&!d.FolderExists(c)){a.push(c);c=d.GetParentFolderName(c)}for(i=a.length-1;i>=0;i--){if(!d.FolderExists(a[i])){d.CreateFolder(a[i])}}return true}function ieSaveFile(c,d){ieCreatePath(c);try{var e=new ActiveXObject("Scripting.FileSystemObject")}catch(b){return null}var a=e.OpenTextFile(c,2,-1,0);a.Write(d);a.Close();return true}function ieLoadFile(c){try{var e=new ActiveXObject("Scripting.FileSystemObject");var b=e.OpenTextFile(c,1);var d=b.ReadAll();b.Close()}catch(a){return null}return d}function ieCopyFile(a,d){ieCreatePath(a);try{var c=new ActiveXObject("Scripting.FileSystemObject");c.GetFile(d).Copy(a)}catch(b){return false}return true}function mozillaSaveFile(d,e){if(window.Components){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var c=Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);c.initWithPath(d);if(!c.exists()){c.create(0,436)}var a=Components.classes["@mozilla.org/network/file-output-stream;1"].createInstance(Components.interfaces.nsIFileOutputStream);a.init(c,32|2,4,null);a.write(e,e.length);a.flush();a.close();return true}catch(b){return false}}return null}function mozillaLoadFile(d){if(window.Components){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var c=Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);c.initWithPath(d);if(!c.exists()){return null}var b=Components.classes["@mozilla.org/network/file-input-stream;1"].createInstance(Components.interfaces.nsIFileInputStream);b.init(c,1,4,null);var f=Components.classes["@mozilla.org/scriptableinputstream;1"].createInstance(Components.interfaces.nsIScriptableInputStream);f.init(b);var e=f.read(f.available());f.close();b.close();return e}catch(a){return false}}return null}function javaUrlToFilename(a){var c="//localhost";if(a.indexOf(c)==0){return a.substring(c.length)}var b=a.indexOf(":");return b>0?a.substring(b-1):a}function javaSaveFile(b,d){try{if(document.applets.TiddlySaver){return document.applets.TiddlySaver.saveFile(javaUrlToFilename(b),"UTF-8",d)}}catch(a){}try{var c=new java.io.PrintStream(new java.io.FileOutputStream(javaUrlToFilename(b)));c.print(d);c.close()}catch(a){return null}return true}function javaLoadFile(c){try{if(document.applets.TiddlySaver){return String(document.applets.TiddlySaver.loadFile(javaUrlToFilename(c),"UTF-8"))}}catch(b){}var e=[];try{var d=new java.io.BufferedReader(new java.io.FileReader(javaUrlToFilename(c)));var a;while((a=d.readLine())!=null){e.push(new String(a))}d.close()}catch(b){return null}return e.join("\n")}function AdaptorBase(){this.host=null;this.store=null;return this}AdaptorBase.prototype.close=function(){return true};AdaptorBase.prototype.fullHostName=function(a){if(!a){return""}a=a.trim();if(!a.match(/:\/\//)){a="http://"+a}if(a.substr(a.length-1)=="/"){a=a.substr(0,a.length-1)}return a};AdaptorBase.minHostName=function(a){return a?a.replace(/^http:\/\//,"").replace(/\/$/,""):""};AdaptorBase.prototype.setContext=function(b,a,c){if(!b){b={}}b.userParams=a;if(c){b.callback=c}b.adaptor=this;if(!b.host){b.host=this.host}b.host=this.fullHostName(b.host);if(!b.workspace){b.workspace=this.workspace}return b};AdaptorBase.prototype.openHost=function(c,b,a,d){this.host=c;b=this.setContext(b,a,d);b.status=true;if(d){window.setTimeout(function(){b.callback(b,a)},10)}return true};AdaptorBase.prototype.openWorkspace=function(b,c,a,d){this.workspace=b;c=this.setContext(c,a,d);c.status=true;if(d){window.setTimeout(function(){d(c,a)},10)}return true};function FileAdaptor(){}FileAdaptor.prototype=new AdaptorBase();FileAdaptor.serverType="file";FileAdaptor.serverLabel="TiddlyWiki";FileAdaptor.loadTiddlyWikiCallback=function(a,c,d,b,e){c.status=a;if(!a){c.statusText="Error reading file"}else{c.adaptor.store=new TiddlyWiki();if(!c.adaptor.store.importTiddlyWiki(d)){c.statusText=config.messages.invalidFileError.format([b]);c.status=false}}c.complete(c,c.userParams)};FileAdaptor.prototype.getWorkspaceList=function(b,a,c){b=this.setContext(b,a,c);b.workspaces=[{title:"(default)"}];b.status=true;if(c){window.setTimeout(function(){c(b,a)},10)}return true};FileAdaptor.prototype.getTiddlerList=function(c,a,e,d){c=this.setContext(c,a,e);if(!c.filter){c.filter=d}c.complete=FileAdaptor.getTiddlerListComplete;if(this.store){var b=c.complete(c,c.userParams)}else{b=loadRemoteFile(c.host,FileAdaptor.loadTiddlyWikiCallback,c);if(typeof b!="string"){b=true}}return b};FileAdaptor.getTiddlerListComplete=function(c,a){if(c.status){if(c.filter){c.tiddlers=c.adaptor.store.filterTiddlers(c.filter)}else{c.tiddlers=[];c.adaptor.store.forEachTiddler(function(e,d){c.tiddlers.push(d)})}for(var b=0;b<c.tiddlers.length;b++){c.tiddlers[b].fields["server.type"]=FileAdaptor.serverType;c.tiddlers[b].fields["server.host"]=AdaptorBase.minHostName(c.host);c.tiddlers[b].fields["server.page.revision"]=c.tiddlers[b].modified.convertToYYYYMMDDHHMM()}c.status=true}if(c.callback){window.setTimeout(function(){c.callback(c,a)},10)}return true};FileAdaptor.prototype.generateTiddlerInfo=function(a){var b={};b.uri=a.fields["server.host"]+"#"+a.title;return b};FileAdaptor.prototype.getTiddler=function(c,b,a,d){b=this.setContext(b,a,d);b.title=c;b.complete=FileAdaptor.getTiddlerComplete;return b.adaptor.store?b.complete(b,b.userParams):loadRemoteFile(b.host,FileAdaptor.loadTiddlyWikiCallback,b)};FileAdaptor.getTiddlerComplete=function(c,a){var b=c.adaptor.store.fetchTiddler(c.title);if(b){b.fields["server.type"]=FileAdaptor.serverType;b.fields["server.host"]=AdaptorBase.minHostName(c.host);b.fields["server.page.revision"]=b.modified.convertToYYYYMMDDHHMM();c.tiddler=b;c.status=true}else{c.status=false}if(c.allowSynchronous){c.isSynchronous=true;c.callback(c,a)}else{window.setTimeout(function(){c.callback(c,a)},10)}return true};FileAdaptor.prototype.close=function(){delete this.store;this.store=null};config.adaptors[FileAdaptor.serverType]=FileAdaptor;config.defaultAdaptor=FileAdaptor.serverType;function ajaxReq(a){if(window.Components&&window.netscape&&window.netscape.security&&document.location.protocol.indexOf("http")==-1){window.netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead")}return jQuery.ajax(a)}function formatVersion(a){a=a||version;return a.major+"."+a.minor+"."+a.revision+(a.alpha?" (alpha "+a.alpha+")":"")+(a.beta?" (beta "+a.beta+")":"")}function compareVersions(g,f){var b=["major","minor","revision"];for(var e=0;e<b.length;e++){var d=g[b[e]]||0;var c=f[b[e]]||0;if(d<c){return 1}if(d>c){return -1}}d=g.beta||9999;c=f.beta||9999;if(d<c){return 1}return d>c?-1:0}function createTiddlyButton(g,h,k,d,f,b,j,a){var c=document.createElement("a");if(d){c.onclick=d;c.setAttribute("href","javascript:;")}if(k){c.setAttribute("title",k)}if(h){c.appendChild(document.createTextNode(h))}c.className=f||"button";if(b){c.id=b}if(a){for(var e in a){c.setAttribute(e,a[e])}}if(g){g.appendChild(c)}if(j){c.setAttribute("accessKey",j)}return c}function createTiddlyLink(d,h,j,g,k,c,b){var l=j?h:null;var e=getTiddlyLinkInfo(h,g);var a=k?createExternalLink(d,store.getTiddlerText("SiteUrl",null)+"#"+h):createTiddlyButton(d,l,e.subTitle,onClickTiddlerLink,e.classes);if(k){a.className+=" "+g}a.setAttribute("refresh","link");a.setAttribute("tiddlyLink",h);if(b){a.setAttribute("noToggle","true")}if(c){var f=c.getInheritedFields();if(f){a.setAttribute("tiddlyFields",f)}}return a}function refreshTiddlyLink(b,c){var a=getTiddlyLinkInfo(c,b.className);b.className=a.classes;b.title=a.subTitle}function getTiddlyLinkInfo(e,d){var b=d?d.split(" "):[];b.pushUnique("tiddlyLink");var a=store.fetchTiddler(e);var c;if(a){c=a.getSubtitle();b.pushUnique("tiddlyLinkExisting");b.remove("tiddlyLinkNonExisting");b.remove("shadow")}else{b.remove("tiddlyLinkExisting");b.pushUnique("tiddlyLinkNonExisting");if(store.isShadowTiddler(e)){c=config.messages.shadowedTiddlerToolTip.format([e]);b.pushUnique("shadow")}else{c=config.messages.undefinedTiddlerToolTip.format([e]);b.remove("shadow")}}if(typeof config.annotations[e]=="string"){c=config.annotations[e]}return{classes:b.join(" "),subTitle:c}}function createExternalLink(a,c,b){var d=document.createElement("a");d.className="externalLink";d.href=c;d.title=config.messages.externalLinkTooltip.format([c]);if(config.options.chkOpenInNewWindow){d.target="_blank"}a.appendChild(d);if(b){createTiddlyText(d,b)}return d}function onClickTiddlerLink(h){var d=h||window.event;var g=resolveTarget(d);var j=g;var k=null;var b=null;var a=null;do{k=j.getAttribute("tiddlyLink");b=j.getAttribute("tiddlyFields");a=j.getAttribute("noToggle");j=j.parentNode}while(k==null&&j!=null);if(!store.isShadowTiddler(k)){var c=b?b.decodeHashMap():{};b=String.encodeHashMap(merge(c,config.defaultCustomFields,true))}if(k){var l=d.metaKey||d.ctrlKey;if(config.options.chkToggleLinks){l=!l}if(a){l=false}if(store.getTiddler(k)){b=null}story.displayTiddler(g,k,null,true,null,b,l)}clearMessage();return false}function createTagButton(b,a,f,e,d){var c=createTiddlyButton(b,e||a,(d||config.views.wikified.tag.tooltip).format([a]),onClickTag);c.setAttribute("tag",a);if(f){c.setAttribute("tiddler",f)}return c}function onClickTag(l){var j=l||window.event;var b=Popup.create(this);addClass(b,"taggedTiddlerList");var p=this.getAttribute("tag");var m=this.getAttribute("tiddler");if(b&&p){var c=p.indexOf("[")==-1?store.getTaggedTiddlers(p):store.filterTiddlers(p);var k=this.getAttribute("sortby");if(k&&k.length){store.sortTiddlers(c,k)}var g=[];var n,a;for(a=0;a<c.length;a++){if(c[a].title!=m){g.push(c[a].title)}}var f=config.views.wikified.tag;if(g.length>0){var o=createTiddlyButton(createTiddlyElement(b,"li"),f.openAllText.format([p]),f.openAllTooltip,onClickTagOpenAll);o.setAttribute("tag",p);o.setAttribute("sortby",k);createTiddlyElement(createTiddlyElement(b,"li",null,"listBreak"),"div");for(a=0;a<g.length;a++){createTiddlyLink(createTiddlyElement(b,"li"),g[a],true)}}else{createTiddlyElement(b,"li",null,"disabled",f.popupNone.format([p]))}createTiddlyElement(createTiddlyElement(b,"li",null,"listBreak"),"div");var d=createTiddlyLink(createTiddlyElement(b,"li"),p,false);createTiddlyText(d,f.openTag.format([p]))}Popup.show();j.cancelBubble=true;if(j.stopPropagation){j.stopPropagation()}return false}function onClickTagOpenAll(b){var a=store.getTaggedTiddlers(this.getAttribute("tag"));var c=this.getAttribute("sortby");if(c&&c.length){store.sortTiddlers(a,c)}story.displayTiddlers(this,a);return false}function onClickError(d){var f=d||window.event;var b=Popup.create(this);var a=this.getAttribute("errorText").split("\n");for(var c=0;c<a.length;c++){createTiddlyElement(b,"li",null,null,a[c])}Popup.show();f.cancelBubble=true;if(f.stopPropagation){f.stopPropagation()}return false}function createTiddlyDropDown(b,d,c,a){var g=createTiddlyElement(b,"select");g.onchange=d;for(var f=0;f<c.length;f++){var h=createTiddlyElement(g,"option",null,null,c[f].caption);h.value=c[f].name;if(c[f].name==a){h.selected=true}}return g}function createTiddlyPopup(a,b,e,d){if(d.text){createTiddlyLink(a,b,true);var c=createTiddlyButton(a,glyph("downArrow"),e,onClickTiddlyPopup,"tiddlerPopupButton");c.tiddler=d}else{createTiddlyText(a,b)}}function onClickTiddlyPopup(c){var d=c||window.event;var b=this.tiddler;if(b.text){var a=Popup.create(this,"div","popupTiddler");wikify(b.text,a,null,b);Popup.show()}if(d){d.cancelBubble=true}if(d&&d.stopPropagation){d.stopPropagation()}return false}function createTiddlyError(a,d,c){var b=createTiddlyButton(a,d,null,onClickError,"errorButton");if(c){b.setAttribute("errorText",c)}}function merge(d,c,a){for(var b in c){if(!a||d[b]===undefined){d[b]=c[b]}}return d}function exceptionText(c,b){var a=c.description||c.toString();return b?"%0:\n%1".format([b,a]):a}function showException(b,a){alert(exceptionText(b,a))}function alertAndThrow(a){alert(a);throw (a)}function glyph(c){var d=config.glyphs;var a=d.currBrowser;if(a==null){a=0;while(!d.browsers[a]()&&a<d.browsers.length-1){a++}d.currBrowser=a}if(!d.codes[c]){return""}return d.codes[c][a]}if(!window.console){console={tiddlywiki:true,log:function(a){displayMessage(a)}}}function Animator(){this.running=0;this.timerID=0;this.animations=[];return this}Animator.prototype.startAnimating=function(){for(var a=0;a<arguments.length;a++){this.animations.push(arguments[a])}if(this.running==0){var b=this;this.timerID=window.setInterval(function(){b.doAnimate(b)},10)}this.running+=arguments.length};Animator.prototype.doAnimate=function(c){var b=0;while(b<c.animations.length){var d=c.animations[b];if(d.tick()){b++}else{c.animations.splice(b,1);if(--c.running==0){window.clearInterval(c.timerID)}}}};Animator.slowInSlowOut=function(a){return(1-((Math.cos(a*Math.PI)+1)/2))};function Morpher(b,c,a,d){this.element=b;this.duration=c;this.properties=a;this.startTime=new Date();this.endTime=Number(this.startTime)+c;this.callback=d;this.tick();return this}Morpher.prototype.assignStyle=function(a,b,c){switch(b){case"-tw-vertScroll":window.scrollTo(findScrollX(),c);break;case"-tw-horizScroll":window.scrollTo(c,findScrollY());break;default:a.style[b]=c;break}};Morpher.prototype.stop=function(){for(var a=0;a<this.properties.length;a++){var b=this.properties[a];if(b.atEnd!==undefined){this.assignStyle(this.element,b.style,b.atEnd)}}if(this.callback){this.callback(this.element,this.properties)}};Morpher.prototype.tick=function(){var b=Number(new Date());var c=Animator.slowInSlowOut(Math.min(1,(b-this.startTime)/this.duration));for(var d=0;d<this.properties.length;d++){var f=this.properties[d];if(f.start!==undefined&&f.end!==undefined){var e=f.template||"%0";switch(f.format){case undefined:case"style":var a=f.start+(f.end-f.start)*c;this.assignStyle(this.element,f.style,e.format([a]));break;case"color":break}}}if(b>=this.endTime){this.stop();return false}return true};function Zoomer(l,k,h,d){var g=createTiddlyElement(document.body,"div",null,"zoomer");createTiddlyElement(g,"div",null,null,l);var b=findWindowWidth();var f=findWindowHeight();var a=[{style:"left",start:findPosX(k),end:findPosX(h),template:"%0px"},{style:"top",start:findPosY(k),end:findPosY(h),template:"%0px"},{style:"width",start:Math.min(k.scrollWidth,b),end:Math.min(h.scrollWidth,b),template:"%0px",atEnd:"auto"},{style:"height",start:Math.min(k.scrollHeight,f),end:Math.min(h.scrollHeight,f),template:"%0px",atEnd:"auto"},{style:"fontSize",start:8,end:24,template:"%0pt"}];var j=function(e,c){removeNode(e)};return new Morpher(g,config.animDuration,a,j)}function Scroller(a){var b=[{style:"-tw-vertScroll",start:findScrollY(),end:ensureVisible(a)}];return new Morpher(a,config.animDuration,b)}function Slider(h,d,g,k){h.style.overflow="hidden";if(d){h.style.height="0px"}h.style.display="block";var e=findPosX(h);var b=h.scrollWidth;var l=h.scrollHeight;var f=findWindowWidth();var a=[];var j=null;if(d){a.push({style:"height",start:0,end:l,template:"%0px",atEnd:"auto"});a.push({style:"opacity",start:0,end:1,template:"%0"});a.push({style:"filter",start:0,end:100,template:"alpha(opacity:%0)"})}else{a.push({style:"height",start:l,end:0,template:"%0px"});a.push({style:"display",atEnd:"none"});a.push({style:"opacity",start:1,end:0,template:"%0"});a.push({style:"filter",start:100,end:0,template:"alpha(opacity:%0)"});switch(k){case"all":j=function(m,c){removeNode(m)};break;case"children":j=function(m,c){removeChildren(m)};break}}return new Morpher(h,config.animDuration,a,j)}var Popup={stack:[]};Popup.create=function(b,d,c){var e=this.find(b,"popup");Popup.remove(e+1);var a=createTiddlyElement(document.body,d||"ol","popup",c||"popup");a.stackPosition=e;Popup.stack.push({root:b,popup:a});return a};Popup.onDocumentClick=function(a){var b=a||window.event;if(b.eventPhase==undefined){Popup.remove()}else{if(b.eventPhase==Event.BUBBLING_PHASE||b.eventPhase==Event.AT_TARGET){Popup.remove()}}return true};Popup.show=function(a,b,d){var c=Popup.stack[Popup.stack.length-1];this.place(c.root,c.popup,a,b,d);addClass(c.root,"highlight");if(config.options.chkAnimate&&anim&&typeof Scroller=="function"){anim.startAnimating(new Scroller(c.popup))}else{window.scrollTo(0,ensureVisible(c.popup))}};Popup.place=function(h,a,k,f,d){if(!d){var d={x:0,y:0}}if(a.stackPosition>=0&&!k&&!f){d.x=d.x+h.offsetWidth}else{d.x=(f=="right")?d.x+h.offsetWidth:d.x;d.y=(k=="top")?d.y:d.y+h.offsetHeight}var b=findPosX(h);var g=findPosY(h);var m=b+d.x;var l=g+d.y;var c=findWindowWidth();if(a.offsetWidth>c*0.75){a.style.width=c*0.75+"px"}var j=a.offsetWidth;var e=c-document.body.offsetWidth;if(m+j>c-e-1){if(f=="right"){m=m-h.offsetWidth-j}else{m=c-j-e-1}}a.style.left=m+"px";a.style.top=l+"px";a.style.display="block"};Popup.find=function(b){var c=-1;for(var a=this.stack.length-1;a>=0;a--){if(isDescendant(b,this.stack[a].popup)){c=a}}return c};Popup.remove=function(a){if(!a){var a=0}if(Popup.stack.length>a){Popup.removeFrom(a)}};Popup.removeFrom=function(c){for(var a=Popup.stack.length-1;a>=c;a--){var b=Popup.stack[a];removeClass(b.root,"highlight");removeNode(b.popup)}Popup.stack=Popup.stack.slice(0,c)};function Wizard(a){if(a){this.formElem=findRelated(a,"wizard","className");this.bodyElem=findRelated(this.formElem.firstChild,"wizardBody","className","nextSibling");this.footElem=findRelated(this.formElem.firstChild,"wizardFooter","className","nextSibling")}else{this.formElem=null;this.bodyElem=null;this.footElem=null}}Wizard.prototype.setValue=function(a,b){if(this.formElem){this.formElem[a]=b}};Wizard.prototype.getValue=function(a){return this.formElem?this.formElem[a]:null};Wizard.prototype.createWizard=function(a,b){this.formElem=createTiddlyElement(a,"form",null,"wizard");createTiddlyElement(this.formElem,"h1",null,null,b);this.bodyElem=createTiddlyElement(this.formElem,"div",null,"wizardBody");this.footElem=createTiddlyElement(this.formElem,"div",null,"wizardFooter")};Wizard.prototype.clear=function(){removeChildren(this.bodyElem)};Wizard.prototype.setButtons=function(c,a){removeChildren(this.footElem);for(var b=0;b<c.length;b++){createTiddlyButton(this.footElem,c[b].caption,c[b].tooltip,c[b].onClick);insertSpacer(this.footElem)}if(typeof a=="string"){createTiddlyElement(this.footElem,"span",null,"status",a)}};Wizard.prototype.addStep=function(b,c){removeChildren(this.bodyElem);var a=createTiddlyElement(this.bodyElem,"div");createTiddlyElement(a,"h2",null,null,b);var d=createTiddlyElement(a,"div",null,"wizardStep");d.innerHTML=c;applyHtmlMacros(d,tiddler)};Wizard.prototype.getElement=function(a){return this.formElem.elements[a]};var ListView={};ListView.create=function(j,b,m,g,f){var u=createTiddlyElement(j,"table",null,f||"listView twtable");var s=createTiddlyElement(u,"thead");var n=createTiddlyElement(s,"tr");for(var l=0;l<m.columns.length;l++){var h=m.columns[l];var v=createTiddlyElement(n,"th");var q=ListView.columnTypes[h.type];if(q&&q.createHeader){q.createHeader(v,h,l);if(h.className){addClass(v,h.className)}}}var d=createTiddlyElement(u,"tbody");for(var p=0;p<b.length;p++){var k=b[p];n=createTiddlyElement(d,"tr");for(v=0;v<m.rowClasses.length;v++){if(k[m.rowClasses[v].field]){addClass(n,m.rowClasses[v].className)}}k.rowElement=n;k.colElements={};for(var o=0;o<m.columns.length;o++){v=createTiddlyElement(n,"td");h=m.columns[o];var e=h.field;q=ListView.columnTypes[h.type];if(q&&q.createItem){q.createItem(v,k,e,h,o,p);if(h.className){addClass(v,h.className)}}k.colElements[e]=v}}if(g&&m.actions){createTiddlyDropDown(j,ListView.getCommandHandler(g),m.actions)}if(g&&m.buttons){for(l=0;l<m.buttons.length;l++){var w=m.buttons[l];if(w&&w.name!=""){createTiddlyButton(j,w.caption,null,ListView.getCommandHandler(g,w.name,w.allowEmptySelection))}}}return u};ListView.getCommandHandler=function(c,a,b){return function(g){var d=findRelated(this,"TABLE",null,"previousSibling");var f=[];ListView.forEachSelector(d,function(j,h){if(j.checked){f.push(h)}});if(f.length==0&&!b){alert(config.messages.nothingSelected)}else{if(this.nodeName.toLowerCase()=="select"){c(d,this.value,f);this.selectedIndex=0}else{c(d,a,f)}}}};ListView.forEachSelector=function(b,g){var f=b.getElementsByTagName("input");var d=false;for(var c=0;c<f.length;c++){var a=f[c];if(a.getAttribute("type")=="checkbox"){var e=a.getAttribute("rowName");if(e){g(a,e);d=true}}}return d};ListView.getSelectedRows=function(a){var b=[];ListView.forEachSelector(a,function(d,c){if(d.checked){b.push(c)}});return b};ListView.columnTypes={};ListView.columnTypes.String={createHeader:function(a,b,c){createTiddlyText(a,b.title)},createItem:function(a,e,f,c,d,g){var b=e[f];if(b!=undefined){createTiddlyText(a,b)}}};ListView.columnTypes.WikiText={createHeader:ListView.columnTypes.String.createHeader,createItem:function(a,e,f,c,d,g){var b=e[f];if(b!=undefined){wikify(b,a,null,null)}}};ListView.columnTypes.Tiddler={createHeader:ListView.columnTypes.String.createHeader,createItem:function(a,e,f,c,d,g){var b=e[f];if(b!=undefined&&b.title){createTiddlyPopup(a,b.title,config.messages.listView.tiddlerTooltip,b)}}};ListView.columnTypes.Size={createHeader:ListView.columnTypes.String.createHeader,createItem:function(d,e,f,c,b,j){var a=config.messages.sizeTemplates;var g=e[f];if(g!=undefined){var h=0;while(h<a.length-1&&g<a[h].unit){h++}createTiddlyText(d,a[h].template.format([Math.round(g/a[h].unit)]))}}};ListView.columnTypes.Link={createHeader:ListView.columnTypes.String.createHeader,createItem:function(a,f,g,d,e,h){var b=f[g];var j=d.text;if(b!=undefined){createExternalLink(a,b,j||b)}}};ListView.columnTypes.Date={createHeader:ListView.columnTypes.String.createHeader,createItem:function(a,e,f,c,d,g){var b=e[f];if(b!=undefined){createTiddlyText(a,b.formatString(c.dateFormat))}}};ListView.columnTypes.StringList={createHeader:ListView.columnTypes.String.createHeader,createItem:function(a,f,g,c,d,h){var b=f[g];if(b!=undefined){for(var e=0;e<b.length;e++){createTiddlyText(a,b[e]);createTiddlyElement(a,"br")}}}};ListView.columnTypes.Selector={createHeader:function(a,b,c){createTiddlyCheckbox(a,null,false,this.onHeaderChange)},createItem:function(a,d,g,b,c,h){var f=createTiddlyCheckbox(a,null,d[g],null);f.setAttribute("rowName",d[b.rowName])},onHeaderChange:function(c){var b=this.checked;var a=findRelated(this,"TABLE");if(!a){return}ListView.forEachSelector(a,function(f,d){f.checked=b})}};ListView.columnTypes.Tags={createHeader:ListView.columnTypes.String.createHeader,createItem:function(a,e,f,b,d,g){var c=e[f];createTiddlyText(a,String.encodeTiddlyLinkList(c))}};ListView.columnTypes.Boolean={createHeader:ListView.columnTypes.String.createHeader,createItem:function(a,d,e,b,c,f){if(d[e]==true){createTiddlyText(a,b.trueText)}if(d[e]==false){createTiddlyText(a,b.falseText)}}};ListView.columnTypes.TagCheckbox={createHeader:ListView.columnTypes.String.createHeader,createItem:function(a,d,g,b,c,h){var f=createTiddlyCheckbox(a,null,d[g],this.onChange);f.setAttribute("tiddler",d.title);f.setAttribute("tag",b.tag)},onChange:function(c){var a=this.getAttribute("tag");var b=this.getAttribute("tiddler");store.setTiddlerTag(b,this.checked,a)}};ListView.columnTypes.TiddlerLink={createHeader:ListView.columnTypes.String.createHeader,createItem:function(a,f,g,c,d,h){var b=f[g];if(b!=undefined){var e=createTiddlyLink(a,f[c.tiddlerLink],false,null);createTiddlyText(e,f[g])}}};Number.prototype.clamp=function(b,a){var d=this;if(d<b){d=b}if(d>a){d=a}return Number(d)};if(!Array.indexOf){Array.prototype.indexOf=function(b,c){if(!c){c=0}for(var a=c;a<this.length;a++){if(this[a]===b){return a}}return -1}}Array.prototype.findByField=function(c,b){for(var a=0;a<this.length;a++){if(this[a][c]===b){return a}}return null};Array.prototype.contains=function(a){return this.indexOf(a)!=-1};Array.prototype.setItem=function(a,c){var b=this.indexOf(a);if(c==0){c=(b==-1)?+1:-1}if(c==+1){if(b==-1){this.push(a)}}else{if(c==-1){if(b!=-1){this.splice(b,1)}}}};Array.prototype.containsAny=function(a){for(var b=0;b<a.length;b++){if(this.indexOf(a[b])!=-1){return true}}return false};Array.prototype.containsAll=function(a){for(var b=0;b<a.length;b++){if(this.indexOf(a[b])==-1){return false}}return true};Array.prototype.pushUnique=function(a,b){if(b===false){this.push(a)}else{if(this.indexOf(a)==-1){this.push(a)}}};Array.prototype.remove=function(a){var b=this.indexOf(a);if(b!=-1){this.splice(b,1)}};if(!Array.prototype.map){Array.prototype.map=function(f,g){var e=g||window;var b=[];for(var d=0,c=this.length;d<c;++d){b.push(f.call(e,this[d],d,this))}return b}}String.prototype.right=function(a){return a<this.length?this.slice(this.length-a):this};String.prototype.trim=function(){return this.replace(/^\s*|\s*$/g,"")};String.prototype.unDash=function(){var b=this.split("-");if(b.length>1){for(var a=1;a<b.length;a++){b[a]=b[a].substr(0,1).toUpperCase()+b[a].substr(1)}}return b.join("")};String.prototype.format=function(c){var f=c&&c.constructor==Array?c:arguments;var a=/(?:%(\d+))/mg;var e=0;var d=[];do{var b=a.exec(this);if(b&&b[1]){if(b.index>e){d.push(this.substring(e,b.index))}d.push(f[parseInt(b[1])]);e=a.lastIndex}}while(b);if(e<this.length){d.push(this.substring(e,this.length))}return d.join("")};String.prototype.escapeRegExp=function(){var b="\\^$*+?()=!|,{}[].";var d=this;for(var a=0;a<b.length;a++){d=d.replace(new RegExp("\\"+b.substr(a,1),"g"),"\\"+b.substr(a,1))}return d};String.prototype.escapeLineBreaks=function(){return this.replace(/\\/mg,"\\s").replace(/\n/mg,"\\n").replace(/\r/mg,"")};String.prototype.unescapeLineBreaks=function(){return this.replace(/\\n/mg,"\n").replace(/\\b/mg," ").replace(/\\s/mg,"\\").replace(/\r/mg,"")};String.prototype.htmlEncode=function(){return this.replace(/&/mg,"&amp;").replace(/</mg,"&lt;").replace(/>/mg,"&gt;").replace(/\"/mg,"&quot;")};String.prototype.htmlDecode=function(){return this.replace(/&lt;/mg,"<").replace(/&gt;/mg,">").replace(/&quot;/mg,'"').replace(/&amp;/mg,"&")};String.prototype.parseParams=function(defaultName,defaultValue,allowEval,noNames,cascadeDefaults){var parseToken=function(match,p){var n;if(match[p]){n=match[p]}else{if(match[p+1]){n=match[p+1]}else{if(match[p+2]){n=match[p+2]}else{if(match[p+3]){try{n=match[p+3];if(allowEval){n=window.eval(n)}}catch(ex){throw"Unable to evaluate {{"+match[p+3]+"}}: "+exceptionText(ex)}}else{if(match[p+4]){n=match[p+4]}else{if(match[p+5]){n=""}}}}}}return n};var r=[{}];var dblQuote='(?:"((?:(?:\\\\")|[^"])+)")';var sngQuote="(?:'((?:(?:\\\\')|[^'])+)')";var dblSquare="(?:\\[\\[((?:\\s|\\S)*?)\\]\\])";var dblBrace="(?:\\{\\{((?:\\s|\\S)*?)\\}\\})";var unQuoted=noNames?"([^\"'\\s]\\S*)":"([^\"':\\s][^\\s:]*)";var emptyQuote="((?:\"\")|(?:''))";var skipSpace="(?:\\s*)";var token="(?:"+dblQuote+"|"+sngQuote+"|"+dblSquare+"|"+dblBrace+"|"+unQuoted+"|"+emptyQuote+")";var re=noNames?new RegExp(token,"mg"):new RegExp(skipSpace+token+skipSpace+"(?:(\\:)"+skipSpace+token+")?","mg");var params=[];do{var match=re.exec(this);if(match){var n=parseToken(match,1);if(noNames){r.push({name:"",value:n})}else{var v=parseToken(match,8);if(v==null&&defaultName){v=n;n=defaultName}else{if(v==null&&defaultValue){v=defaultValue}}r.push({name:n,value:v});if(cascadeDefaults){defaultName=n;defaultValue=v}}}}while(match);for(var t=1;t<r.length;t++){if(r[0][r[t].name]){r[0][r[t].name].push(r[t].value)}else{r[0][r[t].name]=[r[t].value]}}return r};String.prototype.readMacroParams=function(){var b=this.parseParams("list",null,true,true);var c=[];for(var a=1;a<b.length;a++){c.push(b[a].value)}return c};String.prototype.readBracketedList=function(c){var b=this.parseParams("list",null,false,true);var d=[];for(var a=1;a<b.length;a++){if(b[a].value){d.pushUnique(b[a].value,c)}}return d};String.prototype.getChunkRange=function(d,a){var b=this.indexOf(d);if(b!=-1){b+=d.length;var c=this.indexOf(a,b);if(c!=-1){return[b,c]}}};String.prototype.replaceChunk=function(d,a,b){var c=this.getChunkRange(d,a);return c?this.substring(0,c[0])+b+this.substring(c[1]):this};String.prototype.getChunk=function(c,a){var b=this.getChunkRange(c,a);if(b){return this.substring(b[0],b[1])}};String.encodeTiddlyLink=function(a){return a.indexOf(" ")==-1?a:"[["+a+"]]"};String.encodeTiddlyLinkList=function(c){if(c){var b=[];for(var a=0;a<c.length;a++){b.push(String.encodeTiddlyLink(c[a]))}return b.join(" ")}else{return""}};String.prototype.decodeHashMap=function(){var a=this.parseParams("anon","",false);var c={};for(var b=1;b<a.length;b++){c[a[b].name]=a[b].value}return c};String.encodeHashMap=function(a){var c=[];for(var b in a){c.push(b+':"'+a[b]+'"')}return c.join(" ")};String.zeroPad=function(c,b){var a=c.toString();if(a.length<b){a="000000000000000000000000000".substr(0,b-a.length)+a}return a};String.prototype.startsWith=function(a){return !a||this.substring(0,a.length)==a};function getParam(d,b,a){if(!d){return a}var c=d[0][b];return c?c[0]:a}function getFlag(c,b,a){return !!getParam(c,b,a)}Date.prototype.formatString=function(b){var a=b.replace(/0hh12/g,String.zeroPad(this.getHours12(),2));a=a.replace(/hh12/g,this.getHours12());a=a.replace(/0hh/g,String.zeroPad(this.getHours(),2));a=a.replace(/hh/g,this.getHours());a=a.replace(/mmm/g,config.messages.dates.shortMonths[this.getMonth()]);a=a.replace(/0mm/g,String.zeroPad(this.getMinutes(),2));a=a.replace(/mm/g,this.getMinutes());a=a.replace(/0ss/g,String.zeroPad(this.getSeconds(),2));a=a.replace(/ss/g,this.getSeconds());a=a.replace(/[ap]m/g,this.getAmPm().toLowerCase());a=a.replace(/[AP]M/g,this.getAmPm().toUpperCase());a=a.replace(/wYYYY/g,this.getYearForWeekNo());a=a.replace(/wYY/g,String.zeroPad(this.getYearForWeekNo()-2000,2));a=a.replace(/YYYY/g,this.getFullYear());a=a.replace(/YY/g,String.zeroPad(this.getFullYear()-2000,2));a=a.replace(/MMM/g,config.messages.dates.months[this.getMonth()]);a=a.replace(/0MM/g,String.zeroPad(this.getMonth()+1,2));a=a.replace(/MM/g,this.getMonth()+1);a=a.replace(/0WW/g,String.zeroPad(this.getWeek(),2));a=a.replace(/WW/g,this.getWeek());a=a.replace(/DDD/g,config.messages.dates.days[this.getDay()]);a=a.replace(/ddd/g,config.messages.dates.shortDays[this.getDay()]);a=a.replace(/0DD/g,String.zeroPad(this.getDate(),2));a=a.replace(/DDth/g,this.getDate()+this.daySuffix());a=a.replace(/DD/g,this.getDate());var d=this.getTimezoneOffset();var c=Math.abs(d);a=a.replace(/TZD/g,(d<0?"+":"-")+String.zeroPad(Math.floor(c/60),2)+":"+String.zeroPad(c%60,2));a=a.replace(/\\/g,"");return a};Date.prototype.getWeek=function(){var a=new Date(this.getTime());var b=a.getDay();if(b==0){b=7}a.setTime(a.getTime()+(4-b)*86400000);var c=Math.floor((a.getTime()-new Date(a.getFullYear(),0,1)+3600000)/86400000);return Math.floor(c/7)+1};Date.prototype.getYearForWeekNo=function(){var a=new Date(this.getTime());var b=a.getDay();if(b==0){b=7}a.setTime(a.getTime()+(4-b)*86400000);return a.getFullYear()};Date.prototype.getHours12=function(){var a=this.getHours();return a>12?a-12:(a>0?a:12)};Date.prototype.getAmPm=function(){return this.getHours()>=12?config.messages.dates.pm:config.messages.dates.am};Date.prototype.daySuffix=function(){return config.messages.dates.daySuffixes[this.getDate()-1]};Date.prototype.convertToLocalYYYYMMDDHHMM=function(){return this.getFullYear()+String.zeroPad(this.getMonth()+1,2)+String.zeroPad(this.getDate(),2)+String.zeroPad(this.getHours(),2)+String.zeroPad(this.getMinutes(),2)};Date.prototype.convertToYYYYMMDDHHMM=function(){return this.getUTCFullYear()+String.zeroPad(this.getUTCMonth()+1,2)+String.zeroPad(this.getUTCDate(),2)+String.zeroPad(this.getUTCHours(),2)+String.zeroPad(this.getUTCMinutes(),2)};Date.prototype.convertToYYYYMMDDHHMMSSMMM=function(){return this.getUTCFullYear()+String.zeroPad(this.getUTCMonth()+1,2)+String.zeroPad(this.getUTCDate(),2)+"."+String.zeroPad(this.getUTCHours(),2)+String.zeroPad(this.getUTCMinutes(),2)+String.zeroPad(this.getUTCSeconds(),2)+String.zeroPad(this.getUTCMilliseconds(),3)+"0"};Date.convertFromYYYYMMDDHHMM=function(a){a=a?a.replace(/[^0-9]/g,""):"";return Date.convertFromYYYYMMDDHHMMSSMMM(a.substr(0,12))};Date.convertFromYYYYMMDDHHMMSS=function(a){a=a?a.replace(/[^0-9]/g,""):"";return Date.convertFromYYYYMMDDHHMMSSMMM(a.substr(0,14))};Date.convertFromYYYYMMDDHHMMSSMMM=function(a){a=a?a.replace(/[^0-9]/g,""):"";return new Date(Date.UTC(parseInt(a.substr(0,4),10),parseInt(a.substr(4,2),10)-1,parseInt(a.substr(6,2),10),parseInt(a.substr(8,2)||"00",10),parseInt(a.substr(10,2)||"00",10),parseInt(a.substr(12,2)||"00",10),parseInt(a.substr(14,3)||"000",10)))};function RGB(f,e,a){this.r=0;this.g=0;this.b=0;if(typeof f=="string"){if(f.substr(0,1)=="#"){if(f.length==7){this.r=parseInt(f.substr(1,2),16)/255;this.g=parseInt(f.substr(3,2),16)/255;this.b=parseInt(f.substr(5,2),16)/255}else{this.r=parseInt(f.substr(1,1),16)/15;this.g=parseInt(f.substr(2,1),16)/15;this.b=parseInt(f.substr(3,1),16)/15}}else{var d=/rgb\s*\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)/;var h=f.match(d);if(h){this.r=parseInt(h[1],10)/255;this.g=parseInt(h[2],10)/255;this.b=parseInt(h[3],10)/255}}}else{this.r=f;this.g=e;this.b=a}return this}RGB.prototype.mix=function(b,a){return new RGB(this.r+(b.r-this.r)*a,this.g+(b.g-this.g)*a,this.b+(b.b-this.b)*a)};RGB.prototype.toString=function(){return"#"+("0"+Math.floor(this.r.clamp(0,1)*255).toString(16)).right(2)+("0"+Math.floor(this.g.clamp(0,1)*255).toString(16)).right(2)+("0"+Math.floor(this.b.clamp(0,1)*255).toString(16)).right(2)};function resolveTarget(b){var a;if(b.target){a=b.target}else{if(b.srcElement){a=b.srcElement}}if(a.nodeType==3){a=a.parentNode}return a}function drawGradient(c,h,g,d){if(!d){d=g}for(var j=0;j<=100;j+=2){var f=document.createElement("div");c.appendChild(f);f.style.position="absolute";f.style.left=h?j+"%":0;f.style.top=h?0:j+"%";f.style.width=h?(101-j)+"%":"100%";f.style.height=h?"100%":(101-j)+"%";f.style.zIndex=-1;var b=j/100*(g.length-1);var e=d[Math.floor(b)];if(typeof e=="string"){e=new RGB(e)}var a=g[Math.ceil(b)];if(typeof a=="string"){a=new RGB(a)}f.style.backgroundColor=e.mix(a,b-Math.floor(b)).toString()}}function createTiddlyText(a,b){return a.appendChild(document.createTextNode(b))}function createTiddlyCheckbox(d,c,e,b){var a=document.createElement("input");a.setAttribute("type","checkbox");a.onclick=b;d.appendChild(a);a.checked=e;a.className="chkOptionInput";if(c){wikify(c,d)}return a}function createTiddlyElement(c,a,j,b,g,f){var d=document.createElement(a);if(b!=null){d.className=b}if(j!=null){d.setAttribute("id",j)}if(g!=null){d.appendChild(document.createTextNode(g))}if(f){for(var h in f){d.setAttribute(h,f[h])}}if(c!=null){c.appendChild(d)}return d}function addEvent(c,b,a){if(c.attachEvent){c["e"+b+a]=a;c[b+a]=function(){c["e"+b+a](window.event)};c.attachEvent("on"+b,c[b+a])}else{c.addEventListener(b,a,false)}}function removeEvent(c,b,a){if(c.detachEvent){c.detachEvent("on"+b,c[b+a]);c[b+a]=null}else{c.removeEventListener(b,a,false)}}function findRelated(d,c,a,b){a=a||"tagName";b=b||"parentNode";if(a=="className"){while(d&&!hasClass(d,c)){d=d[b]}}else{while(d&&d[a]!=c){d=d[b]}}return d}function ensureVisible(g){var d=findPosY(g);var f=d+g.offsetHeight;var a=findScrollY();var b=findWindowHeight();var c=a+b;if(d<a){return d}else{if(f>c){if(g.offsetHeight<b){return d-(b-g.offsetHeight)}else{return d}}else{return a}}}function findWindowWidth(){return window.innerWidth||document.documentElement.clientWidth}function findWindowHeight(){return window.innerHeight||document.documentElement.clientHeight}function findScrollX(){return window.scrollX||document.documentElement.scrollLeft}function findScrollY(){return window.scrollY||document.documentElement.scrollTop}function findPosX(a){var b=0;while(a.offsetParent){b+=a.offsetLeft;a=a.offsetParent}return b}function findPosY(b){var a=0;while(b.offsetParent){a+=b.offsetTop;b=b.offsetParent}return a}function blurElement(a){if(a&&a.focus&&a.blur){a.focus();a.blur()}}function insertSpacer(a){var b=document.createTextNode(String.fromCharCode(160));if(a){a.appendChild(b)}return b}function forceReflow(){if(config.browser.isGecko){setStylesheet("body {top:0px;margin-top:0px;}","forceReflow");setTimeout(function(){setStylesheet("","forceReflow")},1)}}function replaceSelection(h,j){if(h.setSelectionRange){var g=h.selectionStart;var d=h.selectionEnd>h.selectionStart;h.value=h.value.substr(0,h.selectionStart)+j+h.value.substr(h.selectionEnd);h.setSelectionRange(d?g:g+j.length,g+j.length);var f=h.value.split("\n").length;var c=h.value.substr(0,h.selectionStart).split("\n").length-1;h.scrollTop=Math.floor((c-h.rows/2)*h.scrollHeight/f)}else{if(document.selection){var b=document.selection.createRange();if(b.parentElement()==h){var a=b.text=="";b.text=j;if(!a){b.moveStart("character",-j.length);b.select()}}}}}function getNodeText(b){var a="";while(b&&b.nodeName=="#text"){a+=b.nodeValue;b=b.nextSibling}return a}function isDescendant(b,a){while(b){if(b===a){return true}b=b.parentNode}return false}function stopEvent(b){var a=b||window.event;a.cancelBubble=true;if(a.stopPropagation){a.stopPropagation()}return false}function scrubNode(f){if(!config.browser.isIE){return}var a=f.attributes;if(a){for(var d=0;d<a.length;d++){var h=a[d].name;if(h!=="style"&&(typeof f[h]==="function"||(typeof f[h]==="object"&&f[h]!=null))){try{f[h]=null}catch(b){}}}}var g=f.firstChild;while(g){scrubNode(g);g=g.nextSibling}}function addClass(b,a){jQuery(b).addClass(a)}function removeClass(b,a){jQuery(b).removeClass(a)}function hasClass(b,a){return jQuery(b).hasClass(a)}function removeChildren(a){jQuery(a).empty()}function getPlainText(a){return jQuery(a).text()}function removeNode(a){jQuery(a).remove()}function LoaderBase(){}LoaderBase.prototype.loadTiddler=function(a,d,c){var e=this.getTitle(a,d);if(safeMode&&a.isShadowTiddler(e)){return}if(e){var b=a.createTiddler(e);this.internalizeTiddler(a,b,e,d);c.push(b)}};LoaderBase.prototype.loadTiddlers=function(b,a){var e=[];for(var d=0;d<a.length;d++){try{this.loadTiddler(b,a[d],e)}catch(c){showException(c,config.messages.tiddlerLoadError.format([this.getTitle(b,a[d])]))}}return e};function SaverBase(){}SaverBase.prototype.externalize=function(a){var c=[];var d=a.getTiddlers("title");for(var b=0;b<d.length;b++){if(!d[b].doNotSave()){c.push(this.externalizeTiddler(a,d[b]))}}return c.join("\n")};function TW21Loader(){}TW21Loader.prototype=new LoaderBase();TW21Loader.prototype.getTitle=function(a,c){var d=null;if(c.getAttribute){d=c.getAttribute("title");if(!d){d=c.getAttribute("tiddler")}}if(!d&&c.id){var b=a.idPrefix.length;if(c.id.substr(0,b)==a.idPrefix){d=c.id.substr(b)}}return d};TW21Loader.prototype.internalizeTiddler=function(q,p,o,d){var l=d.firstChild;var t=null;if(d.getAttribute("tiddler")){t=getNodeText(l).unescapeLineBreaks()}else{while(l.nodeName!="PRE"&&l.nodeName!="pre"){l=l.nextSibling}t=l.innerHTML.replace(/\r/mg,"").htmlDecode()}var f=d.getAttribute("creator");var g=d.getAttribute("modifier");var n=d.getAttribute("created");var b=d.getAttribute("modified");var h=n?Date.convertFromYYYYMMDDHHMMSS(n):version.date;var s=b?Date.convertFromYYYYMMDDHHMMSS(b):h;var u=d.getAttribute("tags");var k={};var r=d.attributes;for(var j=r.length-1;j>=0;j--){var a=r[j].name;if(r[j].specified&&!TiddlyWiki.isStandardField(a)){k[a]=r[j].value.unescapeLineBreaks()}}p.assign(o,t,g,s,u,h,k,f);return p};function TW21Saver(){}TW21Saver.prototype=new SaverBase();TW21Saver.prototype.externalizeTiddler=function(f,e){try{var a="";var h=config.options.chkUsePreForStorage;f.forEachField(e,function(k,m,l){if(typeof l!="string"){l=""}if(!m.match(/^temp\./)){a+=' %0="%1"'.format([m,l.escapeLineBreaks().htmlEncode()])}},true);var b=e.created;var g=e.modified;var c=e.creator?' creator="'+e.creator.htmlEncode()+'"':"";c+=e.modifier?' modifier="'+e.modifier.htmlEncode()+'"':"";c+=(h&&b==version.date)?"":' created="'+b.convertToYYYYMMDDHHMM()+'"';c+=(h&&g==b)?"":' modified="'+g.convertToYYYYMMDDHHMM()+'"';var j=e.getTags();if(!h||j){c+=' tags="'+j.htmlEncode()+'"'}return('<div %0="%1"%2%3>%4</div>').format([h?"title":"tiddler",e.title.htmlEncode(),c,a,h?"\n<pre>"+e.text.htmlEncode()+"</pre>\n":e.text.escapeLineBreaks().htmlEncode()])}catch(d){throw exceptionText(d,config.messages.tiddlerSaveError.format([e.title]))}};//]]>
</script>
<script id="jsdeprecatedArea" type="text/javascript">
//<![CDATA[
function Crypto(){}Crypto.strToBe32s=function(a){return jQuery.encoding.strToBe32s(a)};Crypto.be32sToStr=function(a){return jQuery.encoding.be32sToStr(a)};Crypto.be32sToHex=function(a){return jQuery.encoding.be32sToHex(a)};Crypto.hexSha1Str=function(a){return jQuery.encoding.digests.hexSha1Str(a)};Crypto.sha1Str=function(a){return jQuery.encoding.digests.sha1Str(a)};Crypto.sha1=function(a,b){return jQuery.encoding.digests.sha1(a,b)};function setStylesheet(a,c,b){jQuery.twStylesheet(a,{id:c,doc:b})}function removeStyleSheet(a){jQuery.twStylesheet.remove({id:a})}function loadRemoteFile(a,c,b){return httpReq("GET",a,c,b)}function doHttp(f,a,e,h,d,i,j,c,b,g){return httpReq(f,a,j,c,b,e,h,d,i,g)}function httpReq(f,a,j,c,b,e,i,d,h,g){var k={type:f,url:a,processData:false,data:e,cache:!!g,beforeSend:function(m){for(var l in b){m.setRequestHeader(l,b[l])}m.setRequestHeader("X-Requested-With","TiddlyWiki "+formatVersion())}};if(j){k.complete=function(l,m){if(jQuery.httpSuccess(l)){j(true,c,l.responseText,a,l)}else{j(false,c,null,a,l)}}}if(i){k.contentType=i}if(d){k.username=d}if(h){k.password=h}if(window.Components&&window.netscape&&window.netscape.security&&document.location.protocol.indexOf("http")==-1){window.netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead")}return jQuery.ajax(k)}String.prototype.toJSONString=function(){var a={"\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t",'"':'\\"',"\\":"\\\\"};var b=function(e,d){var f=a[d];if(f){return f}f=d.charCodeAt();return"\\u00"+Math.floor(f/16).toString(16)+(f%16).toString(16)};if(/["\\\x00-\x1f]/.test(this)){return'"'+this.replace(/([\x00-\x1f\\"])/g,b)+'"'}return'"'+this+'"'};Tiddler.prototype.toRssItem=function(a){return tiddlerToRssItem(this,a)};Tiddler.prototype.saveToRss=function(a){return"<item>\n"+tiddlerToRssItem(this,a)+"\n</item>"};Tiddler.prototype.generateFingerprint=function(){return"0x"+Crypto.hexSha1Str(this.text)};//]]>
</script>
<script id="jslibArea" type="text/javascript">
//<![CDATA[
/*!
 * jQuery JavaScript Library v1.4.2
 * http://jquery.com/
 *
 * Copyright 2010, John Resig
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 * Copyright 2010, The Dojo Foundation
 * Released under the MIT, BSD, and GPL Licenses.
 *
 * Date: Sat Feb 13 22:33:48 2010 -0500
 */
(function(A,w){function ma(){if(!c.isReady){try{s.documentElement.doScroll("left")}catch(a){setTimeout(ma,1);return}c.ready()}}function Qa(a,b){b.src?c.ajax({url:b.src,async:false,dataType:"script"}):c.globalEval(b.text||b.textContent||b.innerHTML||"");b.parentNode&&b.parentNode.removeChild(b)}function X(a,b,d,f,e,j){var i=a.length;if(typeof b==="object"){for(var o in b)X(a,o,b[o],f,e,d);return a}if(d!==w){f=!j&&f&&c.isFunction(d);for(o=0;o<i;o++)e(a[o],b,f?d.call(a[o],o,e(a[o],b)):d,j);return a}return i?
e(a[0],b):w}function J(){return(new Date).getTime()}function Y(){return false}function Z(){return true}function na(a,b,d){d[0].type=a;return c.event.handle.apply(b,d)}function oa(a){var b,d=[],f=[],e=arguments,j,i,o,k,n,r;i=c.data(this,"events");if(!(a.liveFired===this||!i||!i.live||a.button&&a.type==="click")){a.liveFired=this;var u=i.live.slice(0);for(k=0;k<u.length;k++){i=u[k];i.origType.replace(O,"")===a.type?f.push(i.selector):u.splice(k--,1)}j=c(a.target).closest(f,a.currentTarget);n=0;for(r=
j.length;n<r;n++)for(k=0;k<u.length;k++){i=u[k];if(j[n].selector===i.selector){o=j[n].elem;f=null;if(i.preType==="mouseenter"||i.preType==="mouseleave")f=c(a.relatedTarget).closest(i.selector)[0];if(!f||f!==o)d.push({elem:o,handleObj:i})}}n=0;for(r=d.length;n<r;n++){j=d[n];a.currentTarget=j.elem;a.data=j.handleObj.data;a.handleObj=j.handleObj;if(j.handleObj.origHandler.apply(j.elem,e)===false){b=false;break}}return b}}function pa(a,b){return"live."+(a&&a!=="*"?a+".":"")+b.replace(/\./g,"`").replace(/ /g,
"&")}function qa(a){return!a||!a.parentNode||a.parentNode.nodeType===11}function ra(a,b){var d=0;b.each(function(){if(this.nodeName===(a[d]&&a[d].nodeName)){var f=c.data(a[d++]),e=c.data(this,f);if(f=f&&f.events){delete e.handle;e.events={};for(var j in f)for(var i in f[j])c.event.add(this,j,f[j][i],f[j][i].data)}}})}function sa(a,b,d){var f,e,j;b=b&&b[0]?b[0].ownerDocument||b[0]:s;if(a.length===1&&typeof a[0]==="string"&&a[0].length<512&&b===s&&!ta.test(a[0])&&(c.support.checkClone||!ua.test(a[0]))){e=
true;if(j=c.fragments[a[0]])if(j!==1)f=j}if(!f){f=b.createDocumentFragment();c.clean(a,b,f,d)}if(e)c.fragments[a[0]]=j?f:1;return{fragment:f,cacheable:e}}function K(a,b){var d={};c.each(va.concat.apply([],va.slice(0,b)),function(){d[this]=a});return d}function wa(a){return"scrollTo"in a&&a.document?a:a.nodeType===9?a.defaultView||a.parentWindow:false}var c=function(a,b){return new c.fn.init(a,b)},Ra=A.jQuery,Sa=A.$,s=A.document,T,Ta=/^[^<]*(<[\w\W]+>)[^>]*$|^#([\w-]+)$/,Ua=/^.[^:#\[\.,]*$/,Va=/\S/,
Wa=/^(\s|\u00A0)+|(\s|\u00A0)+$/g,Xa=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,P=navigator.userAgent,xa=false,Q=[],L,$=Object.prototype.toString,aa=Object.prototype.hasOwnProperty,ba=Array.prototype.push,R=Array.prototype.slice,ya=Array.prototype.indexOf;c.fn=c.prototype={init:function(a,b){var d,f;if(!a)return this;if(a.nodeType){this.context=this[0]=a;this.length=1;return this}if(a==="body"&&!b){this.context=s;this[0]=s.body;this.selector="body";this.length=1;return this}if(typeof a==="string")if((d=Ta.exec(a))&&
(d[1]||!b))if(d[1]){f=b?b.ownerDocument||b:s;if(a=Xa.exec(a))if(c.isPlainObject(b)){a=[s.createElement(a[1])];c.fn.attr.call(a,b,true)}else a=[f.createElement(a[1])];else{a=sa([d[1]],[f]);a=(a.cacheable?a.fragment.cloneNode(true):a.fragment).childNodes}return c.merge(this,a)}else{if(b=s.getElementById(d[2])){if(b.id!==d[2])return T.find(a);this.length=1;this[0]=b}this.context=s;this.selector=a;return this}else if(!b&&/^\w+$/.test(a)){this.selector=a;this.context=s;a=s.getElementsByTagName(a);return c.merge(this,
a)}else return!b||b.jquery?(b||T).find(a):c(b).find(a);else if(c.isFunction(a))return T.ready(a);if(a.selector!==w){this.selector=a.selector;this.context=a.context}return c.makeArray(a,this)},selector:"",jquery:"1.4.2",length:0,size:function(){return this.length},toArray:function(){return R.call(this,0)},get:function(a){return a==null?this.toArray():a<0?this.slice(a)[0]:this[a]},pushStack:function(a,b,d){var f=c();c.isArray(a)?ba.apply(f,a):c.merge(f,a);f.prevObject=this;f.context=this.context;if(b===
"find")f.selector=this.selector+(this.selector?" ":"")+d;else if(b)f.selector=this.selector+"."+b+"("+d+")";return f},each:function(a,b){return c.each(this,a,b)},ready:function(a){c.bindReady();if(c.isReady)a.call(s,c);else Q&&Q.push(a);return this},eq:function(a){return a===-1?this.slice(a):this.slice(a,+a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(R.apply(this,arguments),"slice",R.call(arguments).join(","))},map:function(a){return this.pushStack(c.map(this,
function(b,d){return a.call(b,d,b)}))},end:function(){return this.prevObject||c(null)},push:ba,sort:[].sort,splice:[].splice};c.fn.init.prototype=c.fn;c.extend=c.fn.extend=function(){var a=arguments[0]||{},b=1,d=arguments.length,f=false,e,j,i,o;if(typeof a==="boolean"){f=a;a=arguments[1]||{};b=2}if(typeof a!=="object"&&!c.isFunction(a))a={};if(d===b){a=this;--b}for(;b<d;b++)if((e=arguments[b])!=null)for(j in e){i=a[j];o=e[j];if(a!==o)if(f&&o&&(c.isPlainObject(o)||c.isArray(o))){i=i&&(c.isPlainObject(i)||
c.isArray(i))?i:c.isArray(o)?[]:{};a[j]=c.extend(f,i,o)}else if(o!==w)a[j]=o}return a};c.extend({noConflict:function(a){A.$=Sa;if(a)A.jQuery=Ra;return c},isReady:false,ready:function(){if(!c.isReady){if(!s.body)return setTimeout(c.ready,13);c.isReady=true;if(Q){for(var a,b=0;a=Q[b++];)a.call(s,c);Q=null}c.fn.triggerHandler&&c(s).triggerHandler("ready")}},bindReady:function(){if(!xa){xa=true;if(s.readyState==="complete")return c.ready();if(s.addEventListener){s.addEventListener("DOMContentLoaded",
L,false);A.addEventListener("load",c.ready,false)}else if(s.attachEvent){s.attachEvent("onreadystatechange",L);A.attachEvent("onload",c.ready);var a=false;try{a=A.frameElement==null}catch(b){}s.documentElement.doScroll&&a&&ma()}}},isFunction:function(a){return $.call(a)==="[object Function]"},isArray:function(a){return $.call(a)==="[object Array]"},isPlainObject:function(a){if(!a||$.call(a)!=="[object Object]"||a.nodeType||a.setInterval)return false;if(a.constructor&&!aa.call(a,"constructor")&&!aa.call(a.constructor.prototype,
"isPrototypeOf"))return false;var b;for(b in a);return b===w||aa.call(a,b)},isEmptyObject:function(a){for(var b in a)return false;return true},error:function(a){throw a;},parseJSON:function(a){if(typeof a!=="string"||!a)return null;a=c.trim(a);if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return A.JSON&&A.JSON.parse?A.JSON.parse(a):(new Function("return "+
a))();else c.error("Invalid JSON: "+a)},noop:function(){},globalEval:function(a){if(a&&Va.test(a)){var b=s.getElementsByTagName("head")[0]||s.documentElement,d=s.createElement("script");d.type="text/javascript";if(c.support.scriptEval)d.appendChild(s.createTextNode(a));else d.text=a;b.insertBefore(d,b.firstChild);b.removeChild(d)}},nodeName:function(a,b){return a.nodeName&&a.nodeName.toUpperCase()===b.toUpperCase()},each:function(a,b,d){var f,e=0,j=a.length,i=j===w||c.isFunction(a);if(d)if(i)for(f in a){if(b.apply(a[f],
d)===false)break}else for(;e<j;){if(b.apply(a[e++],d)===false)break}else if(i)for(f in a){if(b.call(a[f],f,a[f])===false)break}else for(d=a[0];e<j&&b.call(d,e,d)!==false;d=a[++e]);return a},trim:function(a){return(a||"").replace(Wa,"")},makeArray:function(a,b){b=b||[];if(a!=null)a.length==null||typeof a==="string"||c.isFunction(a)||typeof a!=="function"&&a.setInterval?ba.call(b,a):c.merge(b,a);return b},inArray:function(a,b){if(b.indexOf)return b.indexOf(a);for(var d=0,f=b.length;d<f;d++)if(b[d]===
a)return d;return-1},merge:function(a,b){var d=a.length,f=0;if(typeof b.length==="number")for(var e=b.length;f<e;f++)a[d++]=b[f];else for(;b[f]!==w;)a[d++]=b[f++];a.length=d;return a},grep:function(a,b,d){for(var f=[],e=0,j=a.length;e<j;e++)!d!==!b(a[e],e)&&f.push(a[e]);return f},map:function(a,b,d){for(var f=[],e,j=0,i=a.length;j<i;j++){e=b(a[j],j,d);if(e!=null)f[f.length]=e}return f.concat.apply([],f)},guid:1,proxy:function(a,b,d){if(arguments.length===2)if(typeof b==="string"){d=a;a=d[b];b=w}else if(b&&
!c.isFunction(b)){d=b;b=w}if(!b&&a)b=function(){return a.apply(d||this,arguments)};if(a)b.guid=a.guid=a.guid||b.guid||c.guid++;return b},uaMatch:function(a){a=a.toLowerCase();a=/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version)?[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||!/compatible/.test(a)&&/(mozilla)(?:.*? rv:([\w.]+))?/.exec(a)||[];return{browser:a[1]||"",version:a[2]||"0"}},browser:{}});P=c.uaMatch(P);if(P.browser){c.browser[P.browser]=true;c.browser.version=P.version}if(c.browser.webkit)c.browser.safari=
true;if(ya)c.inArray=function(a,b){return ya.call(b,a)};T=c(s);if(s.addEventListener)L=function(){s.removeEventListener("DOMContentLoaded",L,false);c.ready()};else if(s.attachEvent)L=function(){if(s.readyState==="complete"){s.detachEvent("onreadystatechange",L);c.ready()}};(function(){c.support={};var a=s.documentElement,b=s.createElement("script"),d=s.createElement("div"),f="script"+J();d.style.display="none";d.innerHTML="   <link/><table></table><a href='/a' style='color:red;float:left;opacity:.55;'>a</a><input type='checkbox'/>";
var e=d.getElementsByTagName("*"),j=d.getElementsByTagName("a")[0];if(!(!e||!e.length||!j)){c.support={leadingWhitespace:d.firstChild.nodeType===3,tbody:!d.getElementsByTagName("tbody").length,htmlSerialize:!!d.getElementsByTagName("link").length,style:/red/.test(j.getAttribute("style")),hrefNormalized:j.getAttribute("href")==="/a",opacity:/^0.55$/.test(j.style.opacity),cssFloat:!!j.style.cssFloat,checkOn:d.getElementsByTagName("input")[0].value==="on",optSelected:s.createElement("select").appendChild(s.createElement("option")).selected,
parentNode:d.removeChild(d.appendChild(s.createElement("div"))).parentNode===null,deleteExpando:true,checkClone:false,scriptEval:false,noCloneEvent:true,boxModel:null};b.type="text/javascript";try{b.appendChild(s.createTextNode("window."+f+"=1;"))}catch(i){}a.insertBefore(b,a.firstChild);if(A[f]){c.support.scriptEval=true;delete A[f]}try{delete b.test}catch(o){c.support.deleteExpando=false}a.removeChild(b);if(d.attachEvent&&d.fireEvent){d.attachEvent("onclick",function k(){c.support.noCloneEvent=
false;d.detachEvent("onclick",k)});d.cloneNode(true).fireEvent("onclick")}d=s.createElement("div");d.innerHTML="<input type='radio' name='radiotest' checked='checked'/>";a=s.createDocumentFragment();a.appendChild(d.firstChild);c.support.checkClone=a.cloneNode(true).cloneNode(true).lastChild.checked;c(function(){var k=s.createElement("div");k.style.width=k.style.paddingLeft="1px";s.body.appendChild(k);c.boxModel=c.support.boxModel=k.offsetWidth===2;s.body.removeChild(k).style.display="none"});a=function(k){var n=
s.createElement("div");k="on"+k;var r=k in n;if(!r){n.setAttribute(k,"return;");r=typeof n[k]==="function"}return r};c.support.submitBubbles=a("submit");c.support.changeBubbles=a("change");a=b=d=e=j=null}})();c.props={"for":"htmlFor","class":"className",readonly:"readOnly",maxlength:"maxLength",cellspacing:"cellSpacing",rowspan:"rowSpan",colspan:"colSpan",tabindex:"tabIndex",usemap:"useMap",frameborder:"frameBorder"};var G="jQuery"+J(),Ya=0,za={};c.extend({cache:{},expando:G,noData:{embed:true,object:true,
applet:true},data:function(a,b,d){if(!(a.nodeName&&c.noData[a.nodeName.toLowerCase()])){a=a==A?za:a;var f=a[G],e=c.cache;if(!f&&typeof b==="string"&&d===w)return null;f||(f=++Ya);if(typeof b==="object"){a[G]=f;e[f]=c.extend(true,{},b)}else if(!e[f]){a[G]=f;e[f]={}}a=e[f];if(d!==w)a[b]=d;return typeof b==="string"?a[b]:a}},removeData:function(a,b){if(!(a.nodeName&&c.noData[a.nodeName.toLowerCase()])){a=a==A?za:a;var d=a[G],f=c.cache,e=f[d];if(b){if(e){delete e[b];c.isEmptyObject(e)&&c.removeData(a)}}else{if(c.support.deleteExpando)delete a[c.expando];
else a.removeAttribute&&a.removeAttribute(c.expando);delete f[d]}}}});c.fn.extend({data:function(a,b){if(typeof a==="undefined"&&this.length)return c.data(this[0]);else if(typeof a==="object")return this.each(function(){c.data(this,a)});var d=a.split(".");d[1]=d[1]?"."+d[1]:"";if(b===w){var f=this.triggerHandler("getData"+d[1]+"!",[d[0]]);if(f===w&&this.length)f=c.data(this[0],a);return f===w&&d[1]?this.data(d[0]):f}else return this.trigger("setData"+d[1]+"!",[d[0],b]).each(function(){c.data(this,
a,b)})},removeData:function(a){return this.each(function(){c.removeData(this,a)})}});c.extend({queue:function(a,b,d){if(a){b=(b||"fx")+"queue";var f=c.data(a,b);if(!d)return f||[];if(!f||c.isArray(d))f=c.data(a,b,c.makeArray(d));else f.push(d);return f}},dequeue:function(a,b){b=b||"fx";var d=c.queue(a,b),f=d.shift();if(f==="inprogress")f=d.shift();if(f){b==="fx"&&d.unshift("inprogress");f.call(a,function(){c.dequeue(a,b)})}}});c.fn.extend({queue:function(a,b){if(typeof a!=="string"){b=a;a="fx"}if(b===
w)return c.queue(this[0],a);return this.each(function(){var d=c.queue(this,a,b);a==="fx"&&d[0]!=="inprogress"&&c.dequeue(this,a)})},dequeue:function(a){return this.each(function(){c.dequeue(this,a)})},delay:function(a,b){a=c.fx?c.fx.speeds[a]||a:a;b=b||"fx";return this.queue(b,function(){var d=this;setTimeout(function(){c.dequeue(d,b)},a)})},clearQueue:function(a){return this.queue(a||"fx",[])}});var Aa=/[\n\t]/g,ca=/\s+/,Za=/\r/g,$a=/href|src|style/,ab=/(button|input)/i,bb=/(button|input|object|select|textarea)/i,
cb=/^(a|area)$/i,Ba=/radio|checkbox/;c.fn.extend({attr:function(a,b){return X(this,a,b,true,c.attr)},removeAttr:function(a){return this.each(function(){c.attr(this,a,"");this.nodeType===1&&this.removeAttribute(a)})},addClass:function(a){if(c.isFunction(a))return this.each(function(n){var r=c(this);r.addClass(a.call(this,n,r.attr("class")))});if(a&&typeof a==="string")for(var b=(a||"").split(ca),d=0,f=this.length;d<f;d++){var e=this[d];if(e.nodeType===1)if(e.className){for(var j=" "+e.className+" ",
i=e.className,o=0,k=b.length;o<k;o++)if(j.indexOf(" "+b[o]+" ")<0)i+=" "+b[o];e.className=c.trim(i)}else e.className=a}return this},removeClass:function(a){if(c.isFunction(a))return this.each(function(k){var n=c(this);n.removeClass(a.call(this,k,n.attr("class")))});if(a&&typeof a==="string"||a===w)for(var b=(a||"").split(ca),d=0,f=this.length;d<f;d++){var e=this[d];if(e.nodeType===1&&e.className)if(a){for(var j=(" "+e.className+" ").replace(Aa," "),i=0,o=b.length;i<o;i++)j=j.replace(" "+b[i]+" ",
" ");e.className=c.trim(j)}else e.className=""}return this},toggleClass:function(a,b){var d=typeof a,f=typeof b==="boolean";if(c.isFunction(a))return this.each(function(e){var j=c(this);j.toggleClass(a.call(this,e,j.attr("class"),b),b)});return this.each(function(){if(d==="string")for(var e,j=0,i=c(this),o=b,k=a.split(ca);e=k[j++];){o=f?o:!i.hasClass(e);i[o?"addClass":"removeClass"](e)}else if(d==="undefined"||d==="boolean"){this.className&&c.data(this,"__className__",this.className);this.className=
this.className||a===false?"":c.data(this,"__className__")||""}})},hasClass:function(a){a=" "+a+" ";for(var b=0,d=this.length;b<d;b++)if((" "+this[b].className+" ").replace(Aa," ").indexOf(a)>-1)return true;return false},val:function(a){if(a===w){var b=this[0];if(b){if(c.nodeName(b,"option"))return(b.attributes.value||{}).specified?b.value:b.text;if(c.nodeName(b,"select")){var d=b.selectedIndex,f=[],e=b.options;b=b.type==="select-one";if(d<0)return null;var j=b?d:0;for(d=b?d+1:e.length;j<d;j++){var i=
e[j];if(i.selected){a=c(i).val();if(b)return a;f.push(a)}}return f}if(Ba.test(b.type)&&!c.support.checkOn)return b.getAttribute("value")===null?"on":b.value;return(b.value||"").replace(Za,"")}return w}var o=c.isFunction(a);return this.each(function(k){var n=c(this),r=a;if(this.nodeType===1){if(o)r=a.call(this,k,n.val());if(typeof r==="number")r+="";if(c.isArray(r)&&Ba.test(this.type))this.checked=c.inArray(n.val(),r)>=0;else if(c.nodeName(this,"select")){var u=c.makeArray(r);c("option",this).each(function(){this.selected=
c.inArray(c(this).val(),u)>=0});if(!u.length)this.selectedIndex=-1}else this.value=r}})}});c.extend({attrFn:{val:true,css:true,html:true,text:true,data:true,width:true,height:true,offset:true},attr:function(a,b,d,f){if(!a||a.nodeType===3||a.nodeType===8)return w;if(f&&b in c.attrFn)return c(a)[b](d);f=a.nodeType!==1||!c.isXMLDoc(a);var e=d!==w;b=f&&c.props[b]||b;if(a.nodeType===1){var j=$a.test(b);if(b in a&&f&&!j){if(e){b==="type"&&ab.test(a.nodeName)&&a.parentNode&&c.error("type property can't be changed");
a[b]=d}if(c.nodeName(a,"form")&&a.getAttributeNode(b))return a.getAttributeNode(b).nodeValue;if(b==="tabIndex")return(b=a.getAttributeNode("tabIndex"))&&b.specified?b.value:bb.test(a.nodeName)||cb.test(a.nodeName)&&a.href?0:w;return a[b]}if(!c.support.style&&f&&b==="style"){if(e)a.style.cssText=""+d;return a.style.cssText}e&&a.setAttribute(b,""+d);a=!c.support.hrefNormalized&&f&&j?a.getAttribute(b,2):a.getAttribute(b);return a===null?w:a}return c.style(a,b,d)}});var O=/\.(.*)$/,db=function(a){return a.replace(/[^\w\s\.\|`]/g,
function(b){return"\\"+b})};c.event={add:function(a,b,d,f){if(!(a.nodeType===3||a.nodeType===8)){if(a.setInterval&&a!==A&&!a.frameElement)a=A;var e,j;if(d.handler){e=d;d=e.handler}if(!d.guid)d.guid=c.guid++;if(j=c.data(a)){var i=j.events=j.events||{},o=j.handle;if(!o)j.handle=o=function(){return typeof c!=="undefined"&&!c.event.triggered?c.event.handle.apply(o.elem,arguments):w};o.elem=a;b=b.split(" ");for(var k,n=0,r;k=b[n++];){j=e?c.extend({},e):{handler:d,data:f};if(k.indexOf(".")>-1){r=k.split(".");
k=r.shift();j.namespace=r.slice(0).sort().join(".")}else{r=[];j.namespace=""}j.type=k;j.guid=d.guid;var u=i[k],z=c.event.special[k]||{};if(!u){u=i[k]=[];if(!z.setup||z.setup.call(a,f,r,o)===false)if(a.addEventListener)a.addEventListener(k,o,false);else a.attachEvent&&a.attachEvent("on"+k,o)}if(z.add){z.add.call(a,j);if(!j.handler.guid)j.handler.guid=d.guid}u.push(j);c.event.global[k]=true}a=null}}},global:{},remove:function(a,b,d,f){if(!(a.nodeType===3||a.nodeType===8)){var e,j=0,i,o,k,n,r,u,z=c.data(a),
C=z&&z.events;if(z&&C){if(b&&b.type){d=b.handler;b=b.type}if(!b||typeof b==="string"&&b.charAt(0)==="."){b=b||"";for(e in C)c.event.remove(a,e+b)}else{for(b=b.split(" ");e=b[j++];){n=e;i=e.indexOf(".")<0;o=[];if(!i){o=e.split(".");e=o.shift();k=new RegExp("(^|\\.)"+c.map(o.slice(0).sort(),db).join("\\.(?:.*\\.)?")+"(\\.|$)")}if(r=C[e])if(d){n=c.event.special[e]||{};for(B=f||0;B<r.length;B++){u=r[B];if(d.guid===u.guid){if(i||k.test(u.namespace)){f==null&&r.splice(B--,1);n.remove&&n.remove.call(a,u)}if(f!=
null)break}}if(r.length===0||f!=null&&r.length===1){if(!n.teardown||n.teardown.call(a,o)===false)Ca(a,e,z.handle);delete C[e]}}else for(var B=0;B<r.length;B++){u=r[B];if(i||k.test(u.namespace)){c.event.remove(a,n,u.handler,B);r.splice(B--,1)}}}if(c.isEmptyObject(C)){if(b=z.handle)b.elem=null;delete z.events;delete z.handle;c.isEmptyObject(z)&&c.removeData(a)}}}}},trigger:function(a,b,d,f){var e=a.type||a;if(!f){a=typeof a==="object"?a[G]?a:c.extend(c.Event(e),a):c.Event(e);if(e.indexOf("!")>=0){a.type=
e=e.slice(0,-1);a.exclusive=true}if(!d){a.stopPropagation();c.event.global[e]&&c.each(c.cache,function(){this.events&&this.events[e]&&c.event.trigger(a,b,this.handle.elem)})}if(!d||d.nodeType===3||d.nodeType===8)return w;a.result=w;a.target=d;b=c.makeArray(b);b.unshift(a)}a.currentTarget=d;(f=c.data(d,"handle"))&&f.apply(d,b);f=d.parentNode||d.ownerDocument;try{if(!(d&&d.nodeName&&c.noData[d.nodeName.toLowerCase()]))if(d["on"+e]&&d["on"+e].apply(d,b)===false)a.result=false}catch(j){}if(!a.isPropagationStopped()&&
f)c.event.trigger(a,b,f,true);else if(!a.isDefaultPrevented()){f=a.target;var i,o=c.nodeName(f,"a")&&e==="click",k=c.event.special[e]||{};if((!k._default||k._default.call(d,a)===false)&&!o&&!(f&&f.nodeName&&c.noData[f.nodeName.toLowerCase()])){try{if(f[e]){if(i=f["on"+e])f["on"+e]=null;c.event.triggered=true;f[e]()}}catch(n){}if(i)f["on"+e]=i;c.event.triggered=false}}},handle:function(a){var b,d,f,e;a=arguments[0]=c.event.fix(a||A.event);a.currentTarget=this;b=a.type.indexOf(".")<0&&!a.exclusive;
if(!b){d=a.type.split(".");a.type=d.shift();f=new RegExp("(^|\\.)"+d.slice(0).sort().join("\\.(?:.*\\.)?")+"(\\.|$)")}e=c.data(this,"events");d=e[a.type];if(e&&d){d=d.slice(0);e=0;for(var j=d.length;e<j;e++){var i=d[e];if(b||f.test(i.namespace)){a.handler=i.handler;a.data=i.data;a.handleObj=i;i=i.handler.apply(this,arguments);if(i!==w){a.result=i;if(i===false){a.preventDefault();a.stopPropagation()}}if(a.isImmediatePropagationStopped())break}}}return a.result},props:"altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY originalTarget pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" "),
fix:function(a){if(a[G])return a;var b=a;a=c.Event(b);for(var d=this.props.length,f;d;){f=this.props[--d];a[f]=b[f]}if(!a.target)a.target=a.srcElement||s;if(a.target.nodeType===3)a.target=a.target.parentNode;if(!a.relatedTarget&&a.fromElement)a.relatedTarget=a.fromElement===a.target?a.toElement:a.fromElement;if(a.pageX==null&&a.clientX!=null){b=s.documentElement;d=s.body;a.pageX=a.clientX+(b&&b.scrollLeft||d&&d.scrollLeft||0)-(b&&b.clientLeft||d&&d.clientLeft||0);a.pageY=a.clientY+(b&&b.scrollTop||
d&&d.scrollTop||0)-(b&&b.clientTop||d&&d.clientTop||0)}if(!a.which&&(a.charCode||a.charCode===0?a.charCode:a.keyCode))a.which=a.charCode||a.keyCode;if(!a.metaKey&&a.ctrlKey)a.metaKey=a.ctrlKey;if(!a.which&&a.button!==w)a.which=a.button&1?1:a.button&2?3:a.button&4?2:0;return a},guid:1E8,proxy:c.proxy,special:{ready:{setup:c.bindReady,teardown:c.noop},live:{add:function(a){c.event.add(this,a.origType,c.extend({},a,{handler:oa}))},remove:function(a){var b=true,d=a.origType.replace(O,"");c.each(c.data(this,
"events").live||[],function(){if(d===this.origType.replace(O,""))return b=false});b&&c.event.remove(this,a.origType,oa)}},beforeunload:{setup:function(a,b,d){if(this.setInterval)this.onbeforeunload=d;return false},teardown:function(a,b){if(this.onbeforeunload===b)this.onbeforeunload=null}}}};var Ca=s.removeEventListener?function(a,b,d){a.removeEventListener(b,d,false)}:function(a,b,d){a.detachEvent("on"+b,d)};c.Event=function(a){if(!this.preventDefault)return new c.Event(a);if(a&&a.type){this.originalEvent=
a;this.type=a.type}else this.type=a;this.timeStamp=J();this[G]=true};c.Event.prototype={preventDefault:function(){this.isDefaultPrevented=Z;var a=this.originalEvent;if(a){a.preventDefault&&a.preventDefault();a.returnValue=false}},stopPropagation:function(){this.isPropagationStopped=Z;var a=this.originalEvent;if(a){a.stopPropagation&&a.stopPropagation();a.cancelBubble=true}},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=Z;this.stopPropagation()},isDefaultPrevented:Y,isPropagationStopped:Y,
isImmediatePropagationStopped:Y};var Da=function(a){var b=a.relatedTarget;try{for(;b&&b!==this;)b=b.parentNode;if(b!==this){a.type=a.data;c.event.handle.apply(this,arguments)}}catch(d){}},Ea=function(a){a.type=a.data;c.event.handle.apply(this,arguments)};c.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){c.event.special[a]={setup:function(d){c.event.add(this,b,d&&d.selector?Ea:Da,a)},teardown:function(d){c.event.remove(this,b,d&&d.selector?Ea:Da)}}});if(!c.support.submitBubbles)c.event.special.submit=
{setup:function(){if(this.nodeName.toLowerCase()!=="form"){c.event.add(this,"click.specialSubmit",function(a){var b=a.target,d=b.type;if((d==="submit"||d==="image")&&c(b).closest("form").length)return na("submit",this,arguments)});c.event.add(this,"keypress.specialSubmit",function(a){var b=a.target,d=b.type;if((d==="text"||d==="password")&&c(b).closest("form").length&&a.keyCode===13)return na("submit",this,arguments)})}else return false},teardown:function(){c.event.remove(this,".specialSubmit")}};
if(!c.support.changeBubbles){var da=/textarea|input|select/i,ea,Fa=function(a){var b=a.type,d=a.value;if(b==="radio"||b==="checkbox")d=a.checked;else if(b==="select-multiple")d=a.selectedIndex>-1?c.map(a.options,function(f){return f.selected}).join("-"):"";else if(a.nodeName.toLowerCase()==="select")d=a.selectedIndex;return d},fa=function(a,b){var d=a.target,f,e;if(!(!da.test(d.nodeName)||d.readOnly)){f=c.data(d,"_change_data");e=Fa(d);if(a.type!=="focusout"||d.type!=="radio")c.data(d,"_change_data",
e);if(!(f===w||e===f))if(f!=null||e){a.type="change";return c.event.trigger(a,b,d)}}};c.event.special.change={filters:{focusout:fa,click:function(a){var b=a.target,d=b.type;if(d==="radio"||d==="checkbox"||b.nodeName.toLowerCase()==="select")return fa.call(this,a)},keydown:function(a){var b=a.target,d=b.type;if(a.keyCode===13&&b.nodeName.toLowerCase()!=="textarea"||a.keyCode===32&&(d==="checkbox"||d==="radio")||d==="select-multiple")return fa.call(this,a)},beforeactivate:function(a){a=a.target;c.data(a,
"_change_data",Fa(a))}},setup:function(){if(this.type==="file")return false;for(var a in ea)c.event.add(this,a+".specialChange",ea[a]);return da.test(this.nodeName)},teardown:function(){c.event.remove(this,".specialChange");return da.test(this.nodeName)}};ea=c.event.special.change.filters}s.addEventListener&&c.each({focus:"focusin",blur:"focusout"},function(a,b){function d(f){f=c.event.fix(f);f.type=b;return c.event.handle.call(this,f)}c.event.special[b]={setup:function(){this.addEventListener(a,
d,true)},teardown:function(){this.removeEventListener(a,d,true)}}});c.each(["bind","one"],function(a,b){c.fn[b]=function(d,f,e){if(typeof d==="object"){for(var j in d)this[b](j,f,d[j],e);return this}if(c.isFunction(f)){e=f;f=w}var i=b==="one"?c.proxy(e,function(k){c(this).unbind(k,i);return e.apply(this,arguments)}):e;if(d==="unload"&&b!=="one")this.one(d,f,e);else{j=0;for(var o=this.length;j<o;j++)c.event.add(this[j],d,i,f)}return this}});c.fn.extend({unbind:function(a,b){if(typeof a==="object"&&
!a.preventDefault)for(var d in a)this.unbind(d,a[d]);else{d=0;for(var f=this.length;d<f;d++)c.event.remove(this[d],a,b)}return this},delegate:function(a,b,d,f){return this.live(b,d,f,a)},undelegate:function(a,b,d){return arguments.length===0?this.unbind("live"):this.die(b,null,d,a)},trigger:function(a,b){return this.each(function(){c.event.trigger(a,b,this)})},triggerHandler:function(a,b){if(this[0]){a=c.Event(a);a.preventDefault();a.stopPropagation();c.event.trigger(a,b,this[0]);return a.result}},
toggle:function(a){for(var b=arguments,d=1;d<b.length;)c.proxy(a,b[d++]);return this.click(c.proxy(a,function(f){var e=(c.data(this,"lastToggle"+a.guid)||0)%d;c.data(this,"lastToggle"+a.guid,e+1);f.preventDefault();return b[e].apply(this,arguments)||false}))},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}});var Ga={focus:"focusin",blur:"focusout",mouseenter:"mouseover",mouseleave:"mouseout"};c.each(["live","die"],function(a,b){c.fn[b]=function(d,f,e,j){var i,o=0,k,n,r=j||this.selector,
u=j?this:c(this.context);if(c.isFunction(f)){e=f;f=w}for(d=(d||"").split(" ");(i=d[o++])!=null;){j=O.exec(i);k="";if(j){k=j[0];i=i.replace(O,"")}if(i==="hover")d.push("mouseenter"+k,"mouseleave"+k);else{n=i;if(i==="focus"||i==="blur"){d.push(Ga[i]+k);i+=k}else i=(Ga[i]||i)+k;b==="live"?u.each(function(){c.event.add(this,pa(i,r),{data:f,selector:r,handler:e,origType:i,origHandler:e,preType:n})}):u.unbind(pa(i,r),e)}}return this}});c.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error".split(" "),
function(a,b){c.fn[b]=function(d){return d?this.bind(b,d):this.trigger(b)};if(c.attrFn)c.attrFn[b]=true});A.attachEvent&&!A.addEventListener&&A.attachEvent("onunload",function(){for(var a in c.cache)if(c.cache[a].handle)try{c.event.remove(c.cache[a].handle.elem)}catch(b){}});(function(){function a(g){for(var h="",l,m=0;g[m];m++){l=g[m];if(l.nodeType===3||l.nodeType===4)h+=l.nodeValue;else if(l.nodeType!==8)h+=a(l.childNodes)}return h}function b(g,h,l,m,q,p){q=0;for(var v=m.length;q<v;q++){var t=m[q];
if(t){t=t[g];for(var y=false;t;){if(t.sizcache===l){y=m[t.sizset];break}if(t.nodeType===1&&!p){t.sizcache=l;t.sizset=q}if(t.nodeName.toLowerCase()===h){y=t;break}t=t[g]}m[q]=y}}}function d(g,h,l,m,q,p){q=0;for(var v=m.length;q<v;q++){var t=m[q];if(t){t=t[g];for(var y=false;t;){if(t.sizcache===l){y=m[t.sizset];break}if(t.nodeType===1){if(!p){t.sizcache=l;t.sizset=q}if(typeof h!=="string"){if(t===h){y=true;break}}else if(k.filter(h,[t]).length>0){y=t;break}}t=t[g]}m[q]=y}}}var f=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^[\]]*\]|['"][^'"]*['"]|[^[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,
e=0,j=Object.prototype.toString,i=false,o=true;[0,0].sort(function(){o=false;return 0});var k=function(g,h,l,m){l=l||[];var q=h=h||s;if(h.nodeType!==1&&h.nodeType!==9)return[];if(!g||typeof g!=="string")return l;for(var p=[],v,t,y,S,H=true,M=x(h),I=g;(f.exec(""),v=f.exec(I))!==null;){I=v[3];p.push(v[1]);if(v[2]){S=v[3];break}}if(p.length>1&&r.exec(g))if(p.length===2&&n.relative[p[0]])t=ga(p[0]+p[1],h);else for(t=n.relative[p[0]]?[h]:k(p.shift(),h);p.length;){g=p.shift();if(n.relative[g])g+=p.shift();
t=ga(g,t)}else{if(!m&&p.length>1&&h.nodeType===9&&!M&&n.match.ID.test(p[0])&&!n.match.ID.test(p[p.length-1])){v=k.find(p.shift(),h,M);h=v.expr?k.filter(v.expr,v.set)[0]:v.set[0]}if(h){v=m?{expr:p.pop(),set:z(m)}:k.find(p.pop(),p.length===1&&(p[0]==="~"||p[0]==="+")&&h.parentNode?h.parentNode:h,M);t=v.expr?k.filter(v.expr,v.set):v.set;if(p.length>0)y=z(t);else H=false;for(;p.length;){var D=p.pop();v=D;if(n.relative[D])v=p.pop();else D="";if(v==null)v=h;n.relative[D](y,v,M)}}else y=[]}y||(y=t);y||k.error(D||
g);if(j.call(y)==="[object Array]")if(H)if(h&&h.nodeType===1)for(g=0;y[g]!=null;g++){if(y[g]&&(y[g]===true||y[g].nodeType===1&&E(h,y[g])))l.push(t[g])}else for(g=0;y[g]!=null;g++)y[g]&&y[g].nodeType===1&&l.push(t[g]);else l.push.apply(l,y);else z(y,l);if(S){k(S,q,l,m);k.uniqueSort(l)}return l};k.uniqueSort=function(g){if(B){i=o;g.sort(B);if(i)for(var h=1;h<g.length;h++)g[h]===g[h-1]&&g.splice(h--,1)}return g};k.matches=function(g,h){return k(g,null,null,h)};k.find=function(g,h,l){var m,q;if(!g)return[];
for(var p=0,v=n.order.length;p<v;p++){var t=n.order[p];if(q=n.leftMatch[t].exec(g)){var y=q[1];q.splice(1,1);if(y.substr(y.length-1)!=="\\"){q[1]=(q[1]||"").replace(/\\/g,"");m=n.find[t](q,h,l);if(m!=null){g=g.replace(n.match[t],"");break}}}}m||(m=h.getElementsByTagName("*"));return{set:m,expr:g}};k.filter=function(g,h,l,m){for(var q=g,p=[],v=h,t,y,S=h&&h[0]&&x(h[0]);g&&h.length;){for(var H in n.filter)if((t=n.leftMatch[H].exec(g))!=null&&t[2]){var M=n.filter[H],I,D;D=t[1];y=false;t.splice(1,1);if(D.substr(D.length-
1)!=="\\"){if(v===p)p=[];if(n.preFilter[H])if(t=n.preFilter[H](t,v,l,p,m,S)){if(t===true)continue}else y=I=true;if(t)for(var U=0;(D=v[U])!=null;U++)if(D){I=M(D,t,U,v);var Ha=m^!!I;if(l&&I!=null)if(Ha)y=true;else v[U]=false;else if(Ha){p.push(D);y=true}}if(I!==w){l||(v=p);g=g.replace(n.match[H],"");if(!y)return[];break}}}if(g===q)if(y==null)k.error(g);else break;q=g}return v};k.error=function(g){throw"Syntax error, unrecognized expression: "+g;};var n=k.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF-]|\\.)+)/,
CLASS:/\.((?:[\w\u00c0-\uFFFF-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\((even|odd|[\dn+-]*)\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(g){return g.getAttribute("href")}},
relative:{"+":function(g,h){var l=typeof h==="string",m=l&&!/\W/.test(h);l=l&&!m;if(m)h=h.toLowerCase();m=0;for(var q=g.length,p;m<q;m++)if(p=g[m]){for(;(p=p.previousSibling)&&p.nodeType!==1;);g[m]=l||p&&p.nodeName.toLowerCase()===h?p||false:p===h}l&&k.filter(h,g,true)},">":function(g,h){var l=typeof h==="string";if(l&&!/\W/.test(h)){h=h.toLowerCase();for(var m=0,q=g.length;m<q;m++){var p=g[m];if(p){l=p.parentNode;g[m]=l.nodeName.toLowerCase()===h?l:false}}}else{m=0;for(q=g.length;m<q;m++)if(p=g[m])g[m]=
l?p.parentNode:p.parentNode===h;l&&k.filter(h,g,true)}},"":function(g,h,l){var m=e++,q=d;if(typeof h==="string"&&!/\W/.test(h)){var p=h=h.toLowerCase();q=b}q("parentNode",h,m,g,p,l)},"~":function(g,h,l){var m=e++,q=d;if(typeof h==="string"&&!/\W/.test(h)){var p=h=h.toLowerCase();q=b}q("previousSibling",h,m,g,p,l)}},find:{ID:function(g,h,l){if(typeof h.getElementById!=="undefined"&&!l)return(g=h.getElementById(g[1]))?[g]:[]},NAME:function(g,h){if(typeof h.getElementsByName!=="undefined"){var l=[];
h=h.getElementsByName(g[1]);for(var m=0,q=h.length;m<q;m++)h[m].getAttribute("name")===g[1]&&l.push(h[m]);return l.length===0?null:l}},TAG:function(g,h){return h.getElementsByTagName(g[1])}},preFilter:{CLASS:function(g,h,l,m,q,p){g=" "+g[1].replace(/\\/g,"")+" ";if(p)return g;p=0;for(var v;(v=h[p])!=null;p++)if(v)if(q^(v.className&&(" "+v.className+" ").replace(/[\t\n]/g," ").indexOf(g)>=0))l||m.push(v);else if(l)h[p]=false;return false},ID:function(g){return g[1].replace(/\\/g,"")},TAG:function(g){return g[1].toLowerCase()},
CHILD:function(g){if(g[1]==="nth"){var h=/(-?)(\d*)n((?:\+|-)?\d*)/.exec(g[2]==="even"&&"2n"||g[2]==="odd"&&"2n+1"||!/\D/.test(g[2])&&"0n+"+g[2]||g[2]);g[2]=h[1]+(h[2]||1)-0;g[3]=h[3]-0}g[0]=e++;return g},ATTR:function(g,h,l,m,q,p){h=g[1].replace(/\\/g,"");if(!p&&n.attrMap[h])g[1]=n.attrMap[h];if(g[2]==="~=")g[4]=" "+g[4]+" ";return g},PSEUDO:function(g,h,l,m,q){if(g[1]==="not")if((f.exec(g[3])||"").length>1||/^\w/.test(g[3]))g[3]=k(g[3],null,null,h);else{g=k.filter(g[3],h,l,true^q);l||m.push.apply(m,
g);return false}else if(n.match.POS.test(g[0])||n.match.CHILD.test(g[0]))return true;return g},POS:function(g){g.unshift(true);return g}},filters:{enabled:function(g){return g.disabled===false&&g.type!=="hidden"},disabled:function(g){return g.disabled===true},checked:function(g){return g.checked===true},selected:function(g){return g.selected===true},parent:function(g){return!!g.firstChild},empty:function(g){return!g.firstChild},has:function(g,h,l){return!!k(l[3],g).length},header:function(g){return/h\d/i.test(g.nodeName)},
text:function(g){return"text"===g.type},radio:function(g){return"radio"===g.type},checkbox:function(g){return"checkbox"===g.type},file:function(g){return"file"===g.type},password:function(g){return"password"===g.type},submit:function(g){return"submit"===g.type},image:function(g){return"image"===g.type},reset:function(g){return"reset"===g.type},button:function(g){return"button"===g.type||g.nodeName.toLowerCase()==="button"},input:function(g){return/input|select|textarea|button/i.test(g.nodeName)}},
setFilters:{first:function(g,h){return h===0},last:function(g,h,l,m){return h===m.length-1},even:function(g,h){return h%2===0},odd:function(g,h){return h%2===1},lt:function(g,h,l){return h<l[3]-0},gt:function(g,h,l){return h>l[3]-0},nth:function(g,h,l){return l[3]-0===h},eq:function(g,h,l){return l[3]-0===h}},filter:{PSEUDO:function(g,h,l,m){var q=h[1],p=n.filters[q];if(p)return p(g,l,h,m);else if(q==="contains")return(g.textContent||g.innerText||a([g])||"").indexOf(h[3])>=0;else if(q==="not"){h=
h[3];l=0;for(m=h.length;l<m;l++)if(h[l]===g)return false;return true}else k.error("Syntax error, unrecognized expression: "+q)},CHILD:function(g,h){var l=h[1],m=g;switch(l){case "only":case "first":for(;m=m.previousSibling;)if(m.nodeType===1)return false;if(l==="first")return true;m=g;case "last":for(;m=m.nextSibling;)if(m.nodeType===1)return false;return true;case "nth":l=h[2];var q=h[3];if(l===1&&q===0)return true;h=h[0];var p=g.parentNode;if(p&&(p.sizcache!==h||!g.nodeIndex)){var v=0;for(m=p.firstChild;m;m=
m.nextSibling)if(m.nodeType===1)m.nodeIndex=++v;p.sizcache=h}g=g.nodeIndex-q;return l===0?g===0:g%l===0&&g/l>=0}},ID:function(g,h){return g.nodeType===1&&g.getAttribute("id")===h},TAG:function(g,h){return h==="*"&&g.nodeType===1||g.nodeName.toLowerCase()===h},CLASS:function(g,h){return(" "+(g.className||g.getAttribute("class"))+" ").indexOf(h)>-1},ATTR:function(g,h){var l=h[1];g=n.attrHandle[l]?n.attrHandle[l](g):g[l]!=null?g[l]:g.getAttribute(l);l=g+"";var m=h[2];h=h[4];return g==null?m==="!=":m===
"="?l===h:m==="*="?l.indexOf(h)>=0:m==="~="?(" "+l+" ").indexOf(h)>=0:!h?l&&g!==false:m==="!="?l!==h:m==="^="?l.indexOf(h)===0:m==="$="?l.substr(l.length-h.length)===h:m==="|="?l===h||l.substr(0,h.length+1)===h+"-":false},POS:function(g,h,l,m){var q=n.setFilters[h[2]];if(q)return q(g,l,h,m)}}},r=n.match.POS;for(var u in n.match){n.match[u]=new RegExp(n.match[u].source+/(?![^\[]*\])(?![^\(]*\))/.source);n.leftMatch[u]=new RegExp(/(^(?:.|\r|\n)*?)/.source+n.match[u].source.replace(/\\(\d+)/g,function(g,
h){return"\\"+(h-0+1)}))}var z=function(g,h){g=Array.prototype.slice.call(g,0);if(h){h.push.apply(h,g);return h}return g};try{Array.prototype.slice.call(s.documentElement.childNodes,0)}catch(C){z=function(g,h){h=h||[];if(j.call(g)==="[object Array]")Array.prototype.push.apply(h,g);else if(typeof g.length==="number")for(var l=0,m=g.length;l<m;l++)h.push(g[l]);else for(l=0;g[l];l++)h.push(g[l]);return h}}var B;if(s.documentElement.compareDocumentPosition)B=function(g,h){if(!g.compareDocumentPosition||
!h.compareDocumentPosition){if(g==h)i=true;return g.compareDocumentPosition?-1:1}g=g.compareDocumentPosition(h)&4?-1:g===h?0:1;if(g===0)i=true;return g};else if("sourceIndex"in s.documentElement)B=function(g,h){if(!g.sourceIndex||!h.sourceIndex){if(g==h)i=true;return g.sourceIndex?-1:1}g=g.sourceIndex-h.sourceIndex;if(g===0)i=true;return g};else if(s.createRange)B=function(g,h){if(!g.ownerDocument||!h.ownerDocument){if(g==h)i=true;return g.ownerDocument?-1:1}var l=g.ownerDocument.createRange(),m=
h.ownerDocument.createRange();l.setStart(g,0);l.setEnd(g,0);m.setStart(h,0);m.setEnd(h,0);g=l.compareBoundaryPoints(Range.START_TO_END,m);if(g===0)i=true;return g};(function(){var g=s.createElement("div"),h="script"+(new Date).getTime();g.innerHTML="<a name='"+h+"'/>";var l=s.documentElement;l.insertBefore(g,l.firstChild);if(s.getElementById(h)){n.find.ID=function(m,q,p){if(typeof q.getElementById!=="undefined"&&!p)return(q=q.getElementById(m[1]))?q.id===m[1]||typeof q.getAttributeNode!=="undefined"&&
q.getAttributeNode("id").nodeValue===m[1]?[q]:w:[]};n.filter.ID=function(m,q){var p=typeof m.getAttributeNode!=="undefined"&&m.getAttributeNode("id");return m.nodeType===1&&p&&p.nodeValue===q}}l.removeChild(g);l=g=null})();(function(){var g=s.createElement("div");g.appendChild(s.createComment(""));if(g.getElementsByTagName("*").length>0)n.find.TAG=function(h,l){l=l.getElementsByTagName(h[1]);if(h[1]==="*"){h=[];for(var m=0;l[m];m++)l[m].nodeType===1&&h.push(l[m]);l=h}return l};g.innerHTML="<a href='#'></a>";
if(g.firstChild&&typeof g.firstChild.getAttribute!=="undefined"&&g.firstChild.getAttribute("href")!=="#")n.attrHandle.href=function(h){return h.getAttribute("href",2)};g=null})();s.querySelectorAll&&function(){var g=k,h=s.createElement("div");h.innerHTML="<p class='TEST'></p>";if(!(h.querySelectorAll&&h.querySelectorAll(".TEST").length===0)){k=function(m,q,p,v){q=q||s;if(!v&&q.nodeType===9&&!x(q))try{return z(q.querySelectorAll(m),p)}catch(t){}return g(m,q,p,v)};for(var l in g)k[l]=g[l];h=null}}();
(function(){var g=s.createElement("div");g.innerHTML="<div class='test e'></div><div class='test'></div>";if(!(!g.getElementsByClassName||g.getElementsByClassName("e").length===0)){g.lastChild.className="e";if(g.getElementsByClassName("e").length!==1){n.order.splice(1,0,"CLASS");n.find.CLASS=function(h,l,m){if(typeof l.getElementsByClassName!=="undefined"&&!m)return l.getElementsByClassName(h[1])};g=null}}})();var E=s.compareDocumentPosition?function(g,h){return!!(g.compareDocumentPosition(h)&16)}:
function(g,h){return g!==h&&(g.contains?g.contains(h):true)},x=function(g){return(g=(g?g.ownerDocument||g:0).documentElement)?g.nodeName!=="HTML":false},ga=function(g,h){var l=[],m="",q;for(h=h.nodeType?[h]:h;q=n.match.PSEUDO.exec(g);){m+=q[0];g=g.replace(n.match.PSEUDO,"")}g=n.relative[g]?g+"*":g;q=0;for(var p=h.length;q<p;q++)k(g,h[q],l);return k.filter(m,l)};c.find=k;c.expr=k.selectors;c.expr[":"]=c.expr.filters;c.unique=k.uniqueSort;c.text=a;c.isXMLDoc=x;c.contains=E})();var eb=/Until$/,fb=/^(?:parents|prevUntil|prevAll)/,
gb=/,/;R=Array.prototype.slice;var Ia=function(a,b,d){if(c.isFunction(b))return c.grep(a,function(e,j){return!!b.call(e,j,e)===d});else if(b.nodeType)return c.grep(a,function(e){return e===b===d});else if(typeof b==="string"){var f=c.grep(a,function(e){return e.nodeType===1});if(Ua.test(b))return c.filter(b,f,!d);else b=c.filter(b,f)}return c.grep(a,function(e){return c.inArray(e,b)>=0===d})};c.fn.extend({find:function(a){for(var b=this.pushStack("","find",a),d=0,f=0,e=this.length;f<e;f++){d=b.length;
c.find(a,this[f],b);if(f>0)for(var j=d;j<b.length;j++)for(var i=0;i<d;i++)if(b[i]===b[j]){b.splice(j--,1);break}}return b},has:function(a){var b=c(a);return this.filter(function(){for(var d=0,f=b.length;d<f;d++)if(c.contains(this,b[d]))return true})},not:function(a){return this.pushStack(Ia(this,a,false),"not",a)},filter:function(a){return this.pushStack(Ia(this,a,true),"filter",a)},is:function(a){return!!a&&c.filter(a,this).length>0},closest:function(a,b){if(c.isArray(a)){var d=[],f=this[0],e,j=
{},i;if(f&&a.length){e=0;for(var o=a.length;e<o;e++){i=a[e];j[i]||(j[i]=c.expr.match.POS.test(i)?c(i,b||this.context):i)}for(;f&&f.ownerDocument&&f!==b;){for(i in j){e=j[i];if(e.jquery?e.index(f)>-1:c(f).is(e)){d.push({selector:i,elem:f});delete j[i]}}f=f.parentNode}}return d}var k=c.expr.match.POS.test(a)?c(a,b||this.context):null;return this.map(function(n,r){for(;r&&r.ownerDocument&&r!==b;){if(k?k.index(r)>-1:c(r).is(a))return r;r=r.parentNode}return null})},index:function(a){if(!a||typeof a===
"string")return c.inArray(this[0],a?c(a):this.parent().children());return c.inArray(a.jquery?a[0]:a,this)},add:function(a,b){a=typeof a==="string"?c(a,b||this.context):c.makeArray(a);b=c.merge(this.get(),a);return this.pushStack(qa(a[0])||qa(b[0])?b:c.unique(b))},andSelf:function(){return this.add(this.prevObject)}});c.each({parent:function(a){return(a=a.parentNode)&&a.nodeType!==11?a:null},parents:function(a){return c.dir(a,"parentNode")},parentsUntil:function(a,b,d){return c.dir(a,"parentNode",
d)},next:function(a){return c.nth(a,2,"nextSibling")},prev:function(a){return c.nth(a,2,"previousSibling")},nextAll:function(a){return c.dir(a,"nextSibling")},prevAll:function(a){return c.dir(a,"previousSibling")},nextUntil:function(a,b,d){return c.dir(a,"nextSibling",d)},prevUntil:function(a,b,d){return c.dir(a,"previousSibling",d)},siblings:function(a){return c.sibling(a.parentNode.firstChild,a)},children:function(a){return c.sibling(a.firstChild)},contents:function(a){return c.nodeName(a,"iframe")?
a.contentDocument||a.contentWindow.document:c.makeArray(a.childNodes)}},function(a,b){c.fn[a]=function(d,f){var e=c.map(this,b,d);eb.test(a)||(f=d);if(f&&typeof f==="string")e=c.filter(f,e);e=this.length>1?c.unique(e):e;if((this.length>1||gb.test(f))&&fb.test(a))e=e.reverse();return this.pushStack(e,a,R.call(arguments).join(","))}});c.extend({filter:function(a,b,d){if(d)a=":not("+a+")";return c.find.matches(a,b)},dir:function(a,b,d){var f=[];for(a=a[b];a&&a.nodeType!==9&&(d===w||a.nodeType!==1||!c(a).is(d));){a.nodeType===
1&&f.push(a);a=a[b]}return f},nth:function(a,b,d){b=b||1;for(var f=0;a;a=a[d])if(a.nodeType===1&&++f===b)break;return a},sibling:function(a,b){for(var d=[];a;a=a.nextSibling)a.nodeType===1&&a!==b&&d.push(a);return d}});var Ja=/ jQuery\d+="(?:\d+|null)"/g,V=/^\s+/,Ka=/(<([\w:]+)[^>]*?)\/>/g,hb=/^(?:area|br|col|embed|hr|img|input|link|meta|param)$/i,La=/<([\w:]+)/,ib=/<tbody/i,jb=/<|&#?\w+;/,ta=/<script|<object|<embed|<option|<style/i,ua=/checked\s*(?:[^=]|=\s*.checked.)/i,Ma=function(a,b,d){return hb.test(d)?
a:b+"></"+d+">"},F={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]};F.optgroup=F.option;F.tbody=F.tfoot=F.colgroup=F.caption=F.thead;F.th=F.td;if(!c.support.htmlSerialize)F._default=[1,"div<div>","</div>"];c.fn.extend({text:function(a){if(c.isFunction(a))return this.each(function(b){var d=
c(this);d.text(a.call(this,b,d.text()))});if(typeof a!=="object"&&a!==w)return this.empty().append((this[0]&&this[0].ownerDocument||s).createTextNode(a));return c.text(this)},wrapAll:function(a){if(c.isFunction(a))return this.each(function(d){c(this).wrapAll(a.call(this,d))});if(this[0]){var b=c(a,this[0].ownerDocument).eq(0).clone(true);this[0].parentNode&&b.insertBefore(this[0]);b.map(function(){for(var d=this;d.firstChild&&d.firstChild.nodeType===1;)d=d.firstChild;return d}).append(this)}return this},
wrapInner:function(a){if(c.isFunction(a))return this.each(function(b){c(this).wrapInner(a.call(this,b))});return this.each(function(){var b=c(this),d=b.contents();d.length?d.wrapAll(a):b.append(a)})},wrap:function(a){return this.each(function(){c(this).wrapAll(a)})},unwrap:function(){return this.parent().each(function(){c.nodeName(this,"body")||c(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,true,function(a){this.nodeType===1&&this.appendChild(a)})},
prepend:function(){return this.domManip(arguments,true,function(a){this.nodeType===1&&this.insertBefore(a,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,false,function(b){this.parentNode.insertBefore(b,this)});else if(arguments.length){var a=c(arguments[0]);a.push.apply(a,this.toArray());return this.pushStack(a,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,false,function(b){this.parentNode.insertBefore(b,
this.nextSibling)});else if(arguments.length){var a=this.pushStack(this,"after",arguments);a.push.apply(a,c(arguments[0]).toArray());return a}},remove:function(a,b){for(var d=0,f;(f=this[d])!=null;d++)if(!a||c.filter(a,[f]).length){if(!b&&f.nodeType===1){c.cleanData(f.getElementsByTagName("*"));c.cleanData([f])}f.parentNode&&f.parentNode.removeChild(f)}return this},empty:function(){for(var a=0,b;(b=this[a])!=null;a++)for(b.nodeType===1&&c.cleanData(b.getElementsByTagName("*"));b.firstChild;)b.removeChild(b.firstChild);
return this},clone:function(a){var b=this.map(function(){if(!c.support.noCloneEvent&&!c.isXMLDoc(this)){var d=this.outerHTML,f=this.ownerDocument;if(!d){d=f.createElement("div");d.appendChild(this.cloneNode(true));d=d.innerHTML}return c.clean([d.replace(Ja,"").replace(/=([^="'>\s]+\/)>/g,'="$1">').replace(V,"")],f)[0]}else return this.cloneNode(true)});if(a===true){ra(this,b);ra(this.find("*"),b.find("*"))}return b},html:function(a){if(a===w)return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(Ja,
""):null;else if(typeof a==="string"&&!ta.test(a)&&(c.support.leadingWhitespace||!V.test(a))&&!F[(La.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(Ka,Ma);try{for(var b=0,d=this.length;b<d;b++)if(this[b].nodeType===1){c.cleanData(this[b].getElementsByTagName("*"));this[b].innerHTML=a}}catch(f){this.empty().append(a)}}else c.isFunction(a)?this.each(function(e){var j=c(this),i=j.html();j.empty().append(function(){return a.call(this,e,i)})}):this.empty().append(a);return this},replaceWith:function(a){if(this[0]&&
this[0].parentNode){if(c.isFunction(a))return this.each(function(b){var d=c(this),f=d.html();d.replaceWith(a.call(this,b,f))});if(typeof a!=="string")a=c(a).detach();return this.each(function(){var b=this.nextSibling,d=this.parentNode;c(this).remove();b?c(b).before(a):c(d).append(a)})}else return this.pushStack(c(c.isFunction(a)?a():a),"replaceWith",a)},detach:function(a){return this.remove(a,true)},domManip:function(a,b,d){function f(u){return c.nodeName(u,"table")?u.getElementsByTagName("tbody")[0]||
u.appendChild(u.ownerDocument.createElement("tbody")):u}var e,j,i=a[0],o=[],k;if(!c.support.checkClone&&arguments.length===3&&typeof i==="string"&&ua.test(i))return this.each(function(){c(this).domManip(a,b,d,true)});if(c.isFunction(i))return this.each(function(u){var z=c(this);a[0]=i.call(this,u,b?z.html():w);z.domManip(a,b,d)});if(this[0]){e=i&&i.parentNode;e=c.support.parentNode&&e&&e.nodeType===11&&e.childNodes.length===this.length?{fragment:e}:sa(a,this,o);k=e.fragment;if(j=k.childNodes.length===
1?(k=k.firstChild):k.firstChild){b=b&&c.nodeName(j,"tr");for(var n=0,r=this.length;n<r;n++)d.call(b?f(this[n],j):this[n],n>0||e.cacheable||this.length>1?k.cloneNode(true):k)}o.length&&c.each(o,Qa)}return this}});c.fragments={};c.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){c.fn[a]=function(d){var f=[];d=c(d);var e=this.length===1&&this[0].parentNode;if(e&&e.nodeType===11&&e.childNodes.length===1&&d.length===1){d[b](this[0]);
return this}else{e=0;for(var j=d.length;e<j;e++){var i=(e>0?this.clone(true):this).get();c.fn[b].apply(c(d[e]),i);f=f.concat(i)}return this.pushStack(f,a,d.selector)}}});c.extend({clean:function(a,b,d,f){b=b||s;if(typeof b.createElement==="undefined")b=b.ownerDocument||b[0]&&b[0].ownerDocument||s;for(var e=[],j=0,i;(i=a[j])!=null;j++){if(typeof i==="number")i+="";if(i){if(typeof i==="string"&&!jb.test(i))i=b.createTextNode(i);else if(typeof i==="string"){i=i.replace(Ka,Ma);var o=(La.exec(i)||["",
""])[1].toLowerCase(),k=F[o]||F._default,n=k[0],r=b.createElement("div");for(r.innerHTML=k[1]+i+k[2];n--;)r=r.lastChild;if(!c.support.tbody){n=ib.test(i);o=o==="table"&&!n?r.firstChild&&r.firstChild.childNodes:k[1]==="<table>"&&!n?r.childNodes:[];for(k=o.length-1;k>=0;--k)c.nodeName(o[k],"tbody")&&!o[k].childNodes.length&&o[k].parentNode.removeChild(o[k])}!c.support.leadingWhitespace&&V.test(i)&&r.insertBefore(b.createTextNode(V.exec(i)[0]),r.firstChild);i=r.childNodes}if(i.nodeType)e.push(i);else e=
c.merge(e,i)}}if(d)for(j=0;e[j];j++)if(f&&c.nodeName(e[j],"script")&&(!e[j].type||e[j].type.toLowerCase()==="text/javascript"))f.push(e[j].parentNode?e[j].parentNode.removeChild(e[j]):e[j]);else{e[j].nodeType===1&&e.splice.apply(e,[j+1,0].concat(c.makeArray(e[j].getElementsByTagName("script"))));d.appendChild(e[j])}return e},cleanData:function(a){for(var b,d,f=c.cache,e=c.event.special,j=c.support.deleteExpando,i=0,o;(o=a[i])!=null;i++)if(d=o[c.expando]){b=f[d];if(b.events)for(var k in b.events)e[k]?
c.event.remove(o,k):Ca(o,k,b.handle);if(j)delete o[c.expando];else o.removeAttribute&&o.removeAttribute(c.expando);delete f[d]}}});var kb=/z-?index|font-?weight|opacity|zoom|line-?height/i,Na=/alpha\([^)]*\)/,Oa=/opacity=([^)]*)/,ha=/float/i,ia=/-([a-z])/ig,lb=/([A-Z])/g,mb=/^-?\d+(?:px)?$/i,nb=/^-?\d/,ob={position:"absolute",visibility:"hidden",display:"block"},pb=["Left","Right"],qb=["Top","Bottom"],rb=s.defaultView&&s.defaultView.getComputedStyle,Pa=c.support.cssFloat?"cssFloat":"styleFloat",ja=
function(a,b){return b.toUpperCase()};c.fn.css=function(a,b){return X(this,a,b,true,function(d,f,e){if(e===w)return c.curCSS(d,f);if(typeof e==="number"&&!kb.test(f))e+="px";c.style(d,f,e)})};c.extend({style:function(a,b,d){if(!a||a.nodeType===3||a.nodeType===8)return w;if((b==="width"||b==="height")&&parseFloat(d)<0)d=w;var f=a.style||a,e=d!==w;if(!c.support.opacity&&b==="opacity"){if(e){f.zoom=1;b=parseInt(d,10)+""==="NaN"?"":"alpha(opacity="+d*100+")";a=f.filter||c.curCSS(a,"filter")||"";f.filter=
Na.test(a)?a.replace(Na,b):b}return f.filter&&f.filter.indexOf("opacity=")>=0?parseFloat(Oa.exec(f.filter)[1])/100+"":""}if(ha.test(b))b=Pa;b=b.replace(ia,ja);if(e)f[b]=d;return f[b]},css:function(a,b,d,f){if(b==="width"||b==="height"){var e,j=b==="width"?pb:qb;function i(){e=b==="width"?a.offsetWidth:a.offsetHeight;f!=="border"&&c.each(j,function(){f||(e-=parseFloat(c.curCSS(a,"padding"+this,true))||0);if(f==="margin")e+=parseFloat(c.curCSS(a,"margin"+this,true))||0;else e-=parseFloat(c.curCSS(a,
"border"+this+"Width",true))||0})}a.offsetWidth!==0?i():c.swap(a,ob,i);return Math.max(0,Math.round(e))}return c.curCSS(a,b,d)},curCSS:function(a,b,d){var f,e=a.style;if(!c.support.opacity&&b==="opacity"&&a.currentStyle){f=Oa.test(a.currentStyle.filter||"")?parseFloat(RegExp.$1)/100+"":"";return f===""?"1":f}if(ha.test(b))b=Pa;if(!d&&e&&e[b])f=e[b];else if(rb){if(ha.test(b))b="float";b=b.replace(lb,"-$1").toLowerCase();e=a.ownerDocument.defaultView;if(!e)return null;if(a=e.getComputedStyle(a,null))f=
a.getPropertyValue(b);if(b==="opacity"&&f==="")f="1"}else if(a.currentStyle){d=b.replace(ia,ja);f=a.currentStyle[b]||a.currentStyle[d];if(!mb.test(f)&&nb.test(f)){b=e.left;var j=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;e.left=d==="fontSize"?"1em":f||0;f=e.pixelLeft+"px";e.left=b;a.runtimeStyle.left=j}}return f},swap:function(a,b,d){var f={};for(var e in b){f[e]=a.style[e];a.style[e]=b[e]}d.call(a);for(e in b)a.style[e]=f[e]}});if(c.expr&&c.expr.filters){c.expr.filters.hidden=function(a){var b=
a.offsetWidth,d=a.offsetHeight,f=a.nodeName.toLowerCase()==="tr";return b===0&&d===0&&!f?true:b>0&&d>0&&!f?false:c.curCSS(a,"display")==="none"};c.expr.filters.visible=function(a){return!c.expr.filters.hidden(a)}}var sb=J(),tb=/<script(.|\s)*?\/script>/gi,ub=/select|textarea/i,vb=/color|date|datetime|email|hidden|month|number|password|range|search|tel|text|time|url|week/i,N=/=\?(&|$)/,ka=/\?/,wb=/(\?|&)_=.*?(&|$)/,xb=/^(\w+:)?\/\/([^\/?#]+)/,yb=/%20/g,zb=c.fn.load;c.fn.extend({load:function(a,b,d){if(typeof a!==
"string")return zb.call(this,a);else if(!this.length)return this;var f=a.indexOf(" ");if(f>=0){var e=a.slice(f,a.length);a=a.slice(0,f)}f="GET";if(b)if(c.isFunction(b)){d=b;b=null}else if(typeof b==="object"){b=c.param(b,c.ajaxSettings.traditional);f="POST"}var j=this;c.ajax({url:a,type:f,dataType:"html",data:b,complete:function(i,o){if(o==="success"||o==="notmodified")j.html(e?c("<div />").append(i.responseText.replace(tb,"")).find(e):i.responseText);d&&j.each(d,[i.responseText,o,i])}});return this},
serialize:function(){return c.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?c.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||ub.test(this.nodeName)||vb.test(this.type))}).map(function(a,b){a=c(this).val();return a==null?null:c.isArray(a)?c.map(a,function(d){return{name:b.name,value:d}}):{name:b.name,value:a}}).get()}});c.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),
function(a,b){c.fn[b]=function(d){return this.bind(b,d)}});c.extend({get:function(a,b,d,f){if(c.isFunction(b)){f=f||d;d=b;b=null}return c.ajax({type:"GET",url:a,data:b,success:d,dataType:f})},getScript:function(a,b){return c.get(a,null,b,"script")},getJSON:function(a,b,d){return c.get(a,b,d,"json")},post:function(a,b,d,f){if(c.isFunction(b)){f=f||d;d=b;b={}}return c.ajax({type:"POST",url:a,data:b,success:d,dataType:f})},ajaxSetup:function(a){c.extend(c.ajaxSettings,a)},ajaxSettings:{url:location.href,
global:true,type:"GET",contentType:"application/x-www-form-urlencoded",processData:true,async:true,xhr:A.XMLHttpRequest&&(A.location.protocol!=="file:"||!A.ActiveXObject)?function(){return new A.XMLHttpRequest}:function(){try{return new A.ActiveXObject("Microsoft.XMLHTTP")}catch(a){}},accepts:{xml:"application/xml, text/xml",html:"text/html",script:"text/javascript, application/javascript",json:"application/json, text/javascript",text:"text/plain",_default:"*/*"}},lastModified:{},etag:{},ajax:function(a){function b(){e.success&&
e.success.call(k,o,i,x);e.global&&f("ajaxSuccess",[x,e])}function d(){e.complete&&e.complete.call(k,x,i);e.global&&f("ajaxComplete",[x,e]);e.global&&!--c.active&&c.event.trigger("ajaxStop")}function f(q,p){(e.context?c(e.context):c.event).trigger(q,p)}var e=c.extend(true,{},c.ajaxSettings,a),j,i,o,k=a&&a.context||e,n=e.type.toUpperCase();if(e.data&&e.processData&&typeof e.data!=="string")e.data=c.param(e.data,e.traditional);if(e.dataType==="jsonp"){if(n==="GET")N.test(e.url)||(e.url+=(ka.test(e.url)?
"&":"?")+(e.jsonp||"callback")+"=?");else if(!e.data||!N.test(e.data))e.data=(e.data?e.data+"&":"")+(e.jsonp||"callback")+"=?";e.dataType="json"}if(e.dataType==="json"&&(e.data&&N.test(e.data)||N.test(e.url))){j=e.jsonpCallback||"jsonp"+sb++;if(e.data)e.data=(e.data+"").replace(N,"="+j+"$1");e.url=e.url.replace(N,"="+j+"$1");e.dataType="script";A[j]=A[j]||function(q){o=q;b();d();A[j]=w;try{delete A[j]}catch(p){}z&&z.removeChild(C)}}if(e.dataType==="script"&&e.cache===null)e.cache=false;if(e.cache===
false&&n==="GET"){var r=J(),u=e.url.replace(wb,"$1_="+r+"$2");e.url=u+(u===e.url?(ka.test(e.url)?"&":"?")+"_="+r:"")}if(e.data&&n==="GET")e.url+=(ka.test(e.url)?"&":"?")+e.data;e.global&&!c.active++&&c.event.trigger("ajaxStart");r=(r=xb.exec(e.url))&&(r[1]&&r[1]!==location.protocol||r[2]!==location.host);if(e.dataType==="script"&&n==="GET"&&r){var z=s.getElementsByTagName("head")[0]||s.documentElement,C=s.createElement("script");C.src=e.url;if(e.scriptCharset)C.charset=e.scriptCharset;if(!j){var B=
false;C.onload=C.onreadystatechange=function(){if(!B&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){B=true;b();d();C.onload=C.onreadystatechange=null;z&&C.parentNode&&z.removeChild(C)}}}z.insertBefore(C,z.firstChild);return w}var E=false,x=e.xhr();if(x){e.username?x.open(n,e.url,e.async,e.username,e.password):x.open(n,e.url,e.async);try{if(e.data||a&&a.contentType)x.setRequestHeader("Content-Type",e.contentType);if(e.ifModified){c.lastModified[e.url]&&x.setRequestHeader("If-Modified-Since",
c.lastModified[e.url]);c.etag[e.url]&&x.setRequestHeader("If-None-Match",c.etag[e.url])}r||x.setRequestHeader("X-Requested-With","XMLHttpRequest");x.setRequestHeader("Accept",e.dataType&&e.accepts[e.dataType]?e.accepts[e.dataType]+", */*":e.accepts._default)}catch(ga){}if(e.beforeSend&&e.beforeSend.call(k,x,e)===false){e.global&&!--c.active&&c.event.trigger("ajaxStop");x.abort();return false}e.global&&f("ajaxSend",[x,e]);var g=x.onreadystatechange=function(q){if(!x||x.readyState===0||q==="abort"){E||
d();E=true;if(x)x.onreadystatechange=c.noop}else if(!E&&x&&(x.readyState===4||q==="timeout")){E=true;x.onreadystatechange=c.noop;i=q==="timeout"?"timeout":!c.httpSuccess(x)?"error":e.ifModified&&c.httpNotModified(x,e.url)?"notmodified":"success";var p;if(i==="success")try{o=c.httpData(x,e.dataType,e)}catch(v){i="parsererror";p=v}if(i==="success"||i==="notmodified")j||b();else c.handleError(e,x,i,p);d();q==="timeout"&&x.abort();if(e.async)x=null}};try{var h=x.abort;x.abort=function(){x&&h.call(x);
g("abort")}}catch(l){}e.async&&e.timeout>0&&setTimeout(function(){x&&!E&&g("timeout")},e.timeout);try{x.send(n==="POST"||n==="PUT"||n==="DELETE"?e.data:null)}catch(m){c.handleError(e,x,null,m);d()}e.async||g();return x}},handleError:function(a,b,d,f){if(a.error)a.error.call(a.context||a,b,d,f);if(a.global)(a.context?c(a.context):c.event).trigger("ajaxError",[b,a,f])},active:0,httpSuccess:function(a){try{return!a.status&&location.protocol==="file:"||a.status>=200&&a.status<300||a.status===304||a.status===
1223||a.status===0}catch(b){}return false},httpNotModified:function(a,b){var d=a.getResponseHeader("Last-Modified"),f=a.getResponseHeader("Etag");if(d)c.lastModified[b]=d;if(f)c.etag[b]=f;return a.status===304||a.status===0},httpData:function(a,b,d){var f=a.getResponseHeader("content-type")||"",e=b==="xml"||!b&&f.indexOf("xml")>=0;a=e?a.responseXML:a.responseText;e&&a.documentElement.nodeName==="parsererror"&&c.error("parsererror");if(d&&d.dataFilter)a=d.dataFilter(a,b);if(typeof a==="string")if(b===
"json"||!b&&f.indexOf("json")>=0)a=c.parseJSON(a);else if(b==="script"||!b&&f.indexOf("javascript")>=0)c.globalEval(a);return a},param:function(a,b){function d(i,o){if(c.isArray(o))c.each(o,function(k,n){b||/\[\]$/.test(i)?f(i,n):d(i+"["+(typeof n==="object"||c.isArray(n)?k:"")+"]",n)});else!b&&o!=null&&typeof o==="object"?c.each(o,function(k,n){d(i+"["+k+"]",n)}):f(i,o)}function f(i,o){o=c.isFunction(o)?o():o;e[e.length]=encodeURIComponent(i)+"="+encodeURIComponent(o)}var e=[];if(b===w)b=c.ajaxSettings.traditional;
if(c.isArray(a)||a.jquery)c.each(a,function(){f(this.name,this.value)});else for(var j in a)d(j,a[j]);return e.join("&").replace(yb,"+")}});var la={},Ab=/toggle|show|hide/,Bb=/^([+-]=)?([\d+-.]+)(.*)$/,W,va=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]];c.fn.extend({show:function(a,b){if(a||a===0)return this.animate(K("show",3),a,b);else{a=0;for(b=this.length;a<b;a++){var d=c.data(this[a],"olddisplay");
this[a].style.display=d||"";if(c.css(this[a],"display")==="none"){d=this[a].nodeName;var f;if(la[d])f=la[d];else{var e=c("<"+d+" />").appendTo("body");f=e.css("display");if(f==="none")f="block";e.remove();la[d]=f}c.data(this[a],"olddisplay",f)}}a=0;for(b=this.length;a<b;a++)this[a].style.display=c.data(this[a],"olddisplay")||"";return this}},hide:function(a,b){if(a||a===0)return this.animate(K("hide",3),a,b);else{a=0;for(b=this.length;a<b;a++){var d=c.data(this[a],"olddisplay");!d&&d!=="none"&&c.data(this[a],
"olddisplay",c.css(this[a],"display"))}a=0;for(b=this.length;a<b;a++)this[a].style.display="none";return this}},_toggle:c.fn.toggle,toggle:function(a,b){var d=typeof a==="boolean";if(c.isFunction(a)&&c.isFunction(b))this._toggle.apply(this,arguments);else a==null||d?this.each(function(){var f=d?a:c(this).is(":hidden");c(this)[f?"show":"hide"]()}):this.animate(K("toggle",3),a,b);return this},fadeTo:function(a,b,d){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:b},a,d)},
animate:function(a,b,d,f){var e=c.speed(b,d,f);if(c.isEmptyObject(a))return this.each(e.complete);return this[e.queue===false?"each":"queue"](function(){var j=c.extend({},e),i,o=this.nodeType===1&&c(this).is(":hidden"),k=this;for(i in a){var n=i.replace(ia,ja);if(i!==n){a[n]=a[i];delete a[i];i=n}if(a[i]==="hide"&&o||a[i]==="show"&&!o)return j.complete.call(this);if((i==="height"||i==="width")&&this.style){j.display=c.css(this,"display");j.overflow=this.style.overflow}if(c.isArray(a[i])){(j.specialEasing=
j.specialEasing||{})[i]=a[i][1];a[i]=a[i][0]}}if(j.overflow!=null)this.style.overflow="hidden";j.curAnim=c.extend({},a);c.each(a,function(r,u){var z=new c.fx(k,j,r);if(Ab.test(u))z[u==="toggle"?o?"show":"hide":u](a);else{var C=Bb.exec(u),B=z.cur(true)||0;if(C){u=parseFloat(C[2]);var E=C[3]||"px";if(E!=="px"){k.style[r]=(u||1)+E;B=(u||1)/z.cur(true)*B;k.style[r]=B+E}if(C[1])u=(C[1]==="-="?-1:1)*u+B;z.custom(B,u,E)}else z.custom(B,u,"")}});return true})},stop:function(a,b){var d=c.timers;a&&this.queue([]);
this.each(function(){for(var f=d.length-1;f>=0;f--)if(d[f].elem===this){b&&d[f](true);d.splice(f,1)}});b||this.dequeue();return this}});c.each({slideDown:K("show",1),slideUp:K("hide",1),slideToggle:K("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"}},function(a,b){c.fn[a]=function(d,f){return this.animate(b,d,f)}});c.extend({speed:function(a,b,d){var f=a&&typeof a==="object"?a:{complete:d||!d&&b||c.isFunction(a)&&a,duration:a,easing:d&&b||b&&!c.isFunction(b)&&b};f.duration=c.fx.off?0:typeof f.duration===
"number"?f.duration:c.fx.speeds[f.duration]||c.fx.speeds._default;f.old=f.complete;f.complete=function(){f.queue!==false&&c(this).dequeue();c.isFunction(f.old)&&f.old.call(this)};return f},easing:{linear:function(a,b,d,f){return d+f*a},swing:function(a,b,d,f){return(-Math.cos(a*Math.PI)/2+0.5)*f+d}},timers:[],fx:function(a,b,d){this.options=b;this.elem=a;this.prop=d;if(!b.orig)b.orig={}}});c.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this);(c.fx.step[this.prop]||
c.fx.step._default)(this);if((this.prop==="height"||this.prop==="width")&&this.elem.style)this.elem.style.display="block"},cur:function(a){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null))return this.elem[this.prop];return(a=parseFloat(c.css(this.elem,this.prop,a)))&&a>-10000?a:parseFloat(c.curCSS(this.elem,this.prop))||0},custom:function(a,b,d){function f(j){return e.step(j)}this.startTime=J();this.start=a;this.end=b;this.unit=d||this.unit||"px";this.now=this.start;
this.pos=this.state=0;var e=this;f.elem=this.elem;if(f()&&c.timers.push(f)&&!W)W=setInterval(c.fx.tick,13)},show:function(){this.options.orig[this.prop]=c.style(this.elem,this.prop);this.options.show=true;this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur());c(this.elem).show()},hide:function(){this.options.orig[this.prop]=c.style(this.elem,this.prop);this.options.hide=true;this.custom(this.cur(),0)},step:function(a){var b=J(),d=true;if(a||b>=this.options.duration+this.startTime){this.now=
this.end;this.pos=this.state=1;this.update();this.options.curAnim[this.prop]=true;for(var f in this.options.curAnim)if(this.options.curAnim[f]!==true)d=false;if(d){if(this.options.display!=null){this.elem.style.overflow=this.options.overflow;a=c.data(this.elem,"olddisplay");this.elem.style.display=a?a:this.options.display;if(c.css(this.elem,"display")==="none")this.elem.style.display="block"}this.options.hide&&c(this.elem).hide();if(this.options.hide||this.options.show)for(var e in this.options.curAnim)c.style(this.elem,
e,this.options.orig[e]);this.options.complete.call(this.elem)}return false}else{e=b-this.startTime;this.state=e/this.options.duration;a=this.options.easing||(c.easing.swing?"swing":"linear");this.pos=c.easing[this.options.specialEasing&&this.options.specialEasing[this.prop]||a](this.state,e,0,1,this.options.duration);this.now=this.start+(this.end-this.start)*this.pos;this.update()}return true}};c.extend(c.fx,{tick:function(){for(var a=c.timers,b=0;b<a.length;b++)a[b]()||a.splice(b--,1);a.length||
c.fx.stop()},stop:function(){clearInterval(W);W=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){c.style(a.elem,"opacity",a.now)},_default:function(a){if(a.elem.style&&a.elem.style[a.prop]!=null)a.elem.style[a.prop]=(a.prop==="width"||a.prop==="height"?Math.max(0,a.now):a.now)+a.unit;else a.elem[a.prop]=a.now}}});if(c.expr&&c.expr.filters)c.expr.filters.animated=function(a){return c.grep(c.timers,function(b){return a===b.elem}).length};c.fn.offset="getBoundingClientRect"in s.documentElement?
function(a){var b=this[0];if(a)return this.each(function(e){c.offset.setOffset(this,a,e)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return c.offset.bodyOffset(b);var d=b.getBoundingClientRect(),f=b.ownerDocument;b=f.body;f=f.documentElement;return{top:d.top+(self.pageYOffset||c.support.boxModel&&f.scrollTop||b.scrollTop)-(f.clientTop||b.clientTop||0),left:d.left+(self.pageXOffset||c.support.boxModel&&f.scrollLeft||b.scrollLeft)-(f.clientLeft||b.clientLeft||0)}}:function(a){var b=
this[0];if(a)return this.each(function(r){c.offset.setOffset(this,a,r)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return c.offset.bodyOffset(b);c.offset.initialize();var d=b.offsetParent,f=b,e=b.ownerDocument,j,i=e.documentElement,o=e.body;f=(e=e.defaultView)?e.getComputedStyle(b,null):b.currentStyle;for(var k=b.offsetTop,n=b.offsetLeft;(b=b.parentNode)&&b!==o&&b!==i;){if(c.offset.supportsFixedPosition&&f.position==="fixed")break;j=e?e.getComputedStyle(b,null):b.currentStyle;
k-=b.scrollTop;n-=b.scrollLeft;if(b===d){k+=b.offsetTop;n+=b.offsetLeft;if(c.offset.doesNotAddBorder&&!(c.offset.doesAddBorderForTableAndCells&&/^t(able|d|h)$/i.test(b.nodeName))){k+=parseFloat(j.borderTopWidth)||0;n+=parseFloat(j.borderLeftWidth)||0}f=d;d=b.offsetParent}if(c.offset.subtractsBorderForOverflowNotVisible&&j.overflow!=="visible"){k+=parseFloat(j.borderTopWidth)||0;n+=parseFloat(j.borderLeftWidth)||0}f=j}if(f.position==="relative"||f.position==="static"){k+=o.offsetTop;n+=o.offsetLeft}if(c.offset.supportsFixedPosition&&
f.position==="fixed"){k+=Math.max(i.scrollTop,o.scrollTop);n+=Math.max(i.scrollLeft,o.scrollLeft)}return{top:k,left:n}};c.offset={initialize:function(){var a=s.body,b=s.createElement("div"),d,f,e,j=parseFloat(c.curCSS(a,"marginTop",true))||0;c.extend(b.style,{position:"absolute",top:0,left:0,margin:0,border:0,width:"1px",height:"1px",visibility:"hidden"});b.innerHTML="<div style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;'><div></div></div><table style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>";
a.insertBefore(b,a.firstChild);d=b.firstChild;f=d.firstChild;e=d.nextSibling.firstChild.firstChild;this.doesNotAddBorder=f.offsetTop!==5;this.doesAddBorderForTableAndCells=e.offsetTop===5;f.style.position="fixed";f.style.top="20px";this.supportsFixedPosition=f.offsetTop===20||f.offsetTop===15;f.style.position=f.style.top="";d.style.overflow="hidden";d.style.position="relative";this.subtractsBorderForOverflowNotVisible=f.offsetTop===-5;this.doesNotIncludeMarginInBodyOffset=a.offsetTop!==j;a.removeChild(b);
c.offset.initialize=c.noop},bodyOffset:function(a){var b=a.offsetTop,d=a.offsetLeft;c.offset.initialize();if(c.offset.doesNotIncludeMarginInBodyOffset){b+=parseFloat(c.curCSS(a,"marginTop",true))||0;d+=parseFloat(c.curCSS(a,"marginLeft",true))||0}return{top:b,left:d}},setOffset:function(a,b,d){if(/static/.test(c.curCSS(a,"position")))a.style.position="relative";var f=c(a),e=f.offset(),j=parseInt(c.curCSS(a,"top",true),10)||0,i=parseInt(c.curCSS(a,"left",true),10)||0;if(c.isFunction(b))b=b.call(a,
d,e);d={top:b.top-e.top+j,left:b.left-e.left+i};"using"in b?b.using.call(a,d):f.css(d)}};c.fn.extend({position:function(){if(!this[0])return null;var a=this[0],b=this.offsetParent(),d=this.offset(),f=/^body|html$/i.test(b[0].nodeName)?{top:0,left:0}:b.offset();d.top-=parseFloat(c.curCSS(a,"marginTop",true))||0;d.left-=parseFloat(c.curCSS(a,"marginLeft",true))||0;f.top+=parseFloat(c.curCSS(b[0],"borderTopWidth",true))||0;f.left+=parseFloat(c.curCSS(b[0],"borderLeftWidth",true))||0;return{top:d.top-
f.top,left:d.left-f.left}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||s.body;a&&!/^body|html$/i.test(a.nodeName)&&c.css(a,"position")==="static";)a=a.offsetParent;return a})}});c.each(["Left","Top"],function(a,b){var d="scroll"+b;c.fn[d]=function(f){var e=this[0],j;if(!e)return null;if(f!==w)return this.each(function(){if(j=wa(this))j.scrollTo(!a?f:c(j).scrollLeft(),a?f:c(j).scrollTop());else this[d]=f});else return(j=wa(e))?"pageXOffset"in j?j[a?"pageYOffset":
"pageXOffset"]:c.support.boxModel&&j.document.documentElement[d]||j.document.body[d]:e[d]}});c.each(["Height","Width"],function(a,b){var d=b.toLowerCase();c.fn["inner"+b]=function(){return this[0]?c.css(this[0],d,false,"padding"):null};c.fn["outer"+b]=function(f){return this[0]?c.css(this[0],d,false,f?"margin":"border"):null};c.fn[d]=function(f){var e=this[0];if(!e)return f==null?null:this;if(c.isFunction(f))return this.each(function(j){var i=c(this);i[d](f.call(this,j,i[d]()))});return"scrollTo"in
e&&e.document?e.document.compatMode==="CSS1Compat"&&e.document.documentElement["client"+b]||e.document.body["client"+b]:e.nodeType===9?Math.max(e.documentElement["client"+b],e.body["scroll"+b],e.documentElement["scroll"+b],e.body["offset"+b],e.documentElement["offset"+b]):f===w?c.css(e,d):this.css(d,typeof f==="string"?f:f+"px")}});A.jQuery=A.$=c})(window);

//]]>
</script>
<script id="jqueryArea" type="text/javascript">
//<![CDATA[
(function(a){if(!a.encoding){a.encoding={}}a.extend(a.encoding,{strToBe32s:function(f){var e=[];var b=Math.floor(f.length/4);var d,c;for(d=0,c=0;d<b;d++,c+=4){e[d]=((f.charCodeAt(c)&255)<<24)|((f.charCodeAt(c+1)&255)<<16)|((f.charCodeAt(c+2)&255)<<8)|(f.charCodeAt(c+3)&255)}while(c<f.length){e[c>>2]|=(f.charCodeAt(c)&255)<<(24-(c*8)%32);c++}return e},be32sToStr:function(c){var d="";for(var b=0;b<c.length*32;b+=8){d+=String.fromCharCode((c[b>>5]>>>(24-b%32))&255)}return d},be32sToHex:function(d){var c="0123456789ABCDEF";var e="";for(var b=0;b<d.length*4;b++){e+=c.charAt((d[b>>2]>>((3-b%4)*8+4))&15)+c.charAt((d[b>>2]>>((3-b%4)*8))&15)}return e}})})(jQuery);(function(a){if(!a.encoding.digests){a.encoding.digests={}}a.extend(a.encoding.digests,{hexSha1Str:function(c){return a.encoding.be32sToHex(a.encoding.digests.sha1Str(c))},sha1Str:function(c){return b(a.encoding.strToBe32s(c),c.length)},sha1:function(c,d){return b(a.encoding.strToBe32s(str),str.length)}});function b(u,q){function p(d,c){var i=(d&65535)+(c&65535);var e=(d>>16)+(c>>16)+(i>>16);return(e<<16)|(i&65535)}function A(j,i,J,I,x){i=(i>>>27)|(i<<5);var w=(j&65535)+(i&65535)+(J&65535)+(I&65535)+(x&65535);var t=(j>>16)+(i>>16)+(J>>16)+(I>>16)+(x>>16)+(w>>16);return(t<<16)|(w&65535)}function f(c,d){var e=c[d-3]^c[d-8]^c[d-14]^c[d-16];return(e>>>31)|(e<<1)}var C=q*8;u[C>>5]|=128<<(24-C%32);u[((C+64>>9)<<4)+15]=C;var v=new Array(80);var s=1518500249;var o=1859775393;var m=2400959708;var k=3395469782;var r=1732584193;var n=4023233417;var l=2562383102;var h=271733878;var g=3285377520;for(var B=0;B<u.length;B+=16){var z=0;var y;var H=r;var G=n;var F=l;var E=h;var D=g;while(z<16){v[z]=u[B+z];y=A(D,H,E^(G&(F^E)),v[z],s);D=E;E=F;F=(G>>>2)|(G<<30);G=H;H=y;z++}while(z<20){v[z]=f(v,z);y=A(D,H,E^(G&(F^E)),v[z],s);D=E;E=F;F=(G>>>2)|(G<<30);G=H;H=y;z++}while(z<40){v[z]=f(v,z);y=A(D,H,G^F^E,v[z],o);D=E;E=F;F=(G>>>2)|(G<<30);G=H;H=y;z++}while(z<60){v[z]=f(v,z);y=A(D,H,(G&F)|(E&(G|F)),v[z],m);D=E;E=F;F=(G>>>2)|(G<<30);G=H;H=y;z++}while(z<80){v[z]=f(v,z);y=A(D,H,G^F^E,v[z],k);D=E;E=F;F=(G>>>2)|(G<<30);G=H;H=y;z++}r=p(r,H);n=p(n,G);l=p(l,F);h=p(h,E);g=p(g,D)}return[r,n,l,h,g]}})(jQuery);(function(b){var a="customStyleSheet";b.twStylesheet=function(d,c){c=c||{};var g=c.id||a;var f=c.doc||document;var e=f.getElementById(g);if(f.createStyleSheet){if(e){e.cssText=d}else{f.getElementsByTagName("head")[0].insertAdjacentHTML("beforeEnd",'&nbsp;<style id="'+g+'" type="text/css">'+d+"</style>")}}else{if(e){e.replaceChild(f.createTextNode(d),e.firstChild)}else{e=f.createElement("style");e.type="text/css";e.id=g;e.appendChild(f.createTextNode(d));f.getElementsByTagName("head")[0].appendChild(e)}}};b.twStylesheet.remove=function(c){c=c||{};var f=c.id||a;var e=c.doc||document;var d=e.getElementById(f);if(d){d.parentNode.removeChild(d)}}})(jQuery);//]]>
</script>
<script type="text/javascript">
//<![CDATA[
if(useJavaSaver)
	document.write("<applet style='position:absolute;left:-1px' name='TiddlySaver' code='TiddlySaver.class' archive='TiddlySaver.jar' width='1' height='1'></applet>");
//]]>
</script>
<!--POST-SCRIPT-START-->

<!--POST-SCRIPT-END-->
</body>
</html>
